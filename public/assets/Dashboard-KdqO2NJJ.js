import{c as at,a as xo,p as go,R as xe,G as U,b as Ls,i as Os,t as bo,d as vo,e as ut,l as yo,f as lr,g as jo,h as Vs,k as wo,m as cr,n as No,o as ko,q as So,P as Cn,_ as Mn,r as N,j as s,v as cs,w as ue,L as Rn,A as et,x as ne,y as Ve,z as Ue,B as Ot,C as Ao,D as wt,E as To,T as qe,S as Ce,Z as Co,F as Mo,H as Ro,I as Eo,J as En,K as Do,M as ze,N as dr,O as ur,Q as hr,U as _o,V as Po,W as Dn,X as Io,u as Lo}from"./index-DqqLzTeD.js";import{g as Oo,a as _n,u as Vo,b as Fo}from"./useSystemBrain-CssL6e2e.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Pn=at("activity",Bo);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Uo=at("credit-card",$o);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Wo=at("file-down",zo);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=[["path",{d:"M5 12h14",key:"1ays0h"}]],Go=at("minus",Ho);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ko=at("search",Yo);var qo=["className","top","left","data","centroid","innerRadius","outerRadius","cornerRadius","startAngle","endAngle","padAngle","padRadius","pieSort","pieSortValues","pieValue","children","fill"];function ds(){return ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ds.apply(this,arguments)}function Xo(e,t){if(e==null)return{};var n={},i=Object.keys(e),r,a;for(a=0;a<i.length;a++)r=i[a],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function Zo(e){var t=e.className,n=e.top,i=e.left,r=e.data,a=r===void 0?[]:r,o=e.centroid,l=e.innerRadius,c=l===void 0?0:l,d=e.outerRadius,u=e.cornerRadius,p=e.startAngle,h=e.endAngle,m=e.padAngle,f=e.padRadius,g=e.pieSort,b=e.pieSortValues,v=e.pieValue,w=e.children,A=e.fill,T=A===void 0?"":A,S=Xo(e,qo),y=xo({innerRadius:c,outerRadius:d,cornerRadius:u,padRadius:f}),x=go({startAngle:p,endAngle:h,padAngle:m,value:v,sort:g,sortValues:b}),j=x(a);return w?xe.createElement(xe.Fragment,null,w({arcs:j,path:y,pie:x})):xe.createElement(U,{className:"visx-pie-arcs-group",top:n,left:i},j.map(function(k,M){return xe.createElement("g",{key:"pie-arc-"+M},xe.createElement("path",ds({className:Ls("visx-pie-arc",t),d:y(k)||"",fill:T==null||typeof T=="string"?T:T(k)},S)),o==null?void 0:o(y.centroid(k),k))}))}var Jo=["className","innerRef"];function us(){return us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},us.apply(this,arguments)}function Qo(e,t){if(e==null)return{};var n={},i=Object.keys(e),r,a;for(a=0;a<i.length;a++)r=i[a],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function In(e){var t=e.className,n=e.innerRef,i=Qo(e,Jo);return xe.createElement("circle",us({ref:n,className:Ls("visx-circle",t)},i))}class Ln extends Map{constructor(t,n=sl){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(On(this,t))}has(t){return super.has(On(this,t))}set(t,n){return super.set(el(this,t),n)}delete(t){return super.delete(tl(this,t))}}function On({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function el({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function tl({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function sl(e){return e!==null&&typeof e=="object"?e.valueOf():e}function nl(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(r);++i<r;)a[i]=e+i*n;return a}const Vn=Symbol("implicit");function pr(){var e=new Ln,t=[],n=[],i=Vn;function r(a){let o=e.get(a);if(o===void 0){if(i!==Vn)return i;e.set(a,o=t.push(a)-1)}return n[o%n.length]}return r.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Ln;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(a){return arguments.length?(n=Array.from(a),r):n.slice()},r.unknown=function(a){return arguments.length?(i=a,r):i},r.copy=function(){return pr(t,n).unknown(i)},Os.apply(r,arguments),r}function mr(){var e=pr().unknown(void 0),t=e.domain,n=e.range,i=0,r=1,a,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function p(){var h=t().length,m=r<i,f=m?r:i,g=m?i:r;a=(g-f)/Math.max(1,h-c+d*2),l&&(a=Math.floor(a)),f+=(g-f-a*(h-c))*u,o=a*(1-c),l&&(f=Math.round(f),o=Math.round(o));var b=nl(h).map(function(v){return f+a*v});return n(m?b.reverse():b)}return e.domain=function(h){return arguments.length?(t(h),p()):t()},e.range=function(h){return arguments.length?([i,r]=h,i=+i,r=+r,p()):[i,r]},e.rangeRound=function(h){return[i,r]=h,i=+i,r=+r,l=!0,p()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(h){return arguments.length?(l=!!h,p()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),p()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),p()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,p()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),p()):u},e.copy=function(){return mr(t(),[i,r]).round(l).paddingInner(c).paddingOuter(d).align(u)},Os.apply(p(),arguments)}function Fn(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function il(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function rl(e){return e<0?-e*e:e*e}function al(e){var t=e(ut,ut),n=1;function i(){return n===1?e(ut,ut):n===.5?e(il,rl):e(Fn(n),Fn(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},yo(t)}function fr(){var e=al(bo());return e.copy=function(){return vo(e,fr()).exponent(e.exponent())},Os.apply(e,arguments),e}function ol(){return fr.apply(null,arguments).exponent(.5)}var ll=lr("domain","range","reverse","align","padding","round");function Fs(e){return ll(mr(),e)}var cl=lr("domain","range","reverse","clamp","interpolate","nice","round","zero");function dl(e){return cl(ol(),e)}function ul(e,t,n){var f,g,b;const i=e.length,r=e.filter(v=>v.status!=="cancelled").length,a=e.filter(v=>v.status==="signed").length,o=(f=n==null?void 0:n.finance)!=null&&f.riskyDeposits?a-n.finance.riskyDeposits.length:e.filter(v=>v.status==="signed"&&(v.deposit_paid||v.contract_secured)).length,l=((b=(g=n==null?void 0:n.finance)==null?void 0:g.riskyDeposits)==null?void 0:b.length)||0,c=t.length,d=t.filter(v=>!v.opted_out).length,u=t.reduce((v,w)=>v+(w.email_sequence_step||0),0),p=t.filter(v=>v.next_email_date).length,h=t.filter(v=>v.opted_out).length,m=c>0?h/c*100:0;return{totalStudies:i,activeStudies:r,signedStudies:a,securedStudies:o,waitingStudies:l,totalLeads:c,activeLeads:d,totalEmailsSent:u,pendingEmails:p,unsubscribedCount:h,unsubscribeRate:m}}var ht={},pt={},Bn;function hl(){if(Bn)return pt;Bn=1,pt.__esModule=!0,pt.default=o;var e=n(jo()),t=Vs();function n(l){return l&&l.__esModule?l:{default:l}}function i(){return i=Object.assign?Object.assign.bind():function(l){for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var u in d)Object.prototype.hasOwnProperty.call(d,u)&&(l[u]=d[u])}return l},i.apply(this,arguments)}var r=[],a={width:0,height:0,top:0,left:0};function o(l){var c=l===void 0?{}:l,d=c.initialSize,u=d===void 0?a:d,p=c.debounceTime,h=p===void 0?300:p,m=c.ignoreDimensions,f=m===void 0?r:m,g=c.enableDebounceLeadingCall,b=g===void 0?!0:g,v=c.resizeObserverPolyfill,w=(0,t.useRef)(null),A=(0,t.useRef)(0),T=(0,t.useState)(i({},a,u)),S=T[0],y=T[1],x=(0,t.useMemo)(function(){var j=Array.isArray(f)?f:[f];return(0,e.default)(function(k){y(function(M){var E=Object.keys(M),D=E.filter(function(C){return M[C]!==k[C]}),_=D.every(function(C){return j.includes(C)});return _?M:k})},h,{leading:b})},[h,b,f]);return(0,t.useEffect)(function(){var j=v||window.ResizeObserver,k=new j(function(M){M.forEach(function(E){var D,_=(D=E==null?void 0:E.contentRect)!=null?D:{},C=_.left,I=_.top,K=_.width,O=_.height;A.current=window.requestAnimationFrame(function(){x({width:K,height:O,top:I,left:C})})})});return w.current&&k.observe(w.current),function(){window.cancelAnimationFrame(A.current),k.disconnect(),x.cancel()}},[x,v]),i({parentRef:w,resize:x},S)}return pt}var $n;function pl(){if($n)return ht;$n=1,ht.__esModule=!0,ht.default=d;var e=a(wo()),t=a(Vs()),n=a(hl()),i=["className","children","debounceTime","ignoreDimensions","initialSize","parentSizeStyles","enableDebounceLeadingCall","resizeObserverPolyfill"],r=["parentRef","resize"];function a(u){return u&&u.__esModule?u:{default:u}}function o(){return o=Object.assign?Object.assign.bind():function(u){for(var p=1;p<arguments.length;p++){var h=arguments[p];for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&(u[m]=h[m])}return u},o.apply(this,arguments)}function l(u,p){if(u==null)return{};var h={},m=Object.keys(u),f,g;for(g=0;g<m.length;g++)f=m[g],!(p.indexOf(f)>=0)&&(h[f]=u[f]);return h}var c={width:"100%",height:"100%"};function d(u){var p=u.className,h=u.children,m=u.debounceTime,f=u.ignoreDimensions,g=u.initialSize,b=u.parentSizeStyles,v=b===void 0?c:b,w=u.enableDebounceLeadingCall,A=w===void 0?!0:w,T=u.resizeObserverPolyfill,S=l(u,i),y=(0,n.default)({initialSize:g,debounceTime:m,ignoreDimensions:f,enableDebounceLeadingCall:A,resizeObserverPolyfill:T}),x=y.parentRef,j=y.resize,k=l(y,r);return t.default.createElement("div",o({style:v,ref:x,className:p},S),h(o({},k,{ref:x.current,resize:j})))}return d.propTypes={className:e.default.string,children:e.default.func.isRequired},ht}var ml=pl();const xr=cr(ml);var mt={},Un;function fl(){if(Un)return mt;Un=1,mt.__esModule=!0,mt.default=o;var e=i(Vs()),t=i(No()),n=["from","to","fill","className","innerRef"];function i(l){return l&&l.__esModule?l:{default:l}}function r(){return r=Object.assign?Object.assign.bind():function(l){for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var u in d)Object.prototype.hasOwnProperty.call(d,u)&&(l[u]=d[u])}return l},r.apply(this,arguments)}function a(l,c){if(l==null)return{};var d={},u=Object.keys(l),p,h;for(h=0;h<u.length;h++)p=u[h],!(c.indexOf(p)>=0)&&(d[p]=l[p]);return d}function o(l){var c=l.from,d=c===void 0?{x:0,y:0}:c,u=l.to,p=u===void 0?{x:1,y:1}:u,h=l.fill,m=h===void 0?"transparent":h,f=l.className,g=l.innerRef,b=a(l,n),v=d.x===p.x||d.y===p.y;return e.default.createElement("line",r({ref:g,className:(0,t.default)("visx-line",f),x1:d.x,y1:d.y,x2:p.x,y2:p.y,fill:m,shapeRendering:v?"crispEdges":"auto"},b))}return mt}var xl=fl();const gl=cr(xl);function bl(e){return"bandwidth"in e?e.bandwidth():0}var vl=["top","left","scale","width","stroke","strokeWidth","strokeDasharray","className","children","numTicks","lineStyle","offset","tickValues"];function hs(){return hs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},hs.apply(this,arguments)}function yl(e,t){if(e==null)return{};var n={},i=Object.keys(e),r,a;for(a=0;a<i.length;a++)r=i[a],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function Bs(e){var t=e.top,n=t===void 0?0:t,i=e.left,r=i===void 0?0:i,a=e.scale,o=e.width,l=e.stroke,c=l===void 0?"#eaf0f6":l,d=e.strokeWidth,u=d===void 0?1:d,p=e.strokeDasharray,h=e.className,m=e.children,f=e.numTicks,g=f===void 0?10:f,b=e.lineStyle,v=e.offset,w=e.tickValues,A=yl(e,vl),T=w??ko(a,g),S=(v??0)+bl(a)/2,y=T.map(function(x,j){var k,M=((k=So(a(x)))!=null?k:0)+S;return{index:j,from:new Cn({x:0,y:M}),to:new Cn({x:o,y:M})}});return xe.createElement(U,{className:Ls("visx-rows",h),top:n,left:r},m?m({lines:y}):y.map(function(x){var j=x.from,k=x.to,M=x.index;return xe.createElement(gl,hs({key:"row-line-"+M,from:j,to:k,stroke:c,strokeWidth:u,strokeDasharray:p,style:b},A))}))}Bs.propTypes={tickValues:Mn.array,width:Mn.number.isRequired};const $s=N.createContext({});function Us(e){const t=N.useRef(null);return t.current===null&&(t.current=e()),t.current}const gr=typeof window<"u",br=gr?N.useLayoutEffect:N.useEffect,Vt=N.createContext(null);function zs(e,t){e.indexOf(t)===-1&&e.push(t)}function Ws(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const ce=(e,t,n)=>n>t?t:n<e?e:n;let Hs=()=>{};const he={},vr=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function yr(e){return typeof e=="object"&&e!==null}const jr=e=>/^0[^.\s]+$/u.test(e);function Gs(e){let t;return()=>(t===void 0&&(t=e()),t)}const ee=e=>e,jl=(e,t)=>n=>t(e(n)),ot=(...e)=>e.reduce(jl),tt=(e,t,n)=>{const i=t-e;return i===0?1:(n-e)/i};class Ys{constructor(){this.subscriptions=[]}add(t){return zs(this.subscriptions,t),()=>Ws(this.subscriptions,t)}notify(t,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,n,i);else for(let a=0;a<r;a++){const o=this.subscriptions[a];o&&o(t,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const oe=e=>e*1e3,Q=e=>e/1e3;function wr(e,t){return t?e*(1e3/t):0}const Nr=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,wl=1e-7,Nl=12;function kl(e,t,n,i,r){let a,o,l=0;do o=t+(n-t)/2,a=Nr(o,i,r)-e,a>0?n=o:t=o;while(Math.abs(a)>wl&&++l<Nl);return o}function lt(e,t,n,i){if(e===t&&n===i)return ee;const r=a=>kl(a,0,1,e,n);return a=>a===0||a===1?a:Nr(r(a),t,i)}const kr=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Sr=e=>t=>1-e(1-t),Ar=lt(.33,1.53,.69,.99),Ks=Sr(Ar),Tr=kr(Ks),Cr=e=>(e*=2)<1?.5*Ks(e):.5*(2-Math.pow(2,-10*(e-1))),qs=e=>1-Math.sin(Math.acos(e)),Mr=Sr(qs),Rr=kr(qs),Sl=lt(.42,0,1,1),Al=lt(0,0,.58,1),Er=lt(.42,0,.58,1),Tl=e=>Array.isArray(e)&&typeof e[0]!="number",Dr=e=>Array.isArray(e)&&typeof e[0]=="number",Cl={linear:ee,easeIn:Sl,easeInOut:Er,easeOut:Al,circIn:qs,circInOut:Rr,circOut:Mr,backIn:Ks,backInOut:Tr,backOut:Ar,anticipate:Cr},Ml=e=>typeof e=="string",zn=e=>{if(Dr(e)){Hs(e.length===4);const[t,n,i,r]=e;return lt(t,n,i,r)}else if(Ml(e))return Cl[e];return e},ft=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Rl(e,t){let n=new Set,i=new Set,r=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(u){o.has(u)&&(d.schedule(u),e()),u(l)}const d={schedule:(u,p=!1,h=!1)=>{const f=h&&r?n:i;return p&&o.add(u),f.has(u)||f.add(u),u},cancel:u=>{i.delete(u),o.delete(u)},process:u=>{if(l=u,r){a=!0;return}r=!0,[n,i]=[i,n],n.forEach(c),n.clear(),r=!1,a&&(a=!1,d.process(u))}};return d}const El=40;function _r(e,t){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=ft.reduce((A,T)=>(A[T]=Rl(a),A),{}),{setup:l,read:c,resolveKeyframes:d,preUpdate:u,update:p,preRender:h,render:m,postRender:f}=o,g=()=>{const A=he.useManualTiming?r.timestamp:performance.now();n=!1,he.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(A-r.timestamp,El),1)),r.timestamp=A,r.isProcessing=!0,l.process(r),c.process(r),d.process(r),u.process(r),p.process(r),h.process(r),m.process(r),f.process(r),r.isProcessing=!1,n&&t&&(i=!1,e(g))},b=()=>{n=!0,i=!0,r.isProcessing||e(g)};return{schedule:ft.reduce((A,T)=>{const S=o[T];return A[T]=(y,x=!1,j=!1)=>(n||b(),S.schedule(y,x,j)),A},{}),cancel:A=>{for(let T=0;T<ft.length;T++)o[ft[T]].cancel(A)},state:r,steps:o}}const{schedule:L,cancel:be,state:Y,steps:zt}=_r(typeof requestAnimationFrame<"u"?requestAnimationFrame:ee,!0);let Nt;function Dl(){Nt=void 0}const Z={now:()=>(Nt===void 0&&Z.set(Y.isProcessing||he.useManualTiming?Y.timestamp:performance.now()),Nt),set:e=>{Nt=e,queueMicrotask(Dl)}},Pr=e=>t=>typeof t=="string"&&t.startsWith(e),Ir=Pr("--"),_l=Pr("var(--"),Xs=e=>_l(e)?Pl.test(e.split("/*")[0].trim()):!1,Pl=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Wn(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const We={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},st={...We,transform:e=>ce(0,1,e)},xt={...We,default:1},Xe=e=>Math.round(e*1e5)/1e5,Zs=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Il(e){return e==null}const Ll=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Js=(e,t)=>n=>!!(typeof n=="string"&&Ll.test(n)&&n.startsWith(e)||t&&!Il(n)&&Object.prototype.hasOwnProperty.call(n,t)),Lr=(e,t,n)=>i=>{if(typeof i!="string")return i;const[r,a,o,l]=i.match(Zs);return{[e]:parseFloat(r),[t]:parseFloat(a),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},Ol=e=>ce(0,255,e),Wt={...We,transform:e=>Math.round(Ol(e))},Ae={test:Js("rgb","red"),parse:Lr("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:i=1})=>"rgba("+Wt.transform(e)+", "+Wt.transform(t)+", "+Wt.transform(n)+", "+Xe(st.transform(i))+")"};function Vl(e){let t="",n="",i="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,i+=i,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const ps={test:Js("#"),parse:Vl,transform:Ae.transform},ct=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),me=ct("deg"),le=ct("%"),R=ct("px"),Fl=ct("vh"),Bl=ct("vw"),Hn={...le,parse:e=>le.parse(e)/100,transform:e=>le.transform(e*100)},_e={test:Js("hsl","hue"),parse:Lr("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+le.transform(Xe(t))+", "+le.transform(Xe(n))+", "+Xe(st.transform(i))+")"},$={test:e=>Ae.test(e)||ps.test(e)||_e.test(e),parse:e=>Ae.test(e)?Ae.parse(e):_e.test(e)?_e.parse(e):ps.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ae.transform(e):_e.transform(e),getAnimatableNone:e=>{const t=$.parse(e);return t.alpha=0,$.transform(t)}},$l=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Ul(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Zs))==null?void 0:t.length)||0)+(((n=e.match($l))==null?void 0:n.length)||0)>0}const Or="number",Vr="color",zl="var",Wl="var(",Gn="${}",Hl=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function nt(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},r=[];let a=0;const l=t.replace(Hl,c=>($.test(c)?(i.color.push(a),r.push(Vr),n.push($.parse(c))):c.startsWith(Wl)?(i.var.push(a),r.push(zl),n.push(c)):(i.number.push(a),r.push(Or),n.push(parseFloat(c))),++a,Gn)).split(Gn);return{values:n,split:l,indexes:i,types:r}}function Fr(e){return nt(e).values}function Br(e){const{split:t,types:n}=nt(e),i=t.length;return r=>{let a="";for(let o=0;o<i;o++)if(a+=t[o],r[o]!==void 0){const l=n[o];l===Or?a+=Xe(r[o]):l===Vr?a+=$.transform(r[o]):a+=r[o]}return a}}const Gl=e=>typeof e=="number"?0:$.test(e)?$.getAnimatableNone(e):e;function Yl(e){const t=Fr(e);return Br(e)(t.map(Gl))}const ve={test:Ul,parse:Fr,createTransformer:Br,getAnimatableNone:Yl};function Ht(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function Kl({hue:e,saturation:t,lightness:n,alpha:i}){e/=360,t/=100,n/=100;let r=0,a=0,o=0;if(!t)r=a=o=n;else{const l=n<.5?n*(1+t):n+t-n*t,c=2*n-l;r=Ht(c,l,e+1/3),a=Ht(c,l,e),o=Ht(c,l,e-1/3)}return{red:Math.round(r*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:i}}function Mt(e,t){return n=>n>0?t:e}const V=(e,t,n)=>e+(t-e)*n,Gt=(e,t,n)=>{const i=e*e,r=n*(t*t-i)+i;return r<0?0:Math.sqrt(r)},ql=[ps,Ae,_e],Xl=e=>ql.find(t=>t.test(e));function Yn(e){const t=Xl(e);if(!t)return!1;let n=t.parse(e);return t===_e&&(n=Kl(n)),n}const Kn=(e,t)=>{const n=Yn(e),i=Yn(t);if(!n||!i)return Mt(e,t);const r={...n};return a=>(r.red=Gt(n.red,i.red,a),r.green=Gt(n.green,i.green,a),r.blue=Gt(n.blue,i.blue,a),r.alpha=V(n.alpha,i.alpha,a),Ae.transform(r))},ms=new Set(["none","hidden"]);function Zl(e,t){return ms.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function Jl(e,t){return n=>V(e,t,n)}function Qs(e){return typeof e=="number"?Jl:typeof e=="string"?Xs(e)?Mt:$.test(e)?Kn:tc:Array.isArray(e)?$r:typeof e=="object"?$.test(e)?Kn:Ql:Mt}function $r(e,t){const n=[...e],i=n.length,r=e.map((a,o)=>Qs(a)(a,t[o]));return a=>{for(let o=0;o<i;o++)n[o]=r[o](a);return n}}function Ql(e,t){const n={...e,...t},i={};for(const r in n)e[r]!==void 0&&t[r]!==void 0&&(i[r]=Qs(e[r])(e[r],t[r]));return r=>{for(const a in i)n[a]=i[a](r);return n}}function ec(e,t){const n=[],i={color:0,var:0,number:0};for(let r=0;r<t.values.length;r++){const a=t.types[r],o=e.indexes[a][i[a]],l=e.values[o]??0;n[r]=l,i[a]++}return n}const tc=(e,t)=>{const n=ve.createTransformer(t),i=nt(e),r=nt(t);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?ms.has(e)&&!r.values.length||ms.has(t)&&!i.values.length?Zl(e,t):ot($r(ec(i,r),r.values),n):Mt(e,t)};function Ur(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?V(e,t,n):Qs(e)(e,t)}const sc=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>L.update(t,n),stop:()=>be(t),now:()=>Y.isProcessing?Y.timestamp:Z.now()}},zr=(e,t,n=10)=>{let i="";const r=Math.max(Math.round(t/n),2);for(let a=0;a<r;a++)i+=Math.round(e(a/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},Rt=2e4;function en(e){let t=0;const n=50;let i=e.next(t);for(;!i.done&&t<Rt;)t+=n,i=e.next(t);return t>=Rt?1/0:t}function nc(e,t=100,n){const i=n({...e,keyframes:[0,t]}),r=Math.min(en(i),Rt);return{type:"keyframes",ease:a=>i.next(r*a).value/t,duration:Q(r)}}const ic=5;function Wr(e,t,n){const i=Math.max(t-ic,0);return wr(n-e(i),t-i)}const F={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Yt=.001;function rc({duration:e=F.duration,bounce:t=F.bounce,velocity:n=F.velocity,mass:i=F.mass}){let r,a,o=1-t;o=ce(F.minDamping,F.maxDamping,o),e=ce(F.minDuration,F.maxDuration,Q(e)),o<1?(r=d=>{const u=d*o,p=u*e,h=u-n,m=fs(d,o),f=Math.exp(-p);return Yt-h/m*f},a=d=>{const p=d*o*e,h=p*n+n,m=Math.pow(o,2)*Math.pow(d,2)*e,f=Math.exp(-p),g=fs(Math.pow(d,2),o);return(-r(d)+Yt>0?-1:1)*((h-m)*f)/g}):(r=d=>{const u=Math.exp(-d*e),p=(d-n)*e+1;return-Yt+u*p},a=d=>{const u=Math.exp(-d*e),p=(n-d)*(e*e);return u*p});const l=5/e,c=oc(r,a,l);if(e=oe(e),isNaN(c))return{stiffness:F.stiffness,damping:F.damping,duration:e};{const d=Math.pow(c,2)*i;return{stiffness:d,damping:o*2*Math.sqrt(i*d),duration:e}}}const ac=12;function oc(e,t,n){let i=n;for(let r=1;r<ac;r++)i=i-e(i)/t(i);return i}function fs(e,t){return e*Math.sqrt(1-t*t)}const lc=["duration","bounce"],cc=["stiffness","damping","mass"];function qn(e,t){return t.some(n=>e[n]!==void 0)}function dc(e){let t={velocity:F.velocity,stiffness:F.stiffness,damping:F.damping,mass:F.mass,isResolvedFromDuration:!1,...e};if(!qn(e,cc)&&qn(e,lc))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),r=i*i,a=2*ce(.05,1,1-(e.bounce||0))*Math.sqrt(r);t={...t,mass:F.mass,stiffness:r,damping:a}}else{const n=rc(e);t={...t,...n,mass:F.mass},t.isResolvedFromDuration=!0}return t}function Et(e=F.visualDuration,t=F.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:r}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:d,mass:u,duration:p,velocity:h,isResolvedFromDuration:m}=dc({...n,velocity:-Q(n.velocity||0)}),f=h||0,g=d/(2*Math.sqrt(c*u)),b=o-a,v=Q(Math.sqrt(c/u)),w=Math.abs(b)<5;i||(i=w?F.restSpeed.granular:F.restSpeed.default),r||(r=w?F.restDelta.granular:F.restDelta.default);let A;if(g<1){const S=fs(v,g);A=y=>{const x=Math.exp(-g*v*y);return o-x*((f+g*v*b)/S*Math.sin(S*y)+b*Math.cos(S*y))}}else if(g===1)A=S=>o-Math.exp(-v*S)*(b+(f+v*b)*S);else{const S=v*Math.sqrt(g*g-1);A=y=>{const x=Math.exp(-g*v*y),j=Math.min(S*y,300);return o-x*((f+g*v*b)*Math.sinh(j)+S*b*Math.cosh(j))/S}}const T={calculatedDuration:m&&p||null,next:S=>{const y=A(S);if(m)l.done=S>=p;else{let x=S===0?f:0;g<1&&(x=S===0?oe(f):Wr(A,S,y));const j=Math.abs(x)<=i,k=Math.abs(o-y)<=r;l.done=j&&k}return l.value=l.done?o:y,l},toString:()=>{const S=Math.min(en(T),Rt),y=zr(x=>T.next(S*x).value,S,30);return S+"ms "+y},toTransition:()=>{}};return T}Et.applyToOptions=e=>{const t=nc(e,100,Et);return e.ease=t.ease,e.duration=oe(t.duration),e.type="keyframes",e};function xs({keyframes:e,velocity:t=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:u}){const p=e[0],h={done:!1,value:p},m=j=>l!==void 0&&j<l||c!==void 0&&j>c,f=j=>l===void 0?c:c===void 0||Math.abs(l-j)<Math.abs(c-j)?l:c;let g=n*t;const b=p+g,v=o===void 0?b:o(b);v!==b&&(g=v-p);const w=j=>-g*Math.exp(-j/i),A=j=>v+w(j),T=j=>{const k=w(j),M=A(j);h.done=Math.abs(k)<=d,h.value=h.done?v:M};let S,y;const x=j=>{m(h.value)&&(S=j,y=Et({keyframes:[h.value,f(h.value)],velocity:Wr(A,j,h.value),damping:r,stiffness:a,restDelta:d,restSpeed:u}))};return x(0),{calculatedDuration:null,next:j=>{let k=!1;return!y&&S===void 0&&(k=!0,T(j),x(j)),S!==void 0&&j>=S?y.next(j-S):(!k&&T(j),h)}}}function uc(e,t,n){const i=[],r=n||he.mix||Ur,a=e.length-1;for(let o=0;o<a;o++){let l=r(e[o],e[o+1]);if(t){const c=Array.isArray(t)?t[o]||ee:t;l=ot(c,l)}i.push(l)}return i}function hc(e,t,{clamp:n=!0,ease:i,mixer:r}={}){const a=e.length;if(Hs(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=uc(t,i,r),c=l.length,d=u=>{if(o&&u<e[0])return t[0];let p=0;if(c>1)for(;p<e.length-2&&!(u<e[p+1]);p++);const h=tt(e[p],e[p+1],u);return l[p](h)};return n?u=>d(ce(e[0],e[a-1],u)):d}function pc(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const r=tt(0,t,i);e.push(V(n,1,r))}}function mc(e){const t=[0];return pc(t,e.length-1),t}function fc(e,t){return e.map(n=>n*t)}function xc(e,t){return e.map(()=>t||Er).splice(0,e.length-1)}function Ze({duration:e=300,keyframes:t,times:n,ease:i="easeInOut"}){const r=Tl(i)?i.map(zn):zn(i),a={done:!1,value:t[0]},o=fc(n&&n.length===t.length?n:mc(t),e),l=hc(o,t,{ease:Array.isArray(r)?r:xc(t,r)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}const gc=e=>e!==null;function tn(e,{repeat:t,repeatType:n="loop"},i,r=1){const a=e.filter(gc),l=r<0||t&&n!=="loop"&&t%2===1?0:a.length-1;return!l||i===void 0?a[l]:i}const bc={decay:xs,inertia:xs,tween:Ze,keyframes:Ze,spring:Et};function Hr(e){typeof e.type=="string"&&(e.type=bc[e.type])}class sn{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const vc=e=>e/100;class nn extends sn{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,r;const{motionValue:n}=this.options;n&&n.updatedAt!==Z.now()&&this.tick(Z.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(i=this.options).onStop)==null||r.call(i))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Hr(t);const{type:n=Ze,repeat:i=0,repeatDelay:r=0,repeatType:a,velocity:o=0}=t;let{keyframes:l}=t;const c=n||Ze;c!==Ze&&typeof l[0]!="number"&&(this.mixKeyframes=ot(vc,Ur(l[0],l[1])),l=[0,100]);const d=c({...t,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...l].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=en(d));const{calculatedDuration:u}=d;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=d}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:i,totalDuration:r,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:d=0,keyframes:u,repeat:p,repeatType:h,repeatDelay:m,type:f,onUpdate:g,finalKeyframe:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-r/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const v=this.currentTime-d*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?v<0:v>r;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let A=this.currentTime,T=i;if(p){const j=Math.min(this.currentTime,r)/l;let k=Math.floor(j),M=j%1;!M&&j>=1&&(M=1),M===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(h==="reverse"?(M=1-M,m&&(M-=m/l)):h==="mirror"&&(T=o)),A=ce(0,1,M)*l}const S=w?{done:!1,value:u[0]}:T.next(A);a&&(S.value=a(S.value));let{done:y}=S;!w&&c!==null&&(y=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const x=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&y);return x&&f!==xs&&(S.value=tn(u,this.options,b,this.speed)),g&&g(S.value),x&&this.finish(),S}then(t,n){return this.finished.then(t,n)}get duration(){return Q(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Q(t)}get time(){return Q(this.currentTime)}set time(t){var n;t=oe(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Z.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Q(this.currentTime))}play(){var r,a;if(this.isStopped)return;const{driver:t=sc,startTime:n}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),(a=(r=this.options).onPlay)==null||a.call(r);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Z.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(t=this.options).onComplete)==null||n.call(t)}cancel(){var t,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(t=this.options).onCancel)==null||n.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),t.observe(this)}}function yc(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Te=e=>e*180/Math.PI,gs=e=>{const t=Te(Math.atan2(e[1],e[0]));return bs(t)},jc={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:gs,rotateZ:gs,skewX:e=>Te(Math.atan(e[1])),skewY:e=>Te(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},bs=e=>(e=e%360,e<0&&(e+=360),e),Xn=gs,Zn=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Jn=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),wc={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Zn,scaleY:Jn,scale:e=>(Zn(e)+Jn(e))/2,rotateX:e=>bs(Te(Math.atan2(e[6],e[5]))),rotateY:e=>bs(Te(Math.atan2(-e[2],e[0]))),rotateZ:Xn,rotate:Xn,skewX:e=>Te(Math.atan(e[4])),skewY:e=>Te(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function vs(e){return e.includes("scale")?1:0}function ys(e,t){if(!e||e==="none")return vs(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=wc,r=n;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=jc,r=l}if(!r)return vs(t);const a=i[t],o=r[1].split(",").map(kc);return typeof a=="function"?a(o):o[a]}const Nc=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return ys(n,t)};function kc(e){return parseFloat(e.trim())}const He=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ge=new Set(He),Qn=e=>e===We||e===R,Sc=new Set(["x","y","z"]),Ac=He.filter(e=>!Sc.has(e));function Tc(e){const t=[];return Ac.forEach(n=>{const i=e.getValue(n);i!==void 0&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),t}const ge={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>ys(t,"x"),y:(e,{transform:t})=>ys(t,"y")};ge.translateX=ge.x;ge.translateY=ge.y;const Me=new Set;let js=!1,ws=!1,Ns=!1;function Gr(){if(ws){const e=Array.from(Me).filter(i=>i.needsMeasurement),t=new Set(e.map(i=>i.element)),n=new Map;t.forEach(i=>{const r=Tc(i);r.length&&(n.set(i,r),i.render())}),e.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const r=n.get(i);r&&r.forEach(([a,o])=>{var l;(l=i.getValue(a))==null||l.set(o)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}ws=!1,js=!1,Me.forEach(e=>e.complete(Ns)),Me.clear()}function Yr(){Me.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(ws=!0)})}function Cc(){Ns=!0,Yr(),Gr(),Ns=!1}class rn{constructor(t,n,i,r,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=i,this.motionValue=r,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Me.add(this),js||(js=!0,L.read(Yr),L.resolveKeyframes(Gr))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:i,motionValue:r}=this;if(t[0]===null){const a=r==null?void 0:r.get(),o=t[t.length-1];if(a!==void 0)t[0]=a;else if(i&&n){const l=i.readValue(n,o);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=o),r&&a===void 0&&r.set(t[0])}yc(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Me.delete(this)}cancel(){this.state==="scheduled"&&(Me.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Mc=e=>e.startsWith("--");function Rc(e,t,n){Mc(t)?e.style.setProperty(t,n):e.style[t]=n}const Ec=Gs(()=>window.ScrollTimeline!==void 0),Dc={};function _c(e,t){const n=Gs(e);return()=>Dc[t]??n()}const Kr=_c(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ke=([e,t,n,i])=>`cubic-bezier(${e}, ${t}, ${n}, ${i})`,ei={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ke([0,.65,.55,1]),circOut:Ke([.55,0,1,.45]),backIn:Ke([.31,.01,.66,-.59]),backOut:Ke([.33,1.53,.69,.99])};function qr(e,t){if(e)return typeof e=="function"?Kr()?zr(e,t):"ease-out":Dr(e)?Ke(e):Array.isArray(e)?e.map(n=>qr(n,t)||ei.easeOut):ei[e]}function Pc(e,t,n,{delay:i=0,duration:r=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:c}={},d=void 0){const u={[t]:n};c&&(u.offset=c);const p=qr(l,r);Array.isArray(p)&&(u.easing=p);const h={delay:i,duration:r,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(h.pseudoElement=d),e.animate(u,h)}function Xr(e){return typeof e=="function"&&"applyToOptions"in e}function Ic({type:e,...t}){return Xr(e)&&Kr()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class Lc extends sn{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:n,name:i,keyframes:r,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=t,Hs(typeof t.type!="string");const d=Ic(t);this.animation=Pc(n,i,r,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const u=tn(r,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(u):Rc(n,i,u),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var n,i,r;const t=(n=this.options)==null?void 0:n.element;!this.isPseudoElement&&(t!=null&&t.isConnected)&&((r=(i=this.animation).commitStyles)==null||r.call(i))}get duration(){var n,i;const t=((i=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:i.call(n).duration)||0;return Q(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Q(t)}get time(){return Q(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=oe(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&Ec()?(this.animation.timeline=t,ee):n(this)}}const Zr={anticipate:Cr,backInOut:Tr,circInOut:Rr};function Oc(e){return e in Zr}function Vc(e){typeof e.ease=="string"&&Oc(e.ease)&&(e.ease=Zr[e.ease])}const Kt=10;class Fc extends Lc{constructor(t){Vc(t),Hr(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:i,onComplete:r,element:a,...o}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const l=new nn({...o,autoplay:!1}),c=Math.max(Kt,Z.now()-this.startTime),d=ce(0,Kt,c-Kt);n.setWithVelocity(l.sample(Math.max(0,c-d)).value,l.sample(c).value,d),l.stop()}}const ti=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ve.test(e)||e==="0")&&!e.startsWith("url("));function Bc(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function $c(e,t,n,i){const r=e[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],o=ti(r,t),l=ti(a,t);return!o||!l?!1:Bc(e)||(n==="spring"||Xr(n))&&i}function ks(e){e.duration=0,e.type="keyframes"}const Uc=new Set(["opacity","clipPath","filter","transform"]),zc=Gs(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Wc(e){var u;const{motionValue:t,name:n,repeatDelay:i,repeatType:r,damping:a,type:o}=e;if(!(((u=t==null?void 0:t.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=t.owner.getProps();return zc()&&n&&Uc.has(n)&&(n!=="transform"||!d)&&!c&&!i&&r!=="mirror"&&a!==0&&o!=="inertia"}const Hc=40;class Gc extends sn{constructor({autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:c,motionValue:d,element:u,...p}){var f;super(),this.stop=()=>{var g,b;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(b=this.keyframeResolver)==null||b.cancel()},this.createdAt=Z.now();const h={autoplay:t,delay:n,type:i,repeat:r,repeatDelay:a,repeatType:o,name:c,motionValue:d,element:u,...p},m=(u==null?void 0:u.KeyframeResolver)||rn;this.keyframeResolver=new m(l,(g,b,v)=>this.onKeyframesResolved(g,b,h,!v),c,d,u),(f=this.keyframeResolver)==null||f.scheduleResolve()}onKeyframesResolved(t,n,i,r){var b,v;this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:c,isHandoff:d,onUpdate:u}=i;this.resolvedAt=Z.now(),$c(t,a,o,l)||((he.instantAnimations||!c)&&(u==null||u(tn(t,i,n))),t[0]=t[t.length-1],ks(i),i.repeat=0);const h={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>Hc?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:t},m=!d&&Wc(h),f=(v=(b=h.motionValue)==null?void 0:b.owner)==null?void 0:v.current,g=m?new Fc({...h,element:f}):new nn(h);g.finished.then(()=>{this.notifyFinished()}).catch(ee),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),Cc()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}function Jr(e,t,n,i=0,r=1){const a=Array.from(e).sort((d,u)=>d.sortNodePosition(u)).indexOf(t),o=e.size,l=(o-1)*i;return typeof n=="function"?n(a,o):r===1?a*i:l-a*i}const Yc=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Kc(e){const t=Yc.exec(e);if(!t)return[,];const[,n,i,r]=t;return[`--${n??i}`,r]}function Qr(e,t,n=1){const[i,r]=Kc(e);if(!i)return;const a=window.getComputedStyle(t).getPropertyValue(i);if(a){const o=a.trim();return vr(o)?parseFloat(o):o}return Xs(r)?Qr(r,t,n+1):r}const qc={type:"spring",stiffness:500,damping:25,restSpeed:10},Xc=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Zc={type:"keyframes",duration:.8},Jc={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Qc=(e,{keyframes:t})=>t.length>2?Zc:Ge.has(e)?e.startsWith("scale")?Xc(t[1]):qc:Jc,ed=e=>e!==null;function td(e,{repeat:t,repeatType:n="loop"},i){const r=e.filter(ed),a=t&&n!=="loop"&&t%2===1?0:r.length-1;return r[a]}function ea(e,t){if(e!=null&&e.inherit&&t){const{inherit:n,...i}=e;return{...t,...i}}return e}function an(e,t){const n=(e==null?void 0:e[t])??(e==null?void 0:e.default)??e;return n!==e?ea(n,e):n}function sd({when:e,delay:t,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}const on=(e,t,n,i={},r,a)=>o=>{const l=an(i,e)||{},c=l.delay||i.delay||0;let{elapsed:d=0}=i;d=d-oe(c);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-d,onUpdate:h=>{t.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:a?void 0:r};sd(l)||Object.assign(u,Qc(e,u)),u.duration&&(u.duration=oe(u.duration)),u.repeatDelay&&(u.repeatDelay=oe(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let p=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(ks(u),u.delay===0&&(p=!0)),(he.instantAnimations||he.skipAnimations||r!=null&&r.shouldSkipAnimations)&&(p=!0,ks(u),u.delay=0),u.allowFlatten=!l.type&&!l.ease,p&&!a&&t.get()!==void 0){const h=td(u.keyframes,l);if(h!==void 0){L.update(()=>{u.onUpdate(h),u.onComplete()});return}}return l.isSync?new nn(u):new Gc(u)};function si(e){const t=[{},{}];return e==null||e.values.forEach((n,i)=>{t[0][i]=n.get(),t[1][i]=n.getVelocity()}),t}function ln(e,t,n,i){if(typeof t=="function"){const[r,a]=si(i);t=t(n!==void 0?n:e.custom,r,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[r,a]=si(i);t=t(n!==void 0?n:e.custom,r,a)}return t}function Fe(e,t,n){const i=e.getProps();return ln(i,t,n!==void 0?n:i.custom,e)}const ta=new Set(["width","height","top","left","right","bottom",...He]),ni=30,nd=e=>!isNaN(parseFloat(e));class id{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{var a;const r=Z.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Z.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=nd(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new Ys);const i=this.events[t].add(n);return t==="change"?()=>{i(),L.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Z.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>ni)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,ni);return wr(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,n;(t=this.dependents)==null||t.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function $e(e,t){return new id(e,t)}const Ss=e=>Array.isArray(e);function rd(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,$e(n))}function ad(e){return Ss(e)?e[e.length-1]||0:e}function od(e,t){const n=Fe(e,t);let{transitionEnd:i={},transition:r={},...a}=n||{};a={...a,...i};for(const o in a){const l=ad(a[o]);rd(e,o,l)}}const X=e=>!!(e&&e.getVelocity);function ld(e){return!!(X(e)&&e.add)}function As(e,t){const n=e.getValue("willChange");if(ld(n))return n.add(t);if(!n&&he.WillChange){const i=new he.WillChange("auto");e.addValue("willChange",i),i.add(t)}}function cn(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const cd="framerAppearId",sa="data-"+cn(cd);function na(e){return e.props[sa]}function dd({protectedKeys:e,needsAnimating:t},n){const i=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,i}function ia(e,t,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:a,transitionEnd:o,...l}=t;const c=e.getDefaultTransition();a=a?ea(a,c):c;const d=a==null?void 0:a.reduceMotion;i&&(a=i);const u=[],p=r&&e.animationState&&e.animationState.getState()[r];for(const h in l){const m=e.getValue(h,e.latestValues[h]??null),f=l[h];if(f===void 0||p&&dd(p,h))continue;const g={delay:n,...an(a||{},h)},b=m.get();if(b!==void 0&&!m.isAnimating&&!Array.isArray(f)&&f===b&&!g.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const T=na(e);if(T){const S=window.MotionHandoffAnimation(T,h,L);S!==null&&(g.startTime=S,v=!0)}}As(e,h);const w=d??e.shouldReduceMotion;m.start(on(h,m,f,w&&ta.has(h)?{type:!1}:g,e,v));const A=m.animation;A&&u.push(A)}if(o){const h=()=>L.update(()=>{o&&od(e,o)});u.length?Promise.all(u).then(h):h()}return u}function Ts(e,t,n={}){var c;const i=Fe(e,t,n.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:r=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const a=i?()=>Promise.all(ia(e,i,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:p,staggerDirection:h}=r;return ud(e,t,d,u,p,h,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[d,u]=l==="beforeChildren"?[a,o]:[o,a];return d().then(()=>u())}else return Promise.all([a(),o(n.delay)])}function ud(e,t,n=0,i=0,r=0,a=1,o){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(Ts(c,t,{...o,delay:n+(typeof i=="function"?0:i)+Jr(e.variantChildren,c,i,r,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}function hd(e,t,n={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const r=t.map(a=>Ts(e,a,n));i=Promise.all(r)}else if(typeof t=="string")i=Ts(e,t,n);else{const r=typeof t=="function"?Fe(e,t,n.custom):t;i=Promise.all(ia(e,r,n))}return i.then(()=>{e.notify("AnimationComplete",t)})}const pd={test:e=>e==="auto",parse:e=>e},ra=e=>t=>t.test(e),aa=[We,R,le,me,Bl,Fl,pd],ii=e=>aa.find(ra(e));function md(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||jr(e):!0}const fd=new Set(["brightness","contrast","saturate","opacity"]);function xd(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=n.match(Zs)||[];if(!i)return e;const r=n.replace(i,"");let a=fd.has(t)?1:0;return i!==n&&(a*=100),t+"("+a+r+")"}const gd=/\b([a-z-]*)\(.*?\)/gu,Cs={...ve,getAnimatableNone:e=>{const t=e.match(gd);return t?t.map(xd).join(" "):e}},ri={...We,transform:Math.round},bd={rotate:me,rotateX:me,rotateY:me,rotateZ:me,scale:xt,scaleX:xt,scaleY:xt,scaleZ:xt,skew:me,skewX:me,skewY:me,distance:R,translateX:R,translateY:R,translateZ:R,x:R,y:R,z:R,perspective:R,transformPerspective:R,opacity:st,originX:Hn,originY:Hn,originZ:R},dn={borderWidth:R,borderTopWidth:R,borderRightWidth:R,borderBottomWidth:R,borderLeftWidth:R,borderRadius:R,borderTopLeftRadius:R,borderTopRightRadius:R,borderBottomRightRadius:R,borderBottomLeftRadius:R,width:R,maxWidth:R,height:R,maxHeight:R,top:R,right:R,bottom:R,left:R,inset:R,insetBlock:R,insetBlockStart:R,insetBlockEnd:R,insetInline:R,insetInlineStart:R,insetInlineEnd:R,padding:R,paddingTop:R,paddingRight:R,paddingBottom:R,paddingLeft:R,paddingBlock:R,paddingBlockStart:R,paddingBlockEnd:R,paddingInline:R,paddingInlineStart:R,paddingInlineEnd:R,margin:R,marginTop:R,marginRight:R,marginBottom:R,marginLeft:R,marginBlock:R,marginBlockStart:R,marginBlockEnd:R,marginInline:R,marginInlineStart:R,marginInlineEnd:R,fontSize:R,backgroundPositionX:R,backgroundPositionY:R,...bd,zIndex:ri,fillOpacity:st,strokeOpacity:st,numOctaves:ri},vd={...dn,color:$,backgroundColor:$,outlineColor:$,fill:$,stroke:$,borderColor:$,borderTopColor:$,borderRightColor:$,borderBottomColor:$,borderLeftColor:$,filter:Cs,WebkitFilter:Cs},oa=e=>vd[e];function la(e,t){let n=oa(e);return n!==Cs&&(n=ve),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const yd=new Set(["auto","none","0"]);function jd(e,t,n){let i=0,r;for(;i<e.length&&!r;){const a=e[i];typeof a=="string"&&!yd.has(a)&&nt(a).values.length&&(r=e[i]),i++}if(r&&n)for(const a of t)e[a]=la(n,r)}class wd extends rn{constructor(t,n,i,r,a){super(t,n,i,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let p=t[u];if(typeof p=="string"&&(p=p.trim(),Xs(p))){const h=Qr(p,n.current);h!==void 0&&(t[u]=h),u===t.length-1&&(this.finalKeyframe=p)}}if(this.resolveNoneKeyframes(),!ta.has(i)||t.length!==2)return;const[r,a]=t,o=ii(r),l=ii(a),c=Wn(r),d=Wn(a);if(c!==d&&ge[i]){this.needsMeasurement=!0;return}if(o!==l)if(Qn(o)&&Qn(l))for(let u=0;u<t.length;u++){const p=t[u];typeof p=="string"&&(t[u]=parseFloat(p))}else ge[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,i=[];for(let r=0;r<t.length;r++)(t[r]===null||md(t[r]))&&i.push(r);i.length&&jd(t,i,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ge[i](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&t.getValue(i,r).jump(r,!1)}measureEndState(){var l;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=ge[n](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([c,d])=>{t.getValue(c).set(d)}),this.resolveNoneKeyframes()}}function ca(e,t,n){if(e==null)return[];if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;const r=(n==null?void 0:n[e])??i.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e).filter(i=>i!=null)}const da=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function Ms(e){return yr(e)&&"offsetHeight"in e}const{schedule:un}=_r(queueMicrotask,!1),se={x:!1,y:!1};function ua(){return se.x||se.y}function Nd(e){return e==="x"||e==="y"?se[e]?null:(se[e]=!0,()=>{se[e]=!1}):se.x||se.y?null:(se.x=se.y=!0,()=>{se.x=se.y=!1})}function ha(e,t){const n=ca(e),i=new AbortController,r={passive:!0,...t,signal:i.signal};return[n,r,()=>i.abort()]}function kd(e){return!(e.pointerType==="touch"||ua())}function Sd(e,t,n={}){const[i,r,a]=ha(e,n);return i.forEach(o=>{let l=!1,c=!1,d;const u=()=>{o.removeEventListener("pointerleave",f)},p=b=>{d&&(d(b),d=void 0),u()},h=b=>{l=!1,window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",h),c&&(c=!1,p(b))},m=()=>{l=!0,window.addEventListener("pointerup",h,r),window.addEventListener("pointercancel",h,r)},f=b=>{if(b.pointerType!=="touch"){if(l){c=!0;return}p(b)}},g=b=>{if(!kd(b))return;c=!1;const v=t(o,b);typeof v=="function"&&(d=v,o.addEventListener("pointerleave",f,r))};o.addEventListener("pointerenter",g,r),o.addEventListener("pointerdown",m,r)}),a}const pa=(e,t)=>t?e===t?!0:pa(e,t.parentElement):!1,hn=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Ad=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Td(e){return Ad.has(e.tagName)||e.isContentEditable===!0}const Cd=new Set(["INPUT","SELECT","TEXTAREA"]);function Md(e){return Cd.has(e.tagName)||e.isContentEditable===!0}const kt=new WeakSet;function ai(e){return t=>{t.key==="Enter"&&e(t)}}function qt(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Rd=(e,t)=>{const n=e.currentTarget;if(!n)return;const i=ai(()=>{if(kt.has(n))return;qt(n,"down");const r=ai(()=>{qt(n,"up")}),a=()=>qt(n,"cancel");n.addEventListener("keyup",r,t),n.addEventListener("blur",a,t)});n.addEventListener("keydown",i,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),t)};function oi(e){return hn(e)&&!ua()}const li=new WeakSet;function Ed(e,t,n={}){const[i,r,a]=ha(e,n),o=l=>{const c=l.currentTarget;if(!oi(l)||li.has(l))return;kt.add(c),n.stopPropagation&&li.add(l);const d=t(c,l),u=(m,f)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",h),kt.has(c)&&kt.delete(c),oi(m)&&typeof d=="function"&&d(m,{success:f})},p=m=>{u(m,c===window||c===document||n.useGlobalTarget||pa(c,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",h,r)};return i.forEach(l=>{(n.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),Ms(l)&&(l.addEventListener("focus",d=>Rd(d,r)),!Td(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function pn(e){return yr(e)&&"ownerSVGElement"in e}const St=new WeakMap;let fe;const ma=(e,t,n)=>(i,r)=>r&&r[0]?r[0][e+"Size"]:pn(i)&&"getBBox"in i?i.getBBox()[t]:i[n],Dd=ma("inline","width","offsetWidth"),_d=ma("block","height","offsetHeight");function Pd({target:e,borderBoxSize:t}){var n;(n=St.get(e))==null||n.forEach(i=>{i(e,{get width(){return Dd(e,t)},get height(){return _d(e,t)}})})}function Id(e){e.forEach(Pd)}function Ld(){typeof ResizeObserver>"u"||(fe=new ResizeObserver(Id))}function Od(e,t){fe||Ld();const n=ca(e);return n.forEach(i=>{let r=St.get(i);r||(r=new Set,St.set(i,r)),r.add(t),fe==null||fe.observe(i)}),()=>{n.forEach(i=>{const r=St.get(i);r==null||r.delete(t),r!=null&&r.size||fe==null||fe.unobserve(i)})}}const At=new Set;let Pe;function Vd(){Pe=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};At.forEach(t=>t(e))},window.addEventListener("resize",Pe)}function Fd(e){return At.add(e),Pe||Vd(),()=>{At.delete(e),!At.size&&typeof Pe=="function"&&(window.removeEventListener("resize",Pe),Pe=void 0)}}function ci(e,t){return typeof e=="function"?Fd(e):Od(e,t)}function Bd(e){return pn(e)&&e.tagName==="svg"}const $d=[...aa,$,ve],Ud=e=>$d.find(ra(e)),di=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ie=()=>({x:di(),y:di()}),ui=()=>({min:0,max:0}),W=()=>({x:ui(),y:ui()}),Rs={current:null},fa={current:!1},zd=typeof window<"u";function Wd(){if(fa.current=!0,!!zd)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Rs.current=e.matches;e.addEventListener("change",t),t()}else Rs.current=!1}const Hd=new WeakMap;function Ft(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function it(e){return typeof e=="string"||Array.isArray(e)}const mn=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],fn=["initial",...mn];function Bt(e){return Ft(e.animate)||fn.some(t=>it(e[t]))}function xa(e){return!!(Bt(e)||e.variants)}function Gd(e,t,n){for(const i in t){const r=t[i],a=n[i];if(X(r))e.addValue(i,r);else if(X(a))e.addValue(i,$e(r,{owner:e}));else if(a!==r)if(e.hasValue(i)){const o=e.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=e.getStaticValue(i);e.addValue(i,$e(o!==void 0?o:r,{owner:e}))}}for(const i in n)t[i]===void 0&&e.removeValue(i);return t}const hi=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Dt={};function ga(e){Dt=e}function Yd(){return Dt}class Kd{scrapeMotionValuesFromProps(t,n,i){return{}}constructor({parent:t,props:n,presenceContext:i,reducedMotionConfig:r,skipAnimations:a,blockInitialAnimation:o,visualState:l},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=rn,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Z.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,L.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=l;this.latestValues=d,this.baseTarget={...d},this.initialValues=n.initial?{...d}:{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.skipAnimationsConfig=a,this.options=c,this.blockInitialAnimation=!!o,this.isControllingVariants=Bt(n),this.isVariantNode=xa(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:p,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in h){const f=h[m];d[m]!==void 0&&X(f)&&f.set(d[m])}}mount(t){var n,i;if(this.hasBeenMounted)for(const r in this.initialValues)(n=this.values.get(r))==null||n.jump(this.initialValues[r]),this.latestValues[r]=this.initialValues[r];this.current=t,Hd.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,a)=>this.bindToMotionValue(a,r)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(fa.current||Wd(),this.shouldReduceMotion=Rs.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,(i=this.parent)==null||i.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){var t;this.projection&&this.projection.unmount(),be(this.notifyUpdate),be(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const i=this.features[n];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=Ge.has(t);i&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&L.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;typeof window<"u"&&window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{r(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Dt){const n=Dt[t];if(!n)continue;const{isEnabled:i,Feature:r}=n;if(!this.features[t]&&r&&i(this.props)&&(this.features[t]=new r(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):W()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<hi.length;i++){const r=hi[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const a="on"+r,o=t[a];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=Gd(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const i=this.values.get(t);n!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&n!==void 0&&(i=$e(n===null?void 0:n,{owner:this}),this.addValue(t,i)),i}readValue(t,n){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(vr(i)||jr(i))?i=parseFloat(i):!Ud(i)&&ve.test(n)&&(i=la(t,n)),this.setBaseTarget(t,X(i)?i.get():i)),X(i)?i.get():i}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var a;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const o=ln(this.props,n,(a=this.presenceContext)==null?void 0:a.custom);o&&(i=o[t])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,t);return r!==void 0&&!X(r)?r:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new Ys),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){un.render(this.render)}}class ba extends Kd{constructor(){super(...arguments),this.KeyframeResolver=wd}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){const i=t.style;return i?i[n]:void 0}removeValueFromRenderState(t,{vars:n,style:i}){delete n[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;X(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}class ye{constructor(t){this.isMounted=!1,this.node=t}update(){}}function va({top:e,left:t,right:n,bottom:i}){return{x:{min:t,max:n},y:{min:e,max:i}}}function qd({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Xd(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function Xt(e){return e===void 0||e===1}function Es({scale:e,scaleX:t,scaleY:n}){return!Xt(e)||!Xt(t)||!Xt(n)}function Se(e){return Es(e)||ya(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function ya(e){return pi(e.x)||pi(e.y)}function pi(e){return e&&e!=="0%"}function _t(e,t,n){const i=e-n,r=t*i;return n+r}function mi(e,t,n,i,r){return r!==void 0&&(e=_t(e,r,i)),_t(e,n,i)+t}function Ds(e,t=0,n=1,i,r){e.min=mi(e.min,t,n,i,r),e.max=mi(e.max,t,n,i,r)}function ja(e,{x:t,y:n}){Ds(e.x,t.translate,t.scale,t.originPoint),Ds(e.y,n.translate,n.scale,n.originPoint)}const fi=.999999999999,xi=1.0000000000001;function Zd(e,t,n,i=!1){const r=n.length;if(!r)return;t.x=t.y=1;let a,o;for(let l=0;l<r;l++){a=n[l],o=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Oe(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,ja(e,o)),i&&Se(a.latestValues)&&Oe(e,a.latestValues))}t.x<xi&&t.x>fi&&(t.x=1),t.y<xi&&t.y>fi&&(t.y=1)}function Le(e,t){e.min=e.min+t,e.max=e.max+t}function gi(e,t,n,i,r=.5){const a=V(e.min,e.max,r);Ds(e,t,n,a,i)}function Oe(e,t){gi(e.x,t.x,t.scaleX,t.scale,t.originX),gi(e.y,t.y,t.scaleY,t.scale,t.originY)}function wa(e,t){return va(Xd(e.getBoundingClientRect(),t))}function Jd(e,t,n){const i=wa(e,n),{scroll:r}=t;return r&&(Le(i.x,r.offset.x),Le(i.y,r.offset.y)),i}const Qd={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},eu=He.length;function tu(e,t,n){let i="",r=!0;for(let a=0;a<eu;a++){const o=He[a],l=e[o];if(l===void 0)continue;let c=!0;if(typeof l=="number")c=l===(o.startsWith("scale")?1:0);else{const d=parseFloat(l);c=o.startsWith("scale")?d===1:d===0}if(!c||n){const d=da(l,dn[o]);if(!c){r=!1;const u=Qd[o]||o;i+=`${u}(${d}) `}n&&(t[o]=d)}}return i=i.trim(),n?i=n(t,r?"":i):r&&(i="none"),i}function xn(e,t,n){const{style:i,vars:r,transformOrigin:a}=e;let o=!1,l=!1;for(const c in t){const d=t[c];if(Ge.has(c)){o=!0;continue}else if(Ir(c)){r[c]=d;continue}else{const u=da(d,dn[c]);c.startsWith("origin")?(l=!0,a[c]=u):i[c]=u}}if(t.transform||(o||n?i.transform=tu(t,e.transform,n):i.transform&&(i.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:u=0}=a;i.transformOrigin=`${c} ${d} ${u}`}}function Na(e,{style:t,vars:n},i,r){const a=e.style;let o;for(o in t)a[o]=t[o];r==null||r.applyProjectionStyles(a,i);for(o in n)a.setProperty(o,n[o])}function bi(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ye={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(R.test(e))e=parseFloat(e);else return e;const n=bi(e,t.target.x),i=bi(e,t.target.y);return`${n}% ${i}%`}},su={correct:(e,{treeScale:t,projectionDelta:n})=>{const i=e,r=ve.parse(e);if(r.length>5)return i;const a=ve.createTransformer(e),o=typeof r[0]!="number"?1:0,l=n.x.scale*t.x,c=n.y.scale*t.y;r[0+o]/=l,r[1+o]/=c;const d=V(l,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=d),typeof r[3+o]=="number"&&(r[3+o]/=d),a(r)}},_s={borderRadius:{...Ye,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ye,borderTopRightRadius:Ye,borderBottomLeftRadius:Ye,borderBottomRightRadius:Ye,boxShadow:su};function ka(e,{layout:t,layoutId:n}){return Ge.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!_s[e]||e==="opacity")}function gn(e,t,n){var o;const i=e.style,r=t==null?void 0:t.style,a={};if(!i)return a;for(const l in i)(X(i[l])||r&&X(r[l])||ka(l,e)||((o=n==null?void 0:n.getValue(l))==null?void 0:o.liveStyle)!==void 0)&&(a[l]=i[l]);return a}function nu(e){return window.getComputedStyle(e)}class iu extends ba{constructor(){super(...arguments),this.type="html",this.renderInstance=Na}readValueFromInstance(t,n){var i;if(Ge.has(n))return(i=this.projection)!=null&&i.isProjecting?vs(n):Nc(t,n);{const r=nu(t),a=(Ir(n)?r.getPropertyValue(n):r[n])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:n}){return wa(t,n)}build(t,n,i){xn(t,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,n,i){return gn(t,n,i)}}const ru={offset:"stroke-dashoffset",array:"stroke-dasharray"},au={offset:"strokeDashoffset",array:"strokeDasharray"};function ou(e,t,n=1,i=0,r=!0){e.pathLength=1;const a=r?ru:au;e[a.offset]=`${-i}`,e[a.array]=`${t} ${n}`}const lu=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function Sa(e,{attrX:t,attrY:n,attrScale:i,pathLength:r,pathSpacing:a=1,pathOffset:o=0,...l},c,d,u){if(xn(e,l,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:h}=e;p.transform&&(h.transform=p.transform,delete p.transform),(h.transform||p.transformOrigin)&&(h.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete p.transformBox);for(const m of lu)p[m]!==void 0&&(h[m]=p[m],delete p[m]);t!==void 0&&(p.x=t),n!==void 0&&(p.y=n),i!==void 0&&(p.scale=i),r!==void 0&&ou(p,r,a,o,!1)}const Aa=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),Ta=e=>typeof e=="string"&&e.toLowerCase()==="svg";function cu(e,t,n,i){Na(e,t,void 0,i);for(const r in t.attrs)e.setAttribute(Aa.has(r)?r:cn(r),t.attrs[r])}function Ca(e,t,n){const i=gn(e,t,n);for(const r in e)if(X(e[r])||X(t[r])){const a=He.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[a]=e[r]}return i}class du extends ba{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=W}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Ge.has(n)){const i=oa(n);return i&&i.default||0}return n=Aa.has(n)?n:cn(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,i){return Ca(t,n,i)}build(t,n,i){Sa(t,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,n,i,r){cu(t,n,i,r)}mount(t){this.isSVGTag=Ta(t.tagName),super.mount(t)}}const uu=fn.length;function Ma(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?Ma(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<uu;n++){const i=fn[n],r=e.props[i];(it(r)||r===!1)&&(t[i]=r)}return t}function Ra(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}const hu=[...mn].reverse(),pu=mn.length;function mu(e){return t=>Promise.all(t.map(({animation:n,options:i})=>hd(e,n,i)))}function fu(e){let t=mu(e),n=vi(),i=!0;const r=c=>(d,u)=>{var h;const p=Fe(e,u,c==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(p){const{transition:m,transitionEnd:f,...g}=p;d={...d,...g,...f}}return d};function a(c){t=c(e)}function o(c){const{props:d}=e,u=Ma(e.parent)||{},p=[],h=new Set;let m={},f=1/0;for(let b=0;b<pu;b++){const v=hu[b],w=n[v],A=d[v]!==void 0?d[v]:u[v],T=it(A),S=v===c?w.isActive:null;S===!1&&(f=b);let y=A===u[v]&&A!==d[v]&&T;if(y&&i&&e.manuallyAnimateOnMount&&(y=!1),w.protectedKeys={...m},!w.isActive&&S===null||!A&&!w.prevProp||Ft(A)||typeof A=="boolean")continue;const x=xu(w.prevProp,A);let j=x||v===c&&w.isActive&&!y&&T||b>f&&T,k=!1;const M=Array.isArray(A)?A:[A];let E=M.reduce(r(v),{});S===!1&&(E={});const{prevResolvedValues:D={}}=w,_={...D,...E},C=O=>{j=!0,h.has(O)&&(k=!0,h.delete(O)),w.needsAnimating[O]=!0;const P=e.getValue(O);P&&(P.liveStyle=!1)};for(const O in _){const P=E[O],z=D[O];if(m.hasOwnProperty(O))continue;let pe=!1;Ss(P)&&Ss(z)?pe=!Ra(P,z):pe=P!==z,pe?P!=null?C(O):h.add(O):P!==void 0&&h.has(O)?C(O):w.protectedKeys[O]=!0}w.prevProp=A,w.prevResolvedValues=E,w.isActive&&(m={...m,...E}),i&&e.blockInitialAnimation&&(j=!1);const I=y&&x;j&&(!I||k)&&p.push(...M.map(O=>{const P={type:v};if(typeof O=="string"&&i&&!I&&e.manuallyAnimateOnMount&&e.parent){const{parent:z}=e,pe=Fe(z,O);if(z.enteringChildren&&pe){const{delayChildren:je}=pe.transition||{};P.delay=Jr(z.enteringChildren,e,je)}}return{animation:O,options:P}}))}if(h.size){const b={};if(typeof d.initial!="boolean"){const v=Fe(e,Array.isArray(d.initial)?d.initial[0]:d.initial);v&&v.transition&&(b.transition=v.transition)}h.forEach(v=>{const w=e.getBaseTarget(v),A=e.getValue(v);A&&(A.liveStyle=!0),b[v]=w??null}),p.push({animation:b})}let g=!!p.length;return i&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(g=!1),i=!1,g?t(p):Promise.resolve()}function l(c,d){var p;if(n[c].isActive===d)return Promise.resolve();(p=e.variantChildren)==null||p.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,d)}),n[c].isActive=d;const u=o(c);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>n,reset:()=>{n=vi()}}}function xu(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Ra(t,e):!1}function ke(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function vi(){return{animate:ke(!0),whileInView:ke(),whileHover:ke(),whileTap:ke(),whileDrag:ke(),whileFocus:ke(),exit:ke()}}function yi(e,t){e.min=t.min,e.max=t.max}function te(e,t){yi(e.x,t.x),yi(e.y,t.y)}function ji(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}const Ea=1e-4,gu=1-Ea,bu=1+Ea,Da=.01,vu=0-Da,yu=0+Da;function J(e){return e.max-e.min}function ju(e,t,n){return Math.abs(e-t)<=n}function wi(e,t,n,i=.5){e.origin=i,e.originPoint=V(t.min,t.max,e.origin),e.scale=J(n)/J(t),e.translate=V(n.min,n.max,e.origin)-e.originPoint,(e.scale>=gu&&e.scale<=bu||isNaN(e.scale))&&(e.scale=1),(e.translate>=vu&&e.translate<=yu||isNaN(e.translate))&&(e.translate=0)}function Je(e,t,n,i){wi(e.x,t.x,n.x,i?i.originX:void 0),wi(e.y,t.y,n.y,i?i.originY:void 0)}function Ni(e,t,n){e.min=n.min+t.min,e.max=e.min+J(t)}function wu(e,t,n){Ni(e.x,t.x,n.x),Ni(e.y,t.y,n.y)}function ki(e,t,n){e.min=t.min-n.min,e.max=e.min+J(t)}function Pt(e,t,n){ki(e.x,t.x,n.x),ki(e.y,t.y,n.y)}function Si(e,t,n,i,r){return e-=t,e=_t(e,1/n,i),r!==void 0&&(e=_t(e,1/r,i)),e}function Nu(e,t=0,n=1,i=.5,r,a=e,o=e){if(le.test(t)&&(t=parseFloat(t),t=V(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=V(a.min,a.max,i);e===a&&(l-=t),e.min=Si(e.min,t,n,l,r),e.max=Si(e.max,t,n,l,r)}function Ai(e,t,[n,i,r],a,o){Nu(e,t[n],t[i],t[r],t.scale,a,o)}const ku=["x","scaleX","originX"],Su=["y","scaleY","originY"];function Ti(e,t,n,i){Ai(e.x,t,ku,n?n.x:void 0,i?i.x:void 0),Ai(e.y,t,Su,n?n.y:void 0,i?i.y:void 0)}function Ci(e){return e.translate===0&&e.scale===1}function _a(e){return Ci(e.x)&&Ci(e.y)}function Mi(e,t){return e.min===t.min&&e.max===t.max}function Au(e,t){return Mi(e.x,t.x)&&Mi(e.y,t.y)}function Ri(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Pa(e,t){return Ri(e.x,t.x)&&Ri(e.y,t.y)}function Ei(e){return J(e.x)/J(e.y)}function Di(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function ae(e){return[e("x"),e("y")]}function Tu(e,t,n){let i="";const r=e.x.translate/t.x,a=e.y.translate/t.y,o=(n==null?void 0:n.z)||0;if((r||a||o)&&(i=`translate3d(${r}px, ${a}px, ${o}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:d,rotate:u,rotateX:p,rotateY:h,skewX:m,skewY:f}=n;d&&(i=`perspective(${d}px) ${i}`),u&&(i+=`rotate(${u}deg) `),p&&(i+=`rotateX(${p}deg) `),h&&(i+=`rotateY(${h}deg) `),m&&(i+=`skewX(${m}deg) `),f&&(i+=`skewY(${f}deg) `)}const l=e.x.scale*t.x,c=e.y.scale*t.y;return(l!==1||c!==1)&&(i+=`scale(${l}, ${c})`),i||"none"}const Ia=["TopLeft","TopRight","BottomLeft","BottomRight"],Cu=Ia.length,_i=e=>typeof e=="string"?parseFloat(e):e,Pi=e=>typeof e=="number"||R.test(e);function Mu(e,t,n,i,r,a){r?(e.opacity=V(0,n.opacity??1,Ru(i)),e.opacityExit=V(t.opacity??1,0,Eu(i))):a&&(e.opacity=V(t.opacity??1,n.opacity??1,i));for(let o=0;o<Cu;o++){const l=`border${Ia[o]}Radius`;let c=Ii(t,l),d=Ii(n,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||Pi(c)===Pi(d)?(e[l]=Math.max(V(_i(c),_i(d),i),0),(le.test(d)||le.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||n.rotate)&&(e.rotate=V(t.rotate||0,n.rotate||0,i))}function Ii(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Ru=La(0,.5,Mr),Eu=La(.5,.95,ee);function La(e,t,n){return i=>i<e?0:i>t?1:n(tt(e,t,i))}function Du(e,t,n){const i=X(e)?e:$e(e);return i.start(on("",i,t,n)),i.animation}function rt(e,t,n,i={passive:!0}){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}const _u=(e,t)=>e.depth-t.depth;class Pu{constructor(){this.children=[],this.isDirty=!1}add(t){zs(this.children,t),this.isDirty=!0}remove(t){Ws(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(_u),this.isDirty=!1,this.children.forEach(t)}}function Iu(e,t){const n=Z.now(),i=({timestamp:r})=>{const a=r-n;a>=t&&(be(i),e(a-t))};return L.setup(i,!0),()=>be(i)}function Tt(e){return X(e)?e.get():e}class Lu{constructor(){this.members=[]}add(t){zs(this.members,t),t.scheduleRender()}remove(t){if(Ws(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(r=>t===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const a=this.members[r];if(a.isPresent!==!1){i=a;break}}return i?(this.promote(i),!0):!1}promote(t,n){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender();const r=i.options.layoutDependency,a=t.options.layoutDependency;r!==void 0&&a!==void 0&&r===a||(t.resumeFrom=i,n&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0));const{crossfade:l}=t.options;l===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:i}=t;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Ct={hasAnimatedSinceResize:!0,hasEverUpdated:!1},Zt=["","X","Y","Z"],Ou=1e3;let Vu=0;function Jt(e,t,n,i){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),i&&(i[e]=0))}function Oa(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=na(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",L,!(r||a))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&Oa(i)}function Va({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=t==null?void 0:t()){this.id=Vu++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach($u),this.nodes.forEach(Hu),this.nodes.forEach(Gu),this.nodes.forEach(Uu)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Pu)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Ys),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=pn(o)&&!Bd(o),this.instance=o;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let u,p=0;const h=()=>this.root.updateBlockedByResize=!1;L.read(()=>{p=window.innerWidth}),e(o,()=>{const m=window.innerWidth;m!==p&&(p=m,this.root.updateBlockedByResize=!0,u&&u(),u=Iu(h,250),Ct.hasAnimatedSinceResize&&(Ct.hasAnimatedSinceResize=!1,this.nodes.forEach(Vi)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:p,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const f=this.options.transition||d.getDefaultTransition()||Zu,{onLayoutAnimationStart:g,onLayoutAnimationComplete:b}=d.getProps(),v=!this.targetLayout||!Pa(this.targetLayout,m),w=!p&&h;if(this.options.layoutRoot||this.resumeFrom||w||p&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const A={...an(f,"layout"),onPlay:g,onComplete:b};(d.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A),this.setAnimationOrigin(u,w)}else p||Vi(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),be(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Yu),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Oa(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const p=this.path[u];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Li);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Oi);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Wu),this.nodes.forEach(Fu),this.nodes.forEach(Bu)):this.nodes.forEach(Oi),this.clearAllSnapshots();const l=Z.now();Y.delta=ce(0,1e3/60,l-Y.timestamp),Y.timestamp=l,Y.isProcessing=!0,zt.update.process(Y),zt.preRender.process(Y),zt.render.process(Y),Y.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,un.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(zu),this.sharedNodes.forEach(Ku)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,L.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){L.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!J(this.snapshot.measuredBox.x)&&!J(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=W(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!_a(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;o&&this.instance&&(l||Se(this.latestValues)||u)&&(r(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),Ju(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:o}=this.options;if(!o)return W();const l=o.measureViewportBox();if(!(((d=this.scroll)==null?void 0:d.wasRoot)||this.path.some(Qu))){const{scroll:u}=this.root;u&&(Le(l.x,u.offset.x),Le(l.y,u.offset.y))}return l}removeElementScroll(o){var c;const l=W();if(te(l,o),(c=this.scroll)!=null&&c.wasRoot)return l;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:p,options:h}=u;u!==this.root&&p&&h.layoutScroll&&(p.wasRoot&&te(l,o),Le(l.x,p.offset.x),Le(l.y,p.offset.y))}return l}applyTransform(o,l=!1){const c=W();te(c,o);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Oe(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Se(u.latestValues)&&Oe(c,u.latestValues)}return Se(this.latestValues)&&Oe(c,this.latestValues),c}removeTransform(o){const l=W();te(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Se(d.latestValues))continue;Es(d.latestValues)&&d.updateSnapshot();const u=W(),p=d.measurePageBox();te(u,p),Ti(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Se(this.latestValues)&&Ti(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Y.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var m;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:p}=this.options;if(!this.layout||!(u||p))return;this.resolvedRelativeTargetAt=Y.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=W(),this.targetWithTransforms=W()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),wu(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):te(this.target,this.layout.layoutBox),ja(this.target,this.targetDelta)):te(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Es(this.parent.latestValues)||ya(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,l,c){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=W(),this.relativeTargetOrigin=W(),Pt(this.relativeTargetOrigin,l,c),te(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var f;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Y.timestamp&&(c=!1),c)return;const{layout:d,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||u))return;te(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,h=this.treeScale.y;Zd(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=W());const{target:m}=o;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ji(this.prevProjectionDelta.x,this.projectionDelta.x),ji(this.prevProjectionDelta.y,this.projectionDelta.y)),Je(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==h||!Di(this.projectionDelta.x,this.prevProjectionDelta.x)||!Di(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ie(),this.projectionDelta=Ie(),this.projectionDeltaWithTransform=Ie()}setAnimationOrigin(o,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},p=Ie();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=W(),m=c?c.source:void 0,f=this.layout?this.layout.source:void 0,g=m!==f,b=this.getStack(),v=!b||b.members.length<=1,w=!!(g&&!v&&this.options.crossfade===!0&&!this.path.some(Xu));this.animationProgress=0;let A;this.mixTargetDelta=T=>{const S=T/1e3;Fi(p.x,o.x,S),Fi(p.y,o.y,S),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Pt(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),qu(this.relativeTarget,this.relativeTargetOrigin,h,S),A&&Au(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=W()),te(A,this.relativeTarget)),g&&(this.animationValues=u,Mu(u,d,this.latestValues,S,w,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var l,c,d;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(d=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||d.stop(),this.pendingAnimation&&(be(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=L.update(()=>{Ct.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=$e(0)),this.currentAnimation=Du(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Ou),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=o;if(!(!l||!c||!d)){if(this!==o&&this.layout&&d&&Fa(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||W();const p=J(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+p;const h=J(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+h}te(l,c),Oe(l,u),Je(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Lu),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var l;const{layoutId:o}=this.options;return o?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:o}=this.options;return o?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&Jt("z",o,d,this.animationValues);for(let u=0;u<Zt.length;u++)Jt(`rotate${Zt[u]}`,o,d,this.animationValues),Jt(`skew${Zt[u]}`,o,d,this.animationValues);o.render();for(const u in d)o.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Tt(l==null?void 0:l.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Tt(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!Se(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=Tu(this.projectionDeltaWithTransform,this.treeScale,u);c&&(p=c(u,p)),o.transform=p;const{x:h,y:m}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,d.animationValues?o.opacity=d===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=d===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const f in _s){if(u[f]===void 0)continue;const{correct:g,applyTo:b,isCSSVariable:v}=_s[f],w=p==="none"?u[f]:g(u[f],d);if(b){const A=b.length;for(let T=0;T<A;T++)o[b[T]]=w}else v?this.options.visualElement.renderState.vars[f]=w:o[f]=w}this.options.layoutId&&(o.pointerEvents=d===this?Tt(l==null?void 0:l.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(Li),this.root.sharedNodes.clear()}}}function Fu(e){e.updateLayout()}function Bu(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=e.layout,{animationType:a}=e.options,o=t.source!==e.layout.source;a==="size"?ae(p=>{const h=o?t.measuredBox[p]:t.layoutBox[p],m=J(h);h.min=i[p].min,h.max=h.min+m}):Fa(a,t.layoutBox,i)&&ae(p=>{const h=o?t.measuredBox[p]:t.layoutBox[p],m=J(i[p]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[p].max=e.relativeTarget[p].min+m)});const l=Ie();Je(l,i,t.layoutBox);const c=Ie();o?Je(c,e.applyTransform(r,!0),t.measuredBox):Je(c,i,t.layoutBox);const d=!_a(l);let u=!1;if(!e.resumeFrom){const p=e.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:h,layout:m}=p;if(h&&m){const f=W();Pt(f,t.layoutBox,h.layoutBox);const g=W();Pt(g,i,m.layoutBox),Pa(f,g)||(u=!0),p.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=f,e.relativeParent=p)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function $u(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Uu(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function zu(e){e.clearSnapshot()}function Li(e){e.clearMeasurements()}function Oi(e){e.isLayoutDirty=!1}function Wu(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Vi(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Hu(e){e.resolveTargetDelta()}function Gu(e){e.calcProjection()}function Yu(e){e.resetSkewAndRotation()}function Ku(e){e.removeLeadSnapshot()}function Fi(e,t,n){e.translate=V(t.translate,0,n),e.scale=V(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Bi(e,t,n,i){e.min=V(t.min,n.min,i),e.max=V(t.max,n.max,i)}function qu(e,t,n,i){Bi(e.x,t.x,n.x,i),Bi(e.y,t.y,n.y,i)}function Xu(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Zu={duration:.45,ease:[.4,0,.1,1]},$i=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Ui=$i("applewebkit/")&&!$i("chrome/")?Math.round:ee;function zi(e){e.min=Ui(e.min),e.max=Ui(e.max)}function Ju(e){zi(e.x),zi(e.y)}function Fa(e,t,n){return e==="position"||e==="preserve-aspect"&&!ju(Ei(t),Ei(n),.2)}function Qu(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const eh=Va({attachResizeListener:(e,t)=>rt(e,"resize",t),measureScroll:()=>{var e,t;return{x:document.documentElement.scrollLeft||((e=document.body)==null?void 0:e.scrollLeft)||0,y:document.documentElement.scrollTop||((t=document.body)==null?void 0:t.scrollTop)||0}},checkIsScrollRoot:()=>!0}),Qt={current:void 0},Ba=Va({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Qt.current){const e=new eh({});e.mount(window),e.setOptions({layoutScroll:!0}),Qt.current=e}return Qt.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),bn=N.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Wi(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function th(...e){return t=>{let n=!1;const i=e.map(r=>{const a=Wi(r,t);return!n&&typeof a=="function"&&(n=!0),a});if(n)return()=>{for(let r=0;r<i.length;r++){const a=i[r];typeof a=="function"?a():Wi(e[r],null)}}}}function sh(...e){return N.useCallback(th(...e),e)}class nh extends N.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent&&this.props.pop!==!1){const i=n.offsetParent,r=Ms(i)&&i.offsetWidth||0,a=Ms(i)&&i.offsetHeight||0,o=this.props.sizeRef.current;o.height=n.offsetHeight||0,o.width=n.offsetWidth||0,o.top=n.offsetTop,o.left=n.offsetLeft,o.right=r-o.width-o.left,o.bottom=a-o.height-o.top}return null}componentDidUpdate(){}render(){return this.props.children}}function ih({children:e,isPresent:t,anchorX:n,anchorY:i,root:r,pop:a}){var h;const o=N.useId(),l=N.useRef(null),c=N.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:d}=N.useContext(bn),u=((h=e.props)==null?void 0:h.ref)??(e==null?void 0:e.ref),p=sh(l,u);return N.useInsertionEffect(()=>{const{width:m,height:f,top:g,left:b,right:v,bottom:w}=c.current;if(t||a===!1||!l.current||!m||!f)return;const A=n==="left"?`left: ${b}`:`right: ${v}`,T=i==="bottom"?`bottom: ${w}`:`top: ${g}`;l.current.dataset.motionPopId=o;const S=document.createElement("style");d&&(S.nonce=d);const y=r??document.head;return y.appendChild(S),S.sheet&&S.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${f}px !important;
            ${A}px !important;
            ${T}px !important;
          }
        `),()=>{y.contains(S)&&y.removeChild(S)}},[t]),s.jsx(nh,{isPresent:t,childRef:l,sizeRef:c,pop:a,children:a===!1?e:N.cloneElement(e,{ref:p})})}const rh=({children:e,initial:t,isPresent:n,onExitComplete:i,custom:r,presenceAffectsLayout:a,mode:o,anchorX:l,anchorY:c,root:d})=>{const u=Us(ah),p=N.useId();let h=!0,m=N.useMemo(()=>(h=!1,{id:p,initial:t,isPresent:n,custom:r,onExitComplete:f=>{u.set(f,!0);for(const g of u.values())if(!g)return;i&&i()},register:f=>(u.set(f,!1),()=>u.delete(f))}),[n,u,i]);return a&&h&&(m={...m}),N.useMemo(()=>{u.forEach((f,g)=>u.set(g,!1))},[n]),N.useEffect(()=>{!n&&!u.size&&i&&i()},[n]),e=s.jsx(ih,{pop:o==="popLayout",isPresent:n,anchorX:l,anchorY:c,root:d,children:e}),s.jsx(Vt.Provider,{value:m,children:e})};function ah(){return new Map}function $a(e=!0){const t=N.useContext(Vt);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=t,a=N.useId();N.useEffect(()=>{if(e)return r(a)},[e]);const o=N.useCallback(()=>e&&i&&i(a),[a,i,e]);return!n&&i?[!1,o]:[!0]}const gt=e=>e.key||"";function Hi(e){const t=[];return N.Children.forEach(e,n=>{N.isValidElement(n)&&t.push(n)}),t}const Ua=({children:e,custom:t,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",anchorY:c="top",root:d})=>{const[u,p]=$a(o),h=N.useMemo(()=>Hi(e),[e]),m=o&&!u?[]:h.map(gt),f=N.useRef(!0),g=N.useRef(h),b=Us(()=>new Map),v=N.useRef(new Set),[w,A]=N.useState(h),[T,S]=N.useState(h);br(()=>{f.current=!1,g.current=h;for(let j=0;j<T.length;j++){const k=gt(T[j]);m.includes(k)?(b.delete(k),v.current.delete(k)):b.get(k)!==!0&&b.set(k,!1)}},[T,m.length,m.join("-")]);const y=[];if(h!==w){let j=[...h];for(let k=0;k<T.length;k++){const M=T[k],E=gt(M);m.includes(E)||(j.splice(k,0,M),y.push(M))}return a==="wait"&&y.length&&(j=y),S(Hi(j)),A(h),null}const{forceRender:x}=N.useContext($s);return s.jsx(s.Fragment,{children:T.map(j=>{const k=gt(j),M=o&&!u?!1:h===T||m.includes(k),E=()=>{if(v.current.has(k))return;if(v.current.add(k),b.has(k))b.set(k,!0);else return;let D=!0;b.forEach(_=>{_||(D=!1)}),D&&(x==null||x(),S(g.current),o&&(p==null||p()),i&&i())};return s.jsx(rh,{isPresent:M,initial:!f.current||n?void 0:!1,custom:t,presenceAffectsLayout:r,mode:a,root:d,onExitComplete:M?void 0:E,anchorX:l,anchorY:c,children:j},k)})})},za=N.createContext({strict:!1}),Gi={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let Yi=!1;function oh(){if(Yi)return;const e={};for(const t in Gi)e[t]={isEnabled:n=>Gi[t].some(i=>!!n[i])};ga(e),Yi=!0}function Wa(){return oh(),Yd()}function lh(e){const t=Wa();for(const n in e)t[n]={...t[n],...e[n]};ga(t)}const ch=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function It(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||ch.has(e)}let Ha=e=>!It(e);function dh(e){typeof e=="function"&&(Ha=t=>t.startsWith("on")?!It(t):e(t))}try{dh(require("@emotion/is-prop-valid").default)}catch{}function uh(e,t,n){const i={};for(const r in e)r==="values"&&typeof e.values=="object"||(Ha(r)||n===!0&&It(r)||!t&&!It(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}const $t=N.createContext({});function hh(e,t){if(Bt(e)){const{initial:n,animate:i}=e;return{initial:n===!1||it(n)?n:void 0,animate:it(i)?i:void 0}}return e.inherit!==!1?t:{}}function ph(e){const{initial:t,animate:n}=hh(e,N.useContext($t));return N.useMemo(()=>({initial:t,animate:n}),[Ki(t),Ki(n)])}function Ki(e){return Array.isArray(e)?e.join(" "):e}const vn=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Ga(e,t,n){for(const i in t)!X(t[i])&&!ka(i,n)&&(e[i]=t[i])}function mh({transformTemplate:e},t){return N.useMemo(()=>{const n=vn();return xn(n,t,e),Object.assign({},n.vars,n.style)},[t])}function fh(e,t){const n=e.style||{},i={};return Ga(i,n,e),Object.assign(i,mh(e,t)),i}function xh(e,t){const n={},i=fh(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const Ya=()=>({...vn(),attrs:{}});function gh(e,t,n,i){const r=N.useMemo(()=>{const a=Ya();return Sa(a,t,Ta(i),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};Ga(a,e.style,e),r.style={...a,...r.style}}return r}const bh=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function yn(e){return typeof e!="string"||e.includes("-")?!1:!!(bh.indexOf(e)>-1||/[A-Z]/u.test(e))}function vh(e,t,n,{latestValues:i},r,a=!1,o){const c=(o??yn(e)?gh:xh)(t,i,r,e),d=uh(t,typeof e=="string",a),u=e!==N.Fragment?{...d,...c,ref:n}:{},{children:p}=t,h=N.useMemo(()=>X(p)?p.get():p,[p]);return N.createElement(e,{...u,children:h})}function yh({scrapeMotionValuesFromProps:e,createRenderState:t},n,i,r){return{latestValues:jh(n,i,r,e),renderState:t()}}function jh(e,t,n,i){const r={},a=i(e,{});for(const h in a)r[h]=Tt(a[h]);let{initial:o,animate:l}=e;const c=Bt(e),d=xa(e);t&&d&&!c&&e.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const p=u?l:o;if(p&&typeof p!="boolean"&&!Ft(p)){const h=Array.isArray(p)?p:[p];for(let m=0;m<h.length;m++){const f=ln(e,h[m]);if(f){const{transitionEnd:g,transition:b,...v}=f;for(const w in v){let A=v[w];if(Array.isArray(A)){const T=u?A.length-1:0;A=A[T]}A!==null&&(r[w]=A)}for(const w in g)r[w]=g[w]}}}return r}const Ka=e=>(t,n)=>{const i=N.useContext($t),r=N.useContext(Vt),a=()=>yh(e,t,i,r);return n?a():Us(a)},wh=Ka({scrapeMotionValuesFromProps:gn,createRenderState:vn}),Nh=Ka({scrapeMotionValuesFromProps:Ca,createRenderState:Ya}),kh=Symbol.for("motionComponentSymbol");function Sh(e,t,n){const i=N.useRef(n);N.useInsertionEffect(()=>{i.current=n});const r=N.useRef(null);return N.useCallback(a=>{var l;a&&((l=e.onMount)==null||l.call(e,a)),t&&(a?t.mount(a):t.unmount());const o=i.current;if(typeof o=="function")if(a){const c=o(a);typeof c=="function"&&(r.current=c)}else r.current?(r.current(),r.current=null):o(a);else o&&(o.current=a)},[t])}const qa=N.createContext({});function De(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Ah(e,t,n,i,r,a){var A,T;const{visualElement:o}=N.useContext($t),l=N.useContext(za),c=N.useContext(Vt),d=N.useContext(bn),u=d.reducedMotion,p=d.skipAnimations,h=N.useRef(null),m=N.useRef(!1);i=i||l.renderer,!h.current&&i&&(h.current=i(e,{visualState:t,parent:o,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u,skipAnimations:p,isSVG:a}),m.current&&h.current&&(h.current.manuallyAnimateOnMount=!0));const f=h.current,g=N.useContext(qa);f&&!f.projection&&r&&(f.type==="html"||f.type==="svg")&&Th(h.current,n,r,g);const b=N.useRef(!1);N.useInsertionEffect(()=>{f&&b.current&&f.update(n,c)});const v=n[sa],w=N.useRef(!!v&&!((A=window.MotionHandoffIsComplete)!=null&&A.call(window,v))&&((T=window.MotionHasOptimisedAnimation)==null?void 0:T.call(window,v)));return br(()=>{m.current=!0,f&&(b.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),w.current&&f.animationState&&f.animationState.animateChanges())}),N.useEffect(()=>{f&&(!w.current&&f.animationState&&f.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,v)}),w.current=!1),f.enteringChildren=void 0)}),f}function Th(e,t,n,i){const{layoutId:r,layout:a,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:d,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Xa(e.parent)),e.projection.setOptions({layoutId:r,layout:a,alwaysMeasureLayout:!!o||l&&De(l),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:i,crossfade:u,layoutScroll:c,layoutRoot:d})}function Xa(e){if(e)return e.options.allowProjection!==!1?e.projection:Xa(e.parent)}function es(e,{forwardMotionProps:t=!1,type:n}={},i,r){i&&lh(i);const a=n?n==="svg":yn(e),o=a?Nh:wh;function l(d,u){let p;const h={...N.useContext(bn),...d,layoutId:Ch(d)},{isStatic:m}=h,f=ph(d),g=o(d,m);if(!m&&gr){Mh();const b=Rh(h);p=b.MeasureLayout,f.visualElement=Ah(e,g,h,r,b.ProjectionNode,a)}return s.jsxs($t.Provider,{value:f,children:[p&&f.visualElement?s.jsx(p,{visualElement:f.visualElement,...h}):null,vh(e,d,Sh(g,f.visualElement,u),g,m,t,a)]})}l.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const c=N.forwardRef(l);return c[kh]=e,c}function Ch({layoutId:e}){const t=N.useContext($s).id;return t&&e!==void 0?t+"-"+e:e}function Mh(e,t){N.useContext(za).strict}function Rh(e){const t=Wa(),{drag:n,layout:i}=t;if(!n&&!i)return{};const r={...n,...i};return{MeasureLayout:n!=null&&n.isEnabled(e)||i!=null&&i.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Eh(e,t){if(typeof Proxy>"u")return es;const n=new Map,i=(a,o)=>es(a,o,e,t),r=(a,o)=>i(a,o);return new Proxy(r,{get:(a,o)=>o==="create"?i:(n.has(o)||n.set(o,es(o,void 0,e,t)),n.get(o))})}const Dh=(e,t)=>t.isSVG??yn(e)?new du(t):new iu(t,{allowProjection:e!==N.Fragment});class _h extends ye{constructor(t){super(t),t.animationState||(t.animationState=fu(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Ft(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let Ph=0;class Ih extends ye{constructor(){super(...arguments),this.id=Ph++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const r=this.node.animationState.setActive("exit",!t);n&&!t&&r.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Lh={animation:{Feature:_h},exit:{Feature:Ih}};function dt(e){return{point:{x:e.pageX,y:e.pageY}}}const Oh=e=>t=>hn(t)&&e(t,dt(t));function Qe(e,t,n,i){return rt(e,t,Oh(n),i)}const Za=({current:e})=>e?e.ownerDocument.defaultView:null,qi=(e,t)=>Math.abs(e-t);function Vh(e,t){const n=qi(e.x,t.x),i=qi(e.y,t.y);return Math.sqrt(n**2+i**2)}const Xi=new Set(["auto","scroll"]);class Ja{constructor(t,n,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3,element:l}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=m=>{this.handleScroll(m.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=ss(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,g=Vh(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!g)return;const{point:b}=m,{timestamp:v}=Y;this.history.push({...b,timestamp:v});const{onStart:w,onMove:A}=this.handlers;f||(w&&w(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,m)},this.handlePointerMove=(m,f)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=ts(f,this.transformPagePoint),L.update(this.updatePoint,!0)},this.handlePointerUp=(m,f)=>{this.end();const{onEnd:g,onSessionEnd:b,resumeAnimation:v}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=ss(m.type==="pointercancel"?this.lastMoveEventInfo:ts(f,this.transformPagePoint),this.history);this.startEvent&&g&&g(m,w),b&&b(m,w)},!hn(t))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const c=dt(t),d=ts(c,this.transformPagePoint),{point:u}=d,{timestamp:p}=Y;this.history=[{...u,timestamp:p}];const{onSessionStart:h}=n;h&&h(t,ss(d,this.history)),this.removeListeners=ot(Qe(this.contextWindow,"pointermove",this.handlePointerMove),Qe(this.contextWindow,"pointerup",this.handlePointerUp),Qe(this.contextWindow,"pointercancel",this.handlePointerUp)),l&&this.startScrollTracking(l)}startScrollTracking(t){let n=t.parentElement;for(;n;){const i=getComputedStyle(n);(Xi.has(i.overflowX)||Xi.has(i.overflowY))&&this.scrollPositions.set(n,{x:n.scrollLeft,y:n.scrollTop}),n=n.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const n=this.scrollPositions.get(t);if(!n)return;const i=t===window,r=i?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},a={x:r.x-n.x,y:r.y-n.y};a.x===0&&a.y===0||(i?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=a.x,this.lastMoveEventInfo.point.y+=a.y):this.history.length>0&&(this.history[0].x-=a.x,this.history[0].y-=a.y),this.scrollPositions.set(t,r),L.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),be(this.updatePoint)}}function ts(e,t){return t?{point:t(e.point)}:e}function Zi(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ss({point:e},t){return{point:e,delta:Zi(e,Qa(t)),offset:Zi(e,Fh(t)),velocity:Bh(t,.1)}}function Fh(e){return e[0]}function Qa(e){return e[e.length-1]}function Bh(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=Qa(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>oe(t)));)n--;if(!i)return{x:0,y:0};i===e[0]&&e.length>2&&r.timestamp-i.timestamp>oe(t)*2&&(i=e[1]);const a=Q(r.timestamp-i.timestamp);if(a===0)return{x:0,y:0};const o={x:(r.x-i.x)/a,y:(r.y-i.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function $h(e,{min:t,max:n},i){return t!==void 0&&e<t?e=i?V(t,e,i.min):Math.max(e,t):n!==void 0&&e>n&&(e=i?V(n,e,i.max):Math.min(e,n)),e}function Ji(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function Uh(e,{top:t,left:n,bottom:i,right:r}){return{x:Ji(e.x,n,r),y:Ji(e.y,t,i)}}function Qi(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function zh(e,t){return{x:Qi(e.x,t.x),y:Qi(e.y,t.y)}}function Wh(e,t){let n=.5;const i=J(e),r=J(t);return r>i?n=tt(t.min,t.max-i,e.min):i>r&&(n=tt(e.min,e.max-r,t.min)),ce(0,1,n)}function Hh(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const Ps=.35;function Gh(e=Ps){return e===!1?e=0:e===!0&&(e=Ps),{x:er(e,"left","right"),y:er(e,"top","bottom")}}function er(e,t,n){return{min:tr(e,t),max:tr(e,n)}}function tr(e,t){return typeof e=="number"?e:e[t]||0}const Yh=new WeakMap;class Kh{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=W(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const a=p=>{n&&this.snapToCursor(dt(p).point),this.stopAnimation()},o=(p,h)=>{const{drag:m,dragPropagation:f,onDragStart:g}=this.getProps();if(m&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Nd(m),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ae(v=>{let w=this.getAxisMotionValue(v).get()||0;if(le.test(w)){const{projection:A}=this.visualElement;if(A&&A.layout){const T=A.layout.layoutBox[v];T&&(w=J(T)*(parseFloat(w)/100))}}this.originPoint[v]=w}),g&&L.update(()=>g(p,h),!1,!0),As(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},l=(p,h)=>{this.latestPointerEvent=p,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:f,onDirectionLock:g,onDrag:b}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:v}=h;if(f&&this.currentDirection===null){this.currentDirection=Xh(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,v),this.updateAxis("y",h.point,v),this.visualElement.render(),b&&L.update(()=>b(p,h),!1,!0)},c=(p,h)=>{this.latestPointerEvent=p,this.latestPanInfo=h,this.stop(p,h),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>{const{dragSnapToOrigin:p}=this.getProps();(p||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:u}=this.getProps();this.panSession=new Ja(t,{onSessionStart:a,onStart:o,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:i,contextWindow:Za(this.visualElement),element:this.visualElement.current})}stop(t,n){const i=t||this.latestPointerEvent,r=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&L.postRender(()=>l(i,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,n,i){const{drag:r}=this.getProps();if(!i||!bt(t,r,this.currentDirection))return;const a=this.getAxisMotionValue(t);let o=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(o=$h(o,this.constraints[t],this.elastic[t])),a.set(o)}resolveConstraints(){var a;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,r=this.constraints;t&&De(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Uh(i.layoutBox,t):this.constraints=!1,this.elastic=Gh(n),r!==this.constraints&&!De(t)&&i&&this.constraints&&!this.hasMutatedConstraints&&ae(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Hh(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!De(t))return!1;const i=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=Jd(i,r.root,this.visualElement.getTransformPagePoint());let o=zh(r.layout.layoutBox,a);if(n){const l=n(qd(o));this.hasMutatedConstraints=!!l,l&&(o=va(l))}return o}startAnimation(t){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=ae(u=>{if(!bt(u,n,this.currentDirection))return;let p=c&&c[u]||{};o&&(p={min:0,max:0});const h=r?200:1e6,m=r?40:1e7,f={type:"inertia",velocity:i?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(u,f)});return Promise.all(d).then(l)}startAxisValueAnimation(t,n){const i=this.getAxisMotionValue(t);return As(this.visualElement,t),i.start(on(t,i,0,n,this.visualElement,!1))}stopAnimation(){ae(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){ae(n=>{const{drag:i}=this.getProps();if(!bt(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[n],c=a.get()||0;a.set(t[n]-V(o,l,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!De(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};ae(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();r[o]=Wh({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.constraints=!1,this.resolveConstraints(),ae(o=>{if(!bt(o,t,null))return;const l=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];l.set(V(c,d,r[o]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;Yh.set(this.visualElement,this);const t=this.visualElement.current,n=Qe(t,"pointerdown",d=>{const{drag:u,dragListener:p=!0}=this.getProps(),h=d.target,m=h!==t&&Md(h);u&&p&&!m&&this.start(d)});let i;const r=()=>{const{dragConstraints:d}=this.getProps();De(d)&&d.current&&(this.constraints=this.resolveRefConstraints(),i||(i=qh(t,d.current,()=>this.scalePositionWithinConstraints())))},{projection:a}=this.visualElement,o=a.addEventListener("measure",r);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),L.read(r);const l=rt(window,"resize",()=>this.scalePositionWithinConstraints()),c=a.addEventListener("didUpdate",(({delta:d,hasLayoutChanged:u})=>{this.isDragging&&u&&(ae(p=>{const h=this.getAxisMotionValue(p);h&&(this.originPoint[p]+=d[p].translate,h.set(h.get()+d[p].translate))}),this.visualElement.render())}));return()=>{l(),n(),o(),c&&c(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:o=Ps,dragMomentum:l=!0}=t;return{...t,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function sr(e){let t=!0;return()=>{if(t){t=!1;return}e()}}function qh(e,t,n){const i=ci(e,sr(n)),r=ci(t,sr(n));return()=>{i(),r()}}function bt(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function Xh(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class Zh extends ye{constructor(t){super(t),this.removeGroupControls=ee,this.removeListeners=ee,this.controls=new Kh(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ee}update(){const{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const ns=e=>(t,n)=>{e&&L.update(()=>e(t,n),!1,!0)};class Jh extends ye{constructor(){super(...arguments),this.removePointerDownListener=ee}onPointerDown(t){this.session=new Ja(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Za(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:ns(t),onStart:ns(n),onMove:ns(i),onEnd:(a,o)=>{delete this.session,r&&L.postRender(()=>r(a,o))}}}mount(){this.removePointerDownListener=Qe(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let is=!1;class Qh extends N.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:a}=t;a&&(n.group&&n.group.add(a),i&&i.register&&r&&i.register(a),is&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Ct.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:i,drag:r,isPresent:a}=this.props,{projection:o}=i;return o&&(o.isPresent=a,t.layoutDependency!==n&&o.setOptions({...o.options,layoutDependency:n}),is=!0,r||t.layoutDependency!==n||n===void 0||t.isPresent!==a?o.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?o.promote():o.relegate()||L.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),un.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=t;is=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function eo(e){const[t,n]=$a(),i=N.useContext($s);return s.jsx(Qh,{...e,layoutGroup:i,switchLayoutGroup:N.useContext(qa),isPresent:t,safeToRemove:n})}const ep={pan:{Feature:Jh},drag:{Feature:Zh,ProjectionNode:Ba,MeasureLayout:eo}};function nr(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,a=i[r];a&&L.postRender(()=>a(t,dt(t)))}class tp extends ye{mount(){const{current:t}=this.node;t&&(this.unmount=Sd(t,(n,i)=>(nr(this.node,i,"Start"),r=>nr(this.node,r,"End"))))}unmount(){}}class sp extends ye{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ot(rt(this.node.current,"focus",()=>this.onFocus()),rt(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function ir(e,t,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),a=i[r];a&&L.postRender(()=>a(t,dt(t)))}class np extends ye{mount(){const{current:t}=this.node;if(!t)return;const{globalTapTarget:n,propagate:i}=this.node.props;this.unmount=Ed(t,(r,a)=>(ir(this.node,a,"Start"),(o,{success:l})=>ir(this.node,o,l?"End":"Cancel")),{useGlobalTarget:n,stopPropagation:(i==null?void 0:i.tap)===!1})}unmount(){}}const Is=new WeakMap,rs=new WeakMap,ip=e=>{const t=Is.get(e.target);t&&t(e)},rp=e=>{e.forEach(ip)};function ap({root:e,...t}){const n=e||document;rs.has(n)||rs.set(n,{});const i=rs.get(n),r=JSON.stringify(t);return i[r]||(i[r]=new IntersectionObserver(rp,{root:e,...t})),i[r]}function op(e,t,n){const i=ap(t);return Is.set(e,n),i.observe(e),()=>{Is.delete(e),i.unobserve(e)}}const lp={some:0,all:1};class cp extends ye{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:a}=t,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:lp[r]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:p}=this.node.getProps(),h=d?u:p;h&&h(c)};return op(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(dp(t,n))&&this.startObserver()}unmount(){}}function dp({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const up={inView:{Feature:cp},tap:{Feature:np},focus:{Feature:sp},hover:{Feature:tp}},hp={layout:{ProjectionNode:Ba,MeasureLayout:eo}},pp={...Lh,...up,...ep,...hp},Lt=Eh(pp,Dh),q={gradients:{exposed:{from:"#ff0844",to:"rgba(255, 8, 68, 0)"},secured:{from:"#00d9ff",to:"rgba(16, 185, 129, 0)"}},glow:{exposed:"0 0 40px rgba(255, 8, 68, 0.6), 0 0 80px rgba(255, 8, 68, 0.3)",secured:"0 0 40px rgba(0, 217, 255, 0.6), 0 0 80px rgba(0, 217, 255, 0.3)"},spacing:{top:30,right:50,bottom:80,left:100}};function mp({data:e,x:t,y:n}){const i=l=>l>=1e6?`${(l/1e6).toFixed(1)}M`:l>=1e3?`${Math.round(l/1e3)}k`:`${Math.round(l)}`,r=l=>new Date(l).toLocaleDateString("fr-FR",{weekday:"short",day:"2-digit",month:"short",year:"numeric"}).toUpperCase(),a=e.securedCA+e.exposedCA,o=a>0?(e.exposedCA/a*100).toFixed(1):"0.0";return To.createPortal(s.jsxs(Lt.div,{initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:10},transition:{duration:.2,ease:"easeOut"},className:"pointer-events-none fixed z-[9999]",style:{left:t,top:n-20,transform:"translate(-50%, -100%)"},children:[s.jsxs("div",{className:"relative backdrop-blur-2xl bg-slate-900 rounded-2xl border border-white/30 overflow-hidden",style:{boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.9), 0 0 100px rgba(0, 217, 255, 0.3)"},children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 h-[2px] bg-gradient-to-r from-transparent via-cyan-400 to-transparent"}),s.jsxs("div",{className:"p-5 space-y-4 min-w-[280px]",children:[s.jsxs("div",{className:"flex items-center gap-2 pb-3 border-b border-white/10",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400 animate-pulse",style:{boxShadow:q.glow.secured}}),s.jsx("span",{className:"text-[11px] font-black text-blue-300 uppercase tracking-[0.15em]",children:r(e.date)})]}),s.jsx("div",{className:"bg-gradient-to-br from-white/10 to-transparent p-4 rounded-xl border border-white/20",children:s.jsxs("div",{className:"flex items-baseline justify-between mb-1",children:[s.jsx("span",{className:"text-xs text-white/60 uppercase tracking-wider font-bold",children:"CA Total"}),s.jsx("span",{className:"text-3xl font-black text-white",style:{textShadow:"0 0 20px rgba(255,255,255,0.5)"},children:i(a)})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-cyan-500/30 to-emerald-500/20 p-3 rounded-xl border border-cyan-400/40",style:{boxShadow:"0 0 20px rgba(0, 217, 255, 0.3)"},children:[s.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-cyan-400/20 rounded-full blur-2xl"}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-cyan-400",style:{boxShadow:q.glow.secured}}),s.jsx("span",{className:"text-[9px] text-cyan-300 font-black uppercase tracking-wider",children:"Scuris"})]}),s.jsx("span",{className:"text-lg font-black text-cyan-100",children:i(e.securedCA)})]})]}),s.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-red-500/30 to-pink-500/20 p-3 rounded-xl border border-red-400/40",style:{boxShadow:"0 0 20px rgba(255, 8, 68, 0.3)"},children:[s.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-red-400/20 rounded-full blur-2xl"}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-red-400",style:{boxShadow:q.glow.exposed}}),s.jsx("span",{className:"text-[9px] text-red-300 font-black uppercase tracking-wider",children:" Risque"})]}),s.jsx("span",{className:"text-lg font-black text-red-100",children:i(e.exposedCA)})]})]})]}),s.jsxs("div",{className:"pt-3 border-t border-white/10",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-[9px] text-white/50 uppercase tracking-wider font-bold",children:"Exposition"}),s.jsxs("span",{className:"text-sm text-white/80 font-black",children:[o,"%"]})]}),s.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:s.jsx(Lt.div,{initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"},className:"h-full bg-gradient-to-r from-red-500 to-pink-500 rounded-full",style:{boxShadow:"0 0 10px rgba(255, 8, 68, 0.5)"}})})]})]})]}),s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-2",children:s.jsx("div",{className:"w-4 h-4 bg-slate-900 border-l border-b border-white/30 rotate-45"})})]}),document.body)}function fp({data:e,width:t=1200,height:n=550}){const[i,r]=N.useState(null),a=t-q.spacing.left-q.spacing.right,o=n-q.spacing.top-q.spacing.bottom,l=N.useMemo(()=>e.length===0?cs({domain:[0,1],range:[0,a]}):cs({domain:[new Date(e[0].date),new Date(e[e.length-1].date)],range:[0,a]}),[e,a]),c=N.useMemo(()=>e.length===0?1:Math.max(...e.map(b=>b.securedCA+b.exposedCA)),[e]),d=N.useMemo(()=>ue({domain:[0,c*1.1],range:[o,0],nice:!0}),[c,o]),u=b=>new Date(b.date),p=b=>l(u(b)),h=b=>d(b.securedCA),m=b=>d(b.securedCA+b.exposedCA),f=b=>{const v=wt(b);if(!v)return;const w=v.x-q.spacing.left,A=l.invert(w),T=e.reduce((y,x,j)=>{const k=u(x).getTime(),M=u(e[y]).getTime(),E=A.getTime();return Math.abs(k-E)<Math.abs(M-E)?j:y},0),S=e[T];r({data:S,x:p(S)+q.spacing.left,y:m(S)+q.spacing.top})},g=N.useMemo(()=>{if(e.length===0)return[];const b=Math.max(1,Math.ceil(e.length/7));return e.filter((v,w)=>w%b===0||w===e.length-1).map(v=>u(v))},[e]);return e.length===0||t<10||n<10||a<=0||o<=0?null:s.jsxs("div",{className:"relative w-full overflow-visible",children:[s.jsxs("svg",{width:t,height:n,children:[s.jsxs("defs",{children:[s.jsx(Rn,{id:"gradient-exposed-tesla",from:q.gradients.exposed.from,to:q.gradients.exposed.to,vertical:!0}),s.jsx(Rn,{id:"gradient-secured-tesla",from:q.gradients.secured.from,to:q.gradients.secured.to,vertical:!0}),s.jsxs("filter",{id:"glow-intense",children:[s.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),s.jsxs("feMerge",{children:[s.jsx("feMergeNode",{in:"coloredBlur"}),s.jsx("feMergeNode",{in:"coloredBlur"}),s.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),s.jsxs("g",{transform:`translate(${q.spacing.left}, ${q.spacing.top})`,children:[s.jsx(Bs,{scale:d,width:a,stroke:"rgba(255, 255, 255, 0.05)",strokeWidth:1,numTicks:6}),s.jsx(et,{data:e,x:p,y:h,yScale:d,fill:"url(#gradient-secured-tesla)",curve:ne,style:{filter:"url(#glow-intense)"}}),s.jsx(et,{data:e,x:p,y0:h,y1:m,yScale:d,fill:"url(#gradient-exposed-tesla)",curve:ne,style:{filter:"url(#glow-intense)"}}),s.jsx(Ve,{data:e,x:p,y:h,stroke:"#00d9ff",strokeWidth:3,curve:ne,strokeLinecap:"round",style:{filter:"drop-shadow(0 0 6px #00d9ff)"}}),s.jsx(Ve,{data:e,x:p,y:m,stroke:"#ff0844",strokeWidth:3,curve:ne,strokeLinecap:"round",style:{filter:"drop-shadow(0 0 6px #ff0844)"}}),e.map((b,v)=>s.jsxs("g",{children:[s.jsx(In,{cx:p(b),cy:m(b),r:(i==null?void 0:i.data)===b?6:3,fill:"#ff0844",stroke:"white",strokeWidth:(i==null?void 0:i.data)===b?2:1,style:{filter:(i==null?void 0:i.data)===b?"drop-shadow(0 0 8px #ff0844)":"none",cursor:"pointer",transition:"all 0.2s ease"}}),s.jsx(In,{cx:p(b),cy:h(b),r:(i==null?void 0:i.data)===b?6:3,fill:"#00d9ff",stroke:"white",strokeWidth:(i==null?void 0:i.data)===b?2:1,style:{filter:(i==null?void 0:i.data)===b?"drop-shadow(0 0 8px #00d9ff)":"none",cursor:"pointer",transition:"all 0.2s ease"}})]},v)),i&&s.jsx("line",{x1:p(i.data),x2:p(i.data),y1:0,y2:o,stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:2,strokeDasharray:"6,6",pointerEvents:"none"}),s.jsx(Ue,{top:o,scale:l,stroke:"rgba(255, 255, 255, 0.2)",tickStroke:"rgba(255, 255, 255, 0.2)",tickValues:g,tickLabelProps:()=>({fill:"rgba(255, 255, 255, 0.6)",fontSize:12,fontFamily:"ui-monospace, monospace",textAnchor:"middle",fontWeight:700,dy:10}),tickFormat:b=>b.toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}).replace(".","")}),s.jsx(Ot,{scale:d,stroke:"rgba(255, 255, 255, 0.2)",tickStroke:"rgba(255, 255, 255, 0.2)",numTicks:6,tickLabelProps:()=>({fill:"rgba(255, 255, 255, 0.6)",fontSize:13,fontFamily:"ui-monospace, monospace",textAnchor:"end",fontWeight:700,dx:-12}),tickFormat:b=>{const v=b;return v>=1e6?`${(v/1e6).toFixed(1)}M`:v>=1e3?`${Math.round(v/1e3)}k`:`${Math.round(v)}`}}),s.jsx(Ao,{width:a,height:o,fill:"transparent",onMouseMove:f,onMouseLeave:()=>r(null),style:{cursor:"crosshair"}})]})]}),s.jsx(Ua,{children:i&&s.jsx(mp,{data:i.data,x:i.x,y:i.y})})]})}const xp={risk:{bg:"bg-gradient-to-br from-red-950/40 to-red-900/10",border:"border-red-500/30",glow:"shadow-[0_0_30px_rgba(239,68,68,0.15)]",dot:"bg-red-500",text:"text-red-400",textMuted:"text-red-300/60"},revenue:{bg:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/10",border:"border-emerald-500/30",glow:"shadow-[0_0_30px_rgba(16,185,129,0.15)]",dot:"bg-emerald-500",text:"text-emerald-400",textMuted:"text-emerald-300/60"},velocity:{bg:"bg-gradient-to-br from-blue-950/40 to-blue-900/10",border:"border-blue-500/30",glow:"shadow-[0_0_30px_rgba(59,130,246,0.15)]",dot:"bg-blue-500",text:"text-blue-400",textMuted:"text-blue-300/60"}},gp={emerald:"text-emerald-400",blue:"text-blue-400",orange:"text-orange-400",red:"text-red-400",slate:"text-slate-400"};function bp({data:e}){if(!e||e.length===0)return null;const t=Math.max(...e),n=Math.min(...e),i=t-n||1,r=e.map((a,o)=>{const l=o/(e.length-1)*100,c=100-(a-n)/i*100;return`${l},${c}`}).join(" ");return s.jsx("svg",{viewBox:"0 0 100 100",className:"w-full h-8 opacity-30",preserveAspectRatio:"none",children:s.jsx("polyline",{points:r,fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function vp({trend:e}){const t=e.direction==="up"?Mo:e.direction==="down"?Ro:Go,n=e.direction==="up"?"text-emerald-400 bg-emerald-500/10":e.direction==="down"?"text-red-400 bg-red-500/10":"text-slate-400 bg-slate-500/10";return s.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-lg ${n} text-[10px] font-bold uppercase tracking-wider`,children:[s.jsx(t,{size:12}),s.jsxs("span",{children:[Math.abs(e.percentage),"%"]})]})}function as({type:e,title:t,icon:n,heroValue:i,heroLabel:r,trend:a,metrics:o,sparklineData:l}){const c=xp[e];return s.jsxs("div",{className:`
        ${c.bg} ${c.border} ${c.glow}
        border rounded-3xl p-8
        transition-all duration-500 ease-out
        hover:scale-[1.02] hover:${c.glow.replace("0.15","0.25")}
        group relative overflow-hidden
      `,children:[s.jsx("div",{className:`absolute inset-0 ${c.dot} opacity-0 group-hover:opacity-5 blur-3xl transition-opacity duration-500`}),s.jsxs("header",{className:"flex items-center justify-between mb-6 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${c.dot} animate-pulse`}),s.jsx("h3",{className:`text-[10px] font-black ${c.text} uppercase tracking-widest`,children:t})]}),s.jsx("div",{className:`${c.textMuted} opacity-50`,children:n})]}),s.jsxs("div",{className:"mb-6 relative z-10",children:[s.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[s.jsx("span",{className:"text-5xl font-black text-white tracking-tighter font-mono",children:i}),a&&s.jsx(vp,{trend:a})]}),s.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:r})]}),l&&l.length>0&&s.jsx("div",{className:`mb-6 ${c.text} relative z-10`,children:s.jsx(bp,{data:l})}),s.jsx("div",{className:"grid grid-cols-2 gap-4 relative z-10",children:o.map((d,u)=>s.jsxs("div",{className:"bg-white/[0.03] backdrop-blur-sm px-4 py-3 rounded-xl border border-white/5 hover:bg-white/[0.06] transition-colors",children:[s.jsx("span",{className:"block text-[9px] uppercase text-slate-500 mb-1 font-bold tracking-widest",children:d.label}),s.jsx("span",{className:`text-xl font-black font-mono ${d.color?gp[d.color]:"text-white"}`,children:d.value})]},u))})]})}function yp({risk:e,revenue:t,velocity:n,history:i}){var r,a,o;return s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx(as,{type:"risk",title:"Risque Immdiat",icon:s.jsx(qe,{size:20}),heroValue:`${Math.round(e.exposedCA/1e3)}k`,heroLabel:"CA  Risque",trend:{value:0,percentage:12,direction:"down"},metrics:[{label:"War Room",value:e.warRoomCount,color:"red"},{label:"Retards Ops",value:e.delayCount,color:"orange"}],sparklineData:(r=i==null?void 0:i.risk)!=null&&r.length?i.risk:[120,100,80,60,40,e.exposedCA/1e3]}),s.jsx(as,{type:"revenue",title:"Sant Revenu",icon:s.jsx(Ce,{size:20}),heroValue:`${Math.round(t.securedCA/1e3)}k`,heroLabel:"CA Scuris",trend:{value:t.securedCA,percentage:18,direction:"up"},metrics:[{label:"Pipeline",value:t.pipelineCount,color:"emerald"},{label:"Avg Ticket",value:`${Math.round(t.avgTicket/1e3)}k`,color:"blue"}],sparklineData:(a=i==null?void 0:i.revenue)!=null&&a.length?i.revenue:[150,170,180,200,220,230,t.securedCA/1e3]}),s.jsx(as,{type:"velocity",title:"Vlocit Ops",icon:s.jsx(Co,{size:20}),heroValue:`${n.avgDelayDays.toFixed(1)}j`,heroLabel:"Dlai Moyen (Depuis Sign)",trend:{value:14,percentage:0,direction:"stable"},metrics:[{label:"Actifs",value:n.activeCount,color:"blue"},{label:"Silencieux",value:n.silentCount,color:"orange"}],sparklineData:(o=i==null?void 0:i.velocity)!=null&&o.length?i.velocity:[12,13,14,14,15,14,14]})]})}function jp({events:e}){return s.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-4 scrollbar-thin scrollbar-thumb-white/10",children:[e.map(t=>s.jsxs("div",{className:"flex gap-4 p-4 bg-black/40 border border-white/10 rounded-xl hover:border-white/20 transition-all group",children:[s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("div",{className:`w-2 h-2 rounded-full mt-1.5 ${t.type==="email_sent"?"bg-sky-400":t.type==="war_room_entry"?"bg-red-500":t.type==="decision"?"bg-indigo-400":"bg-white/20"}`}),s.jsx("div",{className:"w-[1px] flex-1 bg-white/5 group-last:hidden"})]}),s.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest font-mono",children:t.time}),s.jsx("span",{className:"text-[9px] font-black text-white/20 uppercase tracking-widest",children:t.type.replace("_"," ")})]}),s.jsx("p",{className:"text-sm font-black text-white uppercase tracking-tight",children:t.label}),s.jsx("p",{className:"text-[11px] text-slate-400 italic font-medium",children:t.detail})]})]},t.id)),e.length===0&&s.jsx("div",{className:"py-12 text-center",children:s.jsx("p",{className:"text-[10px] font-black text-white/20 uppercase tracking-[0.4em] italic",children:"En attente de nouveaux signaux..."})})]})}function to(e){let t=0;const n=e.days_since_signature??0,i=e.days_since_last_event??0;return e.status==="signed"&&n>14&&!e.deposit_paid&&(t+=60),e.status==="signed"&&n>=8&&n<=14&&!e.deposit_paid&&(t+=40),i>10?t+=25:i>=6&&(t+=15),e.email_optout&&(t+=100),e.deposit_paid&&(t-=40),i<=2&&(t-=15),Math.max(0,Math.min(100,t))}function so(e){let t=0;if(e.days_since_last_event==null)return 60;const n=e.days_since_last_event;return n>14?t+=50:n>=7?t+=35:n>=4&&(t+=20),n<=2&&(t-=25),Math.max(0,Math.min(100,t))}function wp(e){const t=to(e),n=so(e),r=100-(t*.6+n*.4);return Math.max(0,Math.round(r))}function Np(e){return{study_id:e.study_id,risk_score_ops:to(e),inertia_score:so(e),ops_health_score:wp(e)}}function kp(e){return N.useMemo(()=>e.map(Np),[e])}const Sp=14,Ap=7;function Tp(e){if(e.status!=="signed")return null;const t=[],n=e.days_since_signature??0,i=e.days_since_last_event??null,r=e.deposit_paid===!0,o=(e.install_cost??0)>0;return n>Sp&&!r&&o?(t.push("Dlai SRU dpass sans scurisation financire"),{studyId:e.study_id,status:"WAR_ROOM",reasons:t,recommendation:"INTERVENTION IMMDIATE  scuriser ou stopper"}):(n>=Ap&&!r&&o&&t.push("Signature ancienne sans acompte"),i!==null&&i>=5&&t.push("Aucune interaction rcente aprs signature"),t.length>=2?{studyId:e.study_id,status:"WAR_ROOM",reasons:t,recommendation:"SCURISER EN URGENCE"}:t.length===1?{studyId:e.study_id,status:"A_SECURISER",reasons:t,recommendation:"Relance cible pour scurisation"}:{studyId:e.study_id,status:"SOUS_CONTROLE",reasons:[],recommendation:"RAS  dossier sain"})}function Cp(e){return e.status==="sent"&&!e.signed_at&&!e.deposit_paid}function Mp(e){if(!Cp(e))return null;const t=[],n=e.days_since_last_event??null,i=n!==null&&n>7;let r="NEUTRE";const a=e.interaction_score??0;return a>=60?r="INTERESSE":a>=30?r="AGITE":i&&(r="MUET"),r==="INTERESSE"&&i?(t.push("Client intress mais silencieux"),{studyId:e.study_id,status:"A_RELANCER",reasons:t,recommendation:"APPELER_EN_PRIORITE"}):r==="MUET"?(t.push("Client silencieux, risque fatigue"),{studyId:e.study_id,status:"A_SURVEILLER",reasons:t,recommendation:"NE_PAS_RELANCER"}):(t.push("Situation normale"),{studyId:e.study_id,status:"A_SURVEILLER",reasons:t,recommendation:"AUCUNE_ACTION"})}const Rp=30,Ep=7;function Dp(e){if(e.status==="signed")return null;if(e.email_optout===!0)return{studyId:e.study_id,status:"A_ABANDONNER",reasons:["Client opt-out (RGPD)"],recommendation:"STOP  aucun contact autoris"};const n=[],i=e.days_since_last_event??null;return i!==null&&i>=Rp?(n.push("Aucune interaction depuis plus de 30 jours"),{studyId:e.study_id,status:"A_ABANDONNER",reasons:n,recommendation:"STOP  lead froid, dsengager"}):i!==null&&i<=Ep?(n.push("Interaction rcente dtecte"),{studyId:e.study_id,status:"A_APPELER",reasons:n,recommendation:"APPEL HUMAIN PRIORITAIRE"}):(n.push("Lead passif sans signal fort"),{studyId:e.study_id,status:"A_OBSERVER",reasons:n,recommendation:"Surveiller sans relance agressive"})}function _p(e){const t=Tp(e);if(t){if(t.status==="WAR_ROOM")return{studyId:e.study_id,priority:"WAR_ROOM",sourceAxis:"A",reasons:t.reasons,recommendation:t.recommendation};if(t.status==="A_SECURISER")return{studyId:e.study_id,priority:"PRIORITY_ACTION",sourceAxis:"A",reasons:t.reasons,recommendation:t.recommendation}}const n=Mp(e);if(n){if(n.status==="A_RELANCER")return{studyId:e.study_id,priority:"PRIORITY_ACTION",sourceAxis:"B",reasons:n.reasons,recommendation:n.recommendation};if(n.status==="A_SURVEILLER")return{studyId:e.study_id,priority:"WATCH",sourceAxis:"B",reasons:n.reasons,recommendation:n.recommendation}}const i=Dp(e);if(i){if(i.status==="A_APPELER")return{studyId:e.study_id,priority:"PRIORITY_ACTION",sourceAxis:"C",reasons:i.reasons,recommendation:i.recommendation};if(i.status==="A_ABANDONNER")return{studyId:e.study_id,priority:"STOP",sourceAxis:"C",reasons:i.reasons,recommendation:i.recommendation}}const r={studyId:e.study_id,priority:"NONE",sourceAxis:null,reasons:["Aucune action requise"],recommendation:"Aucune"};return r.audit_payload={study_id:e.study_id,action_performed:"NONE",justification:"Situation normale, aucune action",source_axis:null,risk_score:0,health_score:0,created_at:new Date().toISOString()},r}function Pp(e){return N.useMemo(()=>e.map(t=>_p(t)),[e])}function Ip(e,t){return t<e?{severity:"CRITICAL",message:"Rendered value is lower than raw data",recommendation:"Fix scale or clipping in chart renderer",code:"DATA_MISMATCH"}:null}const Lp=["FinancialRiskProofVisx","ProjectionCAVISX","RiskMapVisx","ClientDriftVisx","BehaviorDriftTimelineVisx","KpiCardsLayout"];function Op(){return{component:"RISQUE FINANCIER",score:100,severity:"OK",issues:[]}}function Vp(){return{component:"PROJECTION C.A.",score:100,severity:"OK",issues:[]}}function Fp(){return{component:"CARTOGRAPHIE DES RISQUES",score:100,severity:"OK",issues:[]}}function Bp(){return{component:"DRIVE CLIENT (DRIFT)",score:100,severity:"OK",issues:[]}}function $p(){return{component:"TIMELINE COMPORTEMENTALE",score:100,severity:"OK",issues:[]}}function Up(){return{component:"AGENCEMENT CARTES KPI",score:100,severity:"OK",issues:[]}}const zp={FinancialRiskProofVisx:Op,ProjectionCAVISX:Vp,RiskMapVisx:Fp,ClientDriftVisx:Bp,BehaviorDriftTimelineVisx:$p,KpiCardsLayout:Up};function no(e){const t=[],n=[];for(const a of Lp){const o=zp[a];if(!o)throw new Error(`GOVERNANCE BREACH: Component "${a}" is visible in Cockpit but has NO UX auditor.`);let l;try{l=o()}catch(d){throw new Error(`AUDIT CRASHED for ${a}: ${d}`)}if(!l)throw new Error(`AUDIT FAILURE: Auditor for "${a}" returned no result.`);const c={component:a,...l};a.includes("Cards")||a.includes("KPI")?n.push(c):t.push(c)}const i=[...t.map(a=>a.score),...n.map(a=>a.score),e.dataIntegrityIssues.length?40:100],r=i.length>0?i.reduce((a,o)=>a+o,0)/i.length:100;return{globalScore:Math.round(r),charts:t,cards:n,dataIntegrityIssues:e.dataIntegrityIssues}}const Wp="ux_audit_history";function Hp(){return typeof window>"u"?[]:JSON.parse(localStorage.getItem(Wp)||"[]")}const rr=14,Gp=7,Yp=.6,Kp=3e4,ar={DEPOSIT_RECEIVED:-.15,HIGH_INTERACTION:-.1},Re={NO_DEPOSIT_EARLY:.1,NO_DEPOSIT_LATE:.25,SILENCE_LOW:.1,SILENCE_CRITICAL:.2,HIGH_AMOUNT:.08,SRU_DANGER_ZONE:.35};function qp(e){let t=0;const n=[];e.daysSinceSignature>=rr-2&&(t+=Re.SRU_DANGER_ZONE,n.push("SRU danger zone")),e.depositReceived?t+=ar.DEPOSIT_RECEIVED:(t+=e.daysSinceSignature>Gp?Re.NO_DEPOSIT_LATE:Re.NO_DEPOSIT_EARLY,n.push("Deposit not received")),e.interactionScore<20?(t+=Re.SILENCE_CRITICAL,n.push("Client silent")):e.interactionScore<40?t+=Re.SILENCE_LOW:e.interactionScore>60&&(t+=ar.HIGH_INTERACTION),e.amount>Kp&&(t+=Re.HIGH_AMOUNT,n.push("High amount"));const i=t>=Yp;return{riskScore:t,warRoom:i,status:e.depositReceived||e.daysSinceSignature>rr?"LOCKED":i?"DANGER":"EXPOSED",reasons:n}}function Xp(e){return qp(e)}const Zp=({system:e,chartsToAudit:t=[]})=>{const[n,i]=N.useState("IDLE"),[r,a]=N.useState(null),o=async()=>{i("RUNNING"),await new Promise(f=>setTimeout(f,1500));const h=no({dataIntegrityIssues:[]}),m={decisions:[],uxScore:h.globalScore,dataBreaches:0,uxDetails:h};try{const f=await fetch("/api/ops/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(f.ok){const g=await f.json();a(g)}else a(En(m))}catch(f){console.error("Audit History Save Failed",f),a(En(m))}i("RESULT")},l=()=>{if(r){console.log(" Generating PDF with result:",r);try{const h=Do(r),m=document.createElement("a");m.href=h,m.download=`EDF_OPS_AUDIT_REPORT_${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(h){console.error(" PDF Generation Failed:",h),alert(`Erreur gnration PDF: ${h.message}
Voir console pour dtails.`)}}};if(n==="IDLE")return s.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-600 rounded-lg transition-colors group",children:[s.jsx(Ko,{size:16,className:"text-slate-400 group-hover:text-white"}),s.jsx("span",{className:"text-xs font-bold text-slate-300 group-hover:text-white uppercase tracking-wider",children:"Run Ops & UX Audit"})]});if(n==="RUNNING")return s.jsxs("button",{disabled:!0,className:"flex items-center gap-2 px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg cursor-wait",children:[s.jsx(Eo,{size:16,className:"text-blue-500 animate-spin"}),s.jsx("span",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider",children:"Auditing System..."})]});if(!r)return null;const c=r.comparison,d=(c==null?void 0:c.status)==="REGRESSED"||(c==null?void 0:c.uxDelta)<0,u=r.globalScore<60||r.dataIntegrityBreaches>0||d,p=!u&&r.globalScore>=80&&r.dataIntegrityBreaches===0;return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>i("IDLE"),className:`flex items-center gap-3 px-4 py-2 rounded-lg border ${u?"bg-red-900/20 border-red-500/50":"bg-emerald-900/20 border-emerald-500/50"}`,children:[u?s.jsx(qe,{size:16,className:"text-red-500"}):s.jsx(Ce,{size:16,className:"text-emerald-500"}),s.jsxs("div",{className:"flex flex-col items-start text-left",children:[s.jsx("span",{className:`text-[10px] font-black uppercase tracking-wider ${u?"text-red-400":"text-emerald-400"}`,children:u?"AUDIT FAILED":"SYSTEM CERTIFIED"}),s.jsxs("span",{className:"text-xs font-bold text-white",children:["Score: ",r.globalScore,"/100"]})]})]}),s.jsxs("div",{className:"absolute top-full right-0 mt-4 w-[400px] bg-[#0F1629] border border-slate-700 rounded-xl shadow-2xl p-6 z-50 animate-in fade-in slide-in-from-top-2",children:[d&&s.jsxs("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-500 rounded flex items-start gap-3",children:[s.jsx(qe,{className:"text-red-500 shrink-0",size:20}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-red-400 font-bold text-xs uppercase tracking-wider",children:" REGRESSION DETECTED"}),s.jsxs("p",{className:"text-red-300 text-[10px] mt-1",children:["UX Score dropped by ",Math.abs(c==null?void 0:c.uxDelta)," points.",s.jsx("br",{}),"Deployment is blocked until resolved."]})]})]}),s.jsxs("div",{className:"flex justify-between items-start mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-black text-white uppercase tracking-widest",children:"OPS SYSTEM RESULT"}),s.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Generated ",new Date().toLocaleTimeString()]})]}),s.jsx("div",{className:`text-2xl font-black ${u?"text-red-500":"text-emerald-500"}`,children:r.globalScore})]}),s.jsxs("div",{className:"space-y-4 mb-8",children:[s.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-white/5 pb-2",children:[s.jsx("span",{className:"text-slate-400",children:"Data Integrity"}),r.dataIntegrityBreaches>0?s.jsxs("span",{className:"text-red-400 font-bold flex items-center gap-2",children:[s.jsx(qe,{size:12})," ",r.dataIntegrityBreaches," Breach(es)"]}):s.jsxs("span",{className:"text-emerald-400 font-bold flex items-center gap-2",children:[s.jsx(Ce,{size:12})," Secure"]})]}),s.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-white/5 pb-2",children:[s.jsx("span",{className:"text-slate-400",children:"UX Readability"}),r.uxScore>=80?s.jsx("span",{className:"text-emerald-400 font-bold",children:"Excellent"}):s.jsx("span",{className:"text-orange-400 font-bold",children:"Needs Work"})]}),s.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-white/5 pb-2",children:[s.jsx("span",{className:"text-slate-400",children:"War Room Exposure"}),r.warRoomCount>0?s.jsxs("span",{className:"text-red-400 font-bold",children:[r.warRoomCount," Critical"]}):s.jsx("span",{className:"text-slate-500 font-bold",children:"None"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:l,className:"w-full py-3 bg-white text-black font-bold uppercase text-xs rounded hover:bg-slate-200 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Wo,{size:14})," Download Official Report"]}),p&&s.jsx("div",{className:"mt-4 pt-4 border-t border-white/10 text-center",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-emerald-500/10 text-emerald-400 rounded-full border border-emerald-500/30",children:[s.jsx(Ce,{size:12}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Dashboard Certified"})]})})]})]})]})},Jp=({study:e})=>{const t=N.useMemo(()=>({daysSinceSignature:Math.floor((Date.now()-new Date(e.signed_at||e.created_at).getTime())/864e5),depositReceived:e.deposit_paid||!1,interactionScore:(e.views||0)*10+(e.clicks||0)*20,amount:e.total_price||0}),[e]);return Xp(t),null};function Qp({system:e}){var A,T,S,y;const{studies:t,metrics:n,financialStats:i,logs:r}=e,a=N.useMemo(()=>t.filter(x=>{const j=new Date(x.created_at),k=new Date,M=j.getMonth()===k.getMonth()&&j.getFullYear()===k.getFullYear();return M||console.log(`[Cockpit] Cleaning old study: ${x.id} (${x.created_at})`),x.status==="archived"||x.archived?(console.log(`[Cockpit] Cleaning archived study: ${x.id}`),!1):M}).map(x=>{const j=x.signed_at?Math.floor((new Date().getTime()-new Date(x.signed_at).getTime())/864e5):null;let k="ACTIVE";return x.status==="signed"?x.deposit_paid?k="SECURED":j!==null&&j>14?k="SRU_EXPIRED":k="UNSECURED_DELAY":x.behavioralState==="MUET"||x.views===0&&x.clicks===0?k="SILENT":k="ACTIVE",{study_id:x.id,ops_state:k,days_since_signature:j,days_since_last_event:x.diffDays||0,deposit_paid:x.deposit_paid||!1,signed_at:x.signed_at,last_interaction_at:x.last_view||x.last_click||null,install_cost:x.total_price||0,status:x.status,interaction_score:(x.views||0)*10+(x.clicks||0)*20,email_optout:x.email_optout||!1}}),[t]),o=N.useMemo(()=>a.reduce((x,j)=>{const k=j.ops_state||"UNKNOWN";return x[k]=(x[k]||0)+1,x},{ACTIVE:0,SILENT:0,UNSECURED_DELAY:0,SRU_EXPIRED:0,SECURED:0}),[a]);i.totalCA||t.reduce((x,j)=>x+(j.total_price||0),0);const l=i.cashAtRisk||0,c=N.useMemo(()=>{const x=new Date,j=new Date(x.getFullYear(),x.getMonth()+1,0).getDate();return Array.from({length:j}).map((M,E)=>new Date(x.getFullYear(),x.getMonth(),E+1).toISOString().split("T")[0]).map(M=>{const E=new Date(M);E.setHours(23,59,59,999);let D=0,_=0;return t.forEach(C=>{if(!C.signed_at||["cancelled","refused"].includes(C.status))return;const I=new Date(C.signed_at);if(I.getMonth()!==x.getMonth()||I.getFullYear()!==x.getFullYear()||I>E)return;const K=C.deposit_paid_at?new Date(C.deposit_paid_at):null;C.deposit_paid&&K&&K<=E?D+=C.total_price||0:_+=C.total_price||0}),{date:M,securedCA:D,exposedCA:_}})},[t]),d=N.useMemo(()=>(r||[]).slice(0,10).map(j=>({id:j.id,type:j.event_type==="email_sent"?"email_sent":"decision",label:j.title||"Action Systme",time:new Date(j.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),detail:j.description||""})),[r]),u=kp(a),p=Pp(a),h=N.useMemo(()=>no({dataIntegrityIssues:[]}),[]),m=N.useMemo(()=>Ip(5e5,5e5),[]),[f,g]=N.useState([]);[...h.charts,...h.cards].flatMap(x=>x.issues),h.globalScore;const b=N.useMemo(()=>{const x=h.globalScore,j=(m==null?void 0:m.severity)==="CRITICAL";return x<60||j?{blocked:!0,reason:j?"DATA INTEGRITY BREACH":"UX SCORE TOO LOW (<60)"}:{blocked:!1,reason:null}},[h,m]),[v,w]=N.useState([]);return N.useEffect(()=>{w(Hp())},[h.globalScore]),s.jsxs("div",{className:"flex flex-col gap-12 py-8 px-4 w-full h-full pb-40",children:[b.blocked&&s.jsxs("div",{className:"bg-red-600 text-white p-6 rounded-2xl border-4 border-red-800 shadow-2xl animate-bounce",children:[s.jsx("h2",{className:"text-2xl font-bold uppercase tracking-widest flex items-center gap-4",children:s.jsx("span",{children:" DEPLACEMENT BLOQU"})}),s.jsxs("p",{className:"font-mono mt-2 text-sm opacity-90",children:["Reason: ",b.reason,s.jsx("br",{}),"Safe decision-making is not guaranteed."]})]}),s.jsxs("header",{className:"p-10 rounded-3xl border border-white/10 bg-black/40 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-8",children:[s.jsx("div",{className:`w-4 h-4 rounded-full shadow-[0_0_15px_rgba(239,68,68,0.5)] animate-pulse ${o.UNSECURED_DELAY>0?"bg-red-500":"bg-emerald-500"}`}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"TAT OPS (DB MIRROR)"}),s.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-tight",children:o.UNSECURED_DELAY>0?"ATTENTION REQUISE":"SYSTME NOMINAL"})]})]}),s.jsxs("div",{className:"flex gap-8 text-center items-center",children:[s.jsx(Zp,{system:e}),s.jsx("div",{className:"h-8 w-px bg-white/10 mx-2"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-black text-white font-mono",children:o.ACTIVE}),s.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Actifs"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-black text-orange-400 font-mono",children:o.SILENT}),s.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Silencieux"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-black text-red-500 font-mono",children:o.UNSECURED_DELAY}),s.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Retard"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-black text-emerald-400 font-mono",children:o.SECURED}),s.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Scuriss"})]})]})]}),s.jsxs("div",{className:"relative overflow-visible rounded-3xl border border-white/10 shadow-2xl",children:[s.jsx("div",{className:"absolute inset-0 bg-[#0F1629]/80 backdrop-blur-xl z-0"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-900/20 via-transparent to-purple-900/20 pointer-events-none z-0"}),s.jsxs("div",{className:"relative z-10 p-8 space-y-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 border-b border-white/5 pb-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tight flex items-center gap-3",children:s.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-indigo-400",children:"Protection du Chiffre dAffaires"})}),s.jsx("p",{className:"text-slate-500 text-xs font-medium italic mt-2",children:'"Vrit absolue sur la drive entre CA scuris et CA  risque (30j)."'})]}),s.jsxs("div",{className:"flex items-center gap-4 bg-white/[0.03] p-2 pr-6 rounded-2xl border border-white/5 shadow-inner backdrop-blur-md",children:[s.jsxs("div",{className:"flex flex-col px-6 py-2 border-r border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400 shadow-[0_0_8px_rgba(52,211,153,0.6)] animate-pulse"}),s.jsx("span",{className:"text-[9px] font-bold text-emerald-400/80 uppercase tracking-widest",children:new Date().toLocaleString("fr-FR",{month:"long"}).toUpperCase()})]}),s.jsxs("span",{className:"text-2xl font-black text-white tracking-tighter font-mono",children:[Math.round(t.filter(x=>x.total_price&&!["cancelled","refused"].includes(x.status)&&x.signed_at&&new Date(x.signed_at).getMonth()===new Date().getMonth()&&new Date(x.signed_at).getFullYear()===new Date().getFullYear()).reduce((x,j)=>x+(j.total_price||0),0)/1e3).toLocaleString("fr-FR")," K"]})]}),s.jsxs("div",{className:"flex flex-col px-4 py-2 opacity-60",children:[s.jsx("span",{className:"text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1",children:"Mois Dernier"}),s.jsxs("span",{className:"text-xl font-black text-white/60 tracking-tighter font-mono",children:[Math.round(t.filter(x=>{if(!x.signed_at||["cancelled","refused"].includes(x.status)||!x.total_price)return!1;const j=new Date(x.signed_at),k=new Date,M=new Date(k.getFullYear(),k.getMonth(),1),E=new Date(M);return E.setMonth(E.getMonth()-1),j.getMonth()===E.getMonth()&&j.getFullYear()===E.getFullYear()}).reduce((x,j)=>x+(j.total_price||0),0)/1e3).toLocaleString("fr-FR")," K"]})]})]})]}),s.jsx("div",{className:"pt-4 h-[500px] w-full",children:s.jsx(xr,{children:({width:x,height:j})=>s.jsx(fp,{data:c,width:x,height:j})})})]})]}),s.jsx(yp,{risk:{exposedCA:l,warRoomCount:((A=n==null?void 0:n.warRoom)==null?void 0:A.count)||0,delayCount:o.UNSECURED_DELAY},revenue:{securedCA:(i==null?void 0:i.cashSecured)||0,pipelineCount:(((T=n==null?void 0:n.sent)==null?void 0:T.length)||0)+(((S=n==null?void 0:n.healthy)==null?void 0:S.length)||0),avgTicket:(((y=n==null?void 0:n.signed)==null?void 0:y.length)||0)>0?((i==null?void 0:i.cashSecured)||0)/n.signed.length:0},velocity:{avgDelayDays:(()=>{const x=t.filter(k=>k.status==="signed"&&!k.deposit_paid);return x.length?x.reduce((k,M)=>{const E=M.signed_at?new Date(M.signed_at):new Date(M.created_at),D=Math.floor((new Date().getTime()-E.getTime())/(1e3*3600*24));return k+D},0)/x.length:0})(),activeCount:o.ACTIVE,silentCount:o.SILENT},history:{risk:c.map(x=>x.exposedCA/1e3),revenue:c.map(x=>x.securedCA/1e3),velocity:(e.trafficData||[]).slice(-14).map(x=>x.count+x.opened+x.clicked)}}),s.jsxs("div",{className:"bg-black/20 backdrop-blur-sm p-12 rounded-3xl border border-white/5 space-y-8",children:[s.jsx("h3",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Preuve d'activit (Moteur Brain)"}),s.jsx(jp,{events:d})]}),n.warRoom.count>0&&s.jsx("div",{className:"fixed bottom-12 left-1/2 -translate-x-1/2 z-50",children:s.jsxs("button",{onClick:()=>e.setActiveSection("war_room"),className:"px-12 py-5 bg-red-600 hover:bg-red-500 text-white font-black uppercase tracking-widest text-xs rounded-2xl shadow-[0_20px_50px_rgba(220,38,38,0.4)] transition-all active:scale-95",children:["Entrer en War Room (",n.warRoom.count,")"]})}),s.jsxs("div",{className:"border-t border-white/10 pt-10 mt-10",children:[s.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-6",children:"Ops Intelligence (Pure Scoring)"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:u.slice(0,12).map(x=>{const j=t.find(M=>M.id===x.study_id),k=((j==null?void 0:j.client_name)||(j==null?void 0:j.name)||x.study_id.substring(0,8)).toUpperCase();return s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-4 rounded-xl border border-white/5 text-xs flex justify-between items-center group hover:border-white/20 transition-all",children:[s.jsx("span",{className:"text-slate-200 font-mono font-black group-hover:text-white transition-colors",children:k}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-[8px] uppercase text-slate-500 font-bold",children:"RISK"}),s.jsx("span",{className:`font-black font-mono ${x.risk_score_ops>50?"text-red-400":"text-emerald-400"}`,children:x.risk_score_ops})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-[8px] uppercase text-slate-500 font-bold",children:"HEALTH"}),s.jsx("span",{className:"font-black font-mono text-blue-400",children:x.ops_health_score})]})]})]},x.study_id)})})]}),s.jsxs("div",{className:"mt-12 pt-12 border-t border-white/5",children:[s.jsx("div",{className:"flex items-center justify-between mb-8",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute -left-4 top-1 w-1 h-full bg-gradient-to-b from-red-500 to-transparent opacity-50"}),s.jsxs("h3",{className:"text-2xl font-black uppercase text-white tracking-tight flex items-center gap-4 pl-4",children:[s.jsx("div",{className:"p-2 bg-red-500/10 rounded-full border border-red-500/20 shadow-[0_0_20px_rgba(220,38,38,0.2)]",children:s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"})}),"OPS INTELLIGENCE CENTRE"]}),s.jsx("p",{className:"text-white/30 text-xs font-mono mt-1 pl-16 tracking-widest uppercase",children:"Live Priority Matrix  Automated Strategy"})]})}),s.jsxs("div",{className:"overflow-hidden rounded-3xl border border-white/10 bg-black/20 backdrop-blur-2xl shadow-2xl ring-1 ring-white/5",children:[s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-white/10 bg-white/[0.02]",children:[s.jsx("th",{className:"py-6 px-8 text-[9px] uppercase font-bold text-slate-500 tracking-widest w-1/3",children:"Client Identity"}),s.jsx("th",{className:"py-6 px-8 text-[9px] uppercase font-bold text-slate-500 tracking-widest",children:"Operational Status"}),s.jsx("th",{className:"py-6 px-8 text-[9px] uppercase font-bold text-slate-500 tracking-widest",children:"Strategy Axis"}),s.jsx("th",{className:"py-6 px-8 text-[9px] uppercase font-bold text-slate-500 tracking-widest text-right",children:"Recommended Protocol"})]})}),s.jsx("tbody",{className:"divide-y divide-white/[0.03]",children:p.slice(0,12).map(x=>{const j=t.find(D=>D.id===x.studyId),k=((j==null?void 0:j.client_name)||(j==null?void 0:j.name)||x.studyId.slice(0,12)).toUpperCase(),M=((j==null?void 0:j.city)||"N/A").toUpperCase(),E=x.recommendation.replace(/_/g," ").toUpperCase();return s.jsxs("tr",{className:"group hover:bg-white/[0.04] transition-all duration-300 ease-out",children:[s.jsx("td",{className:"py-5 px-8",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-slate-700 group-hover:bg-blue-400 transition-colors"}),s.jsx("span",{className:"text-sm font-bold text-slate-200 group-hover:text-white transition-colors tracking-wide",children:k})]}),s.jsxs("div",{className:"flex items-center gap-2 pl-4",children:[s.jsx("span",{className:"text-[9px] font-mono text-white/20 px-1.5 rounded border border-white/5",children:x.studyId.slice(0,4)}),s.jsx("span",{className:"text-[9px] font-bold text-white/30 tracking-wider",children:M})]})]})}),s.jsx("td",{className:"py-5 px-8",children:s.jsxs("div",{className:`
                             inline-flex items-center gap-2 px-4 py-2 rounded-lg border text-[10px] font-black uppercase tracking-widest transition-transform group-hover:scale-105
                             ${x.priority==="WAR_ROOM"?"bg-red-500/20 border-red-500/50 text-red-100 shadow-[0_0_20px_rgba(220,38,38,0.3)]":x.priority==="PRIORITY_ACTION"?"bg-orange-500/10 border-orange-500/30 text-orange-200":x.priority==="WATCH"?"bg-blue-500/10 border-blue-500/30 text-blue-200":"bg-slate-500/5 border-slate-500/20 text-slate-500 opacity-50"}
                          `,children:[x.priority==="WAR_ROOM"&&s.jsx("div",{className:"w-1.5 h-1.5 bg-red-400 rounded-full animate-ping"}),x.priority.replace(/_/g," ")]})}),s.jsx("td",{className:"py-5 px-8",children:x.sourceAxis?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[9px] font-mono text-white/30",children:"AXIS"}),s.jsx("span",{className:"font-bold text-xs text-white/70 bg-white/5 px-2 py-1 rounded border border-white/10 group-hover:border-white/30 transition-colors",children:x.sourceAxis})]}):s.jsx("span",{className:"text-white/10 text-[10px]",children:""})}),s.jsx("td",{className:"py-5 px-8 text-right",children:s.jsx("span",{className:`
                             text-[10px] font-black uppercase tracking-widest py-1 px-3 rounded
                             ${x.recommendation.includes("RELANCER")?"bg-emerald-500/10 text-emerald-300":"text-slate-500 bg-white/[0.02]"}
                          `,children:E})})]},x.studyId)})})]}),p.length===0&&s.jsxs("div",{className:"p-20 text-center flex flex-col items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-white/5 flex items-center justify-center",children:s.jsx("div",{className:"w-4 h-4 bg-emerald-500 rounded-full"})}),s.jsx("div",{className:"text-white/20 text-xs uppercase tracking-widest font-mono",children:"No active priorities detected"})]})]})]}),s.jsxs("section",{className:"bg-slate-900/50 p-8 rounded-xl border border-dashed border-slate-700 mt-12",children:[s.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-[0.2em] mb-6",children:"UX / DATA INTEGRITY AUDIT (PHASE 3)"}),s.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[m&&s.jsxs("div",{className:`p-4 rounded-lg flex items-start gap-4 border ${m.severity==="CRITICAL"?"bg-red-900/20 border-red-500/50":"bg-green-900/10 border-green-500/30"}`,children:[m.severity==="CRITICAL"?s.jsx(qe,{className:"text-red-500 shrink-0"}):s.jsx(Ce,{className:"text-green-500 shrink-0"}),s.jsxs("div",{children:[s.jsxs("h4",{className:`text-xs font-bold uppercase mb-1 ${m.severity==="CRITICAL"?"text-red-400":"text-green-400"}`,children:["DATA INTEGRITY: ",m.severity]}),s.jsx("p",{className:"text-sm text-slate-300",children:m.message}),m.recommendation&&s.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[" ",m.recommendation]})]})]}),s.jsx("div",{className:"space-y-4",children:[...h.charts,...h.cards].map((x,j)=>s.jsxs("div",{className:"bg-white/5 p-4 rounded border border-white/10",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("span",{className:"font-mono text-sm text-white font-bold",children:x.component}),s.jsxs("span",{className:`text-xs px-2 py-1 rounded font-bold ${x.score>=80?"bg-green-500/20 text-green-400":x.score>=60?"bg-orange-500/20 text-orange-400":"bg-red-500/20 text-red-400"}`,children:["SCORE: ",x.score,"/100"]})]}),x.issues.length===0?s.jsxs("div",{className:"text-xs text-slate-500 italic flex items-center gap-2",children:[s.jsx(Ce,{size:12})," Compliant"]}):s.jsx("ul",{className:"space-y-2",children:x.issues.map((k,M)=>s.jsxs("li",{className:"text-xs bg-black/20 p-2 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:k.severity==="CRITICAL"?"text-red-400":"text-orange-400",children:[k.severity==="CRITICAL"?"":""," [",k.severity,"]"]}),s.jsx("span",{className:"text-slate-300",children:k.description})]}),s.jsxs("div",{className:"pl-6 text-slate-500 italic",children:[" ",k.remediation]})]},M))})]},j))})]})]}),s.jsxs("section",{className:"mt-8 border-t border-white/5 pt-8",children:[s.jsx("h4",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest mb-4",children:"AUDIT HISTORY (LOCAL STORAGE)"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:v.slice(-5).reverse().map((x,j)=>s.jsxs("div",{className:"text-[9px] font-mono text-slate-500 bg-black/20 px-2 py-1 rounded",children:[s.jsxs("span",{className:x.score<60?"text-red-500":"text-emerald-500",children:[x.score,"/100"]}),s.jsx("span",{className:"opacity-50 mx-1",children:""}),x.chartId,s.jsx("span",{className:"opacity-30 ml-2",children:new Date(x.timestamp).toLocaleTimeString()})]},j))})]}),t.map(x=>s.jsx(Jp,{study:x},`ops-probe-${x.id}`))]})}const G={colors:{grid:"rgba(255, 255, 255, 0.05)",axis:"rgba(255, 255, 255, 0.15)",text:"rgba(255, 255, 255, 0.3)",textLight:"rgba(255, 255, 255, 0.5)",bubbles:{safe:"rgba(74, 222, 128, 0.6)",warning:"rgba(251, 191, 36, 0.6)",danger:"rgba(248, 113, 113, 0.7)",critical:"rgba(239, 68, 68, 0.8)"}},fonts:{axis:'"Inter", "SF Pro Display", -apple-system, sans-serif'}},em=({studies:e,width:t,height:n,onPointClick:i,highlightedStudyId:r})=>{const a={top:40,right:60,bottom:60,left:60},o=t-a.left-a.right,l=n-a.top-a.bottom;if(t<10||n<10)return null;const{showTooltip:c,hideTooltip:d,tooltipData:u,tooltipLeft:p=0,tooltipTop:h=0}=dr(),m=N.useMemo(()=>e.length===0?null:e.reduce((y,x)=>y.dangerScore>x.dangerScore?y:x),[e]),f=N.useMemo(()=>e.length===0?null:e.reduce((y,x)=>y.totalPrice>x.totalPrice?y:x),[e]),g=N.useMemo(()=>ue({domain:[14,0],range:[0,o],nice:!0}),[o]),b=Math.max(...e.map(y=>y.totalPrice),2e4),v=N.useMemo(()=>ue({domain:[0,b*1.1],range:[l,0],nice:!0}),[b,l]),w=N.useMemo(()=>{const y=[...e].sort((j,k)=>k.engagementScore-j.engagementScore),x=new Map;return y.map(j=>{const k=Math.round(j.totalPrice/2e3),E=`${Math.round(j.daysBeforeDeadline)}-${k}`,D=x.get(E)||0;x.set(E,D+1);let _=0,C=0;if(D>0){const I=D*(Math.PI*.82),K=25+(D-1)*10;_=Math.cos(I)*K,C=Math.sin(I)*K}return{...j,dx:_,dy:C}})},[e]),A=N.useMemo(()=>dl({domain:[0,100],range:[6,24]}),[]),T=y=>y<40?G.colors.bubbles.safe:y<60?G.colors.bubbles.warning:y<80?G.colors.bubbles.danger:G.colors.bubbles.critical,S=(y,x,j,k)=>{c({tooltipData:x,tooltipLeft:j+a.left,tooltipTop:k+a.top})};return s.jsxs(s.Fragment,{children:[s.jsx("svg",{width:t,height:n,className:"overflow-visible",children:s.jsxs(U,{left:a.left,top:a.top,children:[s.jsx("text",{x:15,y:l-15,fill:G.colors.bubbles.safe,fontSize:9,fontWeight:700,letterSpacing:"0.1em",opacity:.3,children:"ZONE SCURISE"}),s.jsx("text",{x:o/2,y:l-15,fill:G.colors.bubbles.warning,fontSize:9,fontWeight:700,letterSpacing:"0.1em",textAnchor:"middle",opacity:.3,children:"ZONE DE VIGILANCE"}),s.jsx("text",{x:o-15,y:25,fill:G.colors.bubbles.critical,fontSize:9,fontWeight:700,letterSpacing:"0.1em",textAnchor:"end",opacity:.5,children:"URGENCE CRITIQUE"}),s.jsx("text",{x:o,y:l+40,fill:G.colors.bubbles.critical,fontSize:10,fontWeight:900,textAnchor:"end",letterSpacing:"0.05em",children:"URGENCE ACCRUE "}),s.jsx(Bs,{scale:v,width:o,stroke:G.colors.grid,strokeDasharray:"4,4"}),s.jsx(Ue,{top:l,scale:g,numTicks:5,stroke:G.colors.axis,tickStroke:G.colors.axis,tickLabelProps:()=>({fill:G.colors.text,fontSize:10,fontFamily:G.fonts.axis,textAnchor:"middle",fontWeight:600})}),s.jsx(Ot,{scale:v,numTicks:4,stroke:"transparent",tickStroke:"transparent",tickLabelProps:()=>({fill:G.colors.text,fontSize:10,fontFamily:G.fonts.axis,textAnchor:"end",verticalAnchor:"middle",fontWeight:600,dx:-10}),tickFormat:y=>`${Math.round(y/1e3)}k`}),s.jsx(Ua,{children:w.map(y=>{const x=r===y.studyId,j=(m==null?void 0:m.studyId)===y.studyId,k=(f==null?void 0:f.studyId)===y.studyId,M=g(y.daysBeforeDeadline),E=v(y.totalPrice),D=M+y.dx,_=E+y.dy;return s.jsxs(U,{children:[k&&s.jsxs(Lt.g,{initial:{opacity:0},animate:{opacity:.6},transition:{delay:1},children:[s.jsx("line",{x1:D,y1:_-A(y.engagementScore)-4,x2:D,y2:_-A(y.engagementScore)-20,stroke:G.colors.textLight,strokeWidth:.5}),s.jsx("text",{x:D,y:_-A(y.engagementScore)-25,fill:G.colors.textLight,fontSize:8,fontWeight:800,textAnchor:"middle",letterSpacing:"0.05em",children:"PLUS GROS ENJEU"})]}),s.jsx(Lt.circle,{cx:D,cy:_,r:A(y.engagementScore),initial:{opacity:0,scale:0},animate:{opacity:1,scale:x?1.4:j?1.2:1,strokeOpacity:x||j?1:.2},exit:{opacity:0,scale:0},transition:{duration:.6,ease:[.16,1,.3,1]},fill:T(y.dangerScore),stroke:"white",strokeWidth:x?3:j?2:1,style:{cursor:"pointer",zIndex:x?100:1},whileHover:{scale:1.5,strokeOpacity:1},onMouseEnter:C=>S(C,y,D,_),onMouseLeave:()=>d(),onClick:()=>i&&i(y.studyId)})]},y.studyId)})})]})}),u&&s.jsx(ur,{top:h-8,left:p,style:{...hr,backgroundColor:"#0F1629",color:"white",border:"none",borderRadius:"4px",padding:"10px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.5)",zIndex:100},children:s.jsxs("div",{className:"flex flex-col gap-0.5",children:[s.jsx("span",{className:"text-[8px] font-bold text-white/30 uppercase tracking-[0.15em] mb-0.5",children:"Focus Dossier"}),s.jsx("p",{className:"text-[11px] font-bold text-white tracking-tight leading-tight",children:u.name}),s.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[7px] text-white/20 uppercase font-black",children:"Potentiel"}),s.jsxs("span",{className:"text-[10px] text-emerald-400 font-mono",children:[Math.round(u.totalPrice).toLocaleString(),""]})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[7px] text-white/20 uppercase font-black",children:"Score"}),s.jsxs("span",{className:"text-[10px] text-red-400 font-mono",children:[u.dangerScore,"/100"]})]})]})]})},"tooltip")]})};function tm({studies:e,onPointClick:t,highlightedStudyId:n}){return s.jsx("div",{style:{width:"100%",height:"65vh",minHeight:"500px"},children:s.jsx(ze,{children:({width:i,height:r})=>s.jsx(em,{studies:e,width:i,height:r,onPointClick:t,highlightedStudyId:n})})})}function sm({events:e}){return s.jsxs("div",{className:"flex flex-col gap-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute left-[3px] top-4 bottom-4 w-px bg-white/10"}),s.jsx("div",{className:"space-y-8",children:e.map((t,n)=>s.jsxs("div",{className:"flex gap-6 items-start relative",children:[s.jsx("div",{className:`w-2 h-2 rounded-full mt-2 z-10 ${t.type==="signature"?"bg-emerald-400":t.type==="opening"?"bg-sky-400":t.type==="click"?"bg-indigo-400":t.type==="email_sent"?"bg-slate-400":"bg-red-500 shadow-[0_0_10px_rgba(239,68,68,0.5)]"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[s.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest ${t.type==="silence"?"text-red-400":"text-slate-500"}`,children:t.type.replace("_"," ")}),s.jsx("span",{className:"text-[10px] font-mono text-slate-500",children:t.date})]}),s.jsx("p",{className:`text-sm font-black uppercase tracking-tight ${t.type==="silence"?"text-red-200":"text-white"}`,children:t.label})]})]},`${t.type}-${n}`))})]}),e.length===0&&s.jsx("div",{className:"py-8 text-center text-[10px] font-black text-white/10 uppercase tracking-widest",children:"Aucun historique comportemental dtect"})]})}function nm({study:e,recommendation:t,onAction:n}){const i=e.dangerScore>70;return s.jsxs("div",{className:"h-full bg-[#0B0F14] rounded-xl border border-white/5 flex flex-col overflow-hidden backdrop-blur-sm shadow-2xl",children:[s.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-100 tracking-tight mb-1 font-sans",children:e.name}),s.jsxs("div",{className:"flex items-center gap-3 text-sm font-medium font-mono text-slate-500",children:[s.jsxs("span",{className:"text-emerald-400/80",children:[Math.round(e.totalPrice).toLocaleString()," "]}),s.jsx("span",{className:"w-1 h-1 rounded-full bg-slate-700"}),s.jsxs("span",{className:i?"text-red-400":"text-amber-400",children:["J-",e.daysBeforeDeadline]})]})]}),s.jsx("div",{className:`
          flex flex-col items-center justify-center w-12 h-12 rounded-lg border 
          ${i?"bg-red-500/5 border-red-500/20 text-red-500":"bg-amber-500/5 border-amber-500/20 text-amber-500"}
        `,children:s.jsx("span",{className:"text-lg font-bold leading-none",children:e.dangerScore})})]}),s.jsxs("div",{className:"flex-1 p-6 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Analyse Comportementale"}),s.jsxs("p",{className:"text-sm text-slate-300 leading-relaxed border-l-2 border-white/10 pl-3 italic",children:['"',t.reason,'"']})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white/[0.02] p-3 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-[9px] font-bold text-slate-500 uppercase block mb-1",children:"Stratgie"}),s.jsx("span",{className:"text-xs font-semibold text-slate-200",children:t.type})]}),s.jsxs("div",{className:"bg-white/[0.02] p-3 rounded-lg border border-white/5",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase block mb-1",children:"Urgence"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${i?"bg-red-500 animate-pulse":"bg-amber-500"}`}),s.jsx("span",{className:"text-xs font-semibold text-slate-200 uppercase",children:t.urgency})]})]})]})]}),s.jsx("div",{className:"p-6 border-t border-white/5 bg-white/[0.01]",children:s.jsxs("button",{onClick:()=>n(e.id),className:`
            w-full py-3 px-4 rounded-lg flex items-center justify-center gap-3 transition-all duration-200
            ${i?"bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20":"bg-white/5 hover:bg-white/10 text-slate-300 border border-white/10"}
          `,children:[s.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:i?"Dclencher Intervention":"Actions de Relance"}),s.jsx("svg",{className:"w-4 h-4 opacity-70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]})}function im({system:e}){const{metrics:t,studies:n,logs:i}=e,r=N.useMemo(()=>t.warRoom.studies.map(y=>({studyId:y.id,name:y.name,daysBeforeDeadline:y.daysLate?14-y.daysLate:14,totalPrice:y.total_price||0,dangerScore:y.dangerScore||50,engagementScore:(y.views||0)*10+(y.clicks||0)*20})),[t.warRoom.studies]),[a,o]=N.useState(r.length>0?r[0].studyId:null),[l,c]=N.useState(null),d=r.length,u=r.reduce((y,x)=>y+x.totalPrice,0),p=N.useMemo(()=>(n||[]).find(y=>{var x;return y.id===(a||((x=r[0])==null?void 0:x.studyId))}),[n,a,r]),h=N.useMemo(()=>{if(!p)return[];const y=[];return p.signed_at&&y.push({type:"signature",date:new Date(p.signed_at).toLocaleDateString(),label:"Signature du contrat"}),p.views>0&&y.push({type:"opening",date:"J+1",label:`${p.views} ouvertures dtectes`}),p.clicks>0&&y.push({type:"click",date:"J+2",label:`${p.clicks} interactions avec l'tude`}),p.send_count>0&&y.push({type:"email_sent",date:"J+3",label:"Relance automatique de rassurance"}),p.behavioralState==="MUET"&&y.push({type:"silence",date:"Aujourd'hui",label:"Silence prolong - Risque d'annulation lev"}),y},[p]),m=N.useMemo(()=>(n||[]).filter(y=>y.status==="sent"),[n]),f=N.useMemo(()=>m.filter(y=>y.behavioralState==="INTRESS"),[m]),g=N.useMemo(()=>m.filter(y=>y.behavioralState==="AGIT"),[m]),b=N.useMemo(()=>m.filter(y=>y.behavioralState==="MUET"&&y.diffDays<7),[m]),v=N.useMemo(()=>m.filter(y=>y.behavioralState==="FATIGUE"),[m]),w=N.useMemo(()=>{const y=(e.emailLeads||[]).filter(k=>!k.study_id),j=(n||[]).filter(k=>k.status==="new"||k.status==="lead").map(k=>({id:k.id,client_name:k.client_name||k.name||"Prospect",client_email:k.client_email||k.email||"Pas d'email",total_clicks:1,total_opens:0,last_clicked_at:k.created_at,is_study_proxy:!0}));return[...y,...j]},[e.emailLeads,n]),A=N.useMemo(()=>w.filter(y=>y.total_clicks>=1),[w]),T=N.useMemo(()=>w.filter(y=>y.total_clicks===0&&y.total_opens>=1),[w]),S=N.useMemo(()=>w.filter(y=>y.total_clicks===0&&y.total_opens===0),[w]);return s.jsxs("div",{className:"flex flex-col gap-12 py-8 px-4 w-full h-full pb-40",children:[s.jsxs("header",{className:"flex flex-col gap-1",children:[s.jsx("h1",{className:"text-3xl font-black text-slate-100 tracking-tight uppercase",children:"War Room Operations"}),s.jsx("p",{className:"text-slate-500 text-[10px] font-bold uppercase tracking-widest",children:"Concentration humaine sur le CA rcuprable"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start",children:[s.jsxs("div",{className:"lg:col-span-8 xl:col-span-9 space-y-6",children:[s.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-2xl border border-white/10 overflow-hidden shadow-2xl relative",children:[s.jsxs("div",{className:"absolute top-6 left-6 z-10 pointer-events-none",children:[s.jsxs("h2",{className:"text-lg font-black text-white tracking-tight uppercase",children:["Focus Dcisionnel  ",d," Dossiers en Zone de Danger"]}),s.jsxs("p",{className:"text-slate-500 text-[10px] font-bold uppercase tracking-widest mt-1",children:["EXPOSITION TOTALE : ",s.jsxs("span",{className:"font-mono",children:[Math.round(u).toLocaleString("fr-FR")," "]})]})]}),s.jsxs("div",{className:"pt-10",children:[" ",s.jsx(tm,{studies:r,onPointClick:o,highlightedStudyId:l})]})]}),s.jsxs("div",{className:"bg-black/20 backdrop-blur-sm rounded-xl border border-white/10 overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-white/10 flex justify-between items-center bg-white/[0.01]",children:[s.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:["Dossiers en Alerte (",r.length,")"]}),s.jsx("span",{className:"text-[9px] text-slate-600 font-mono uppercase tracking-widest",children:"Sync: Active"})]}),s.jsxs("div",{className:"divide-y divide-white/[0.03]",children:[r.slice(0,5).map(y=>s.jsxs("button",{onClick:()=>o(y.studyId),onMouseEnter:()=>c(y.studyId),onMouseLeave:()=>c(null),className:`w-full px-6 py-3 flex justify-between items-center hover:bg-white/[0.02] transition-colors group ${a===y.studyId?"bg-white/[0.04]":""}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${y.dangerScore>70?"bg-red-500":"bg-amber-500"}`}),s.jsx("span",{className:`text-sm font-black uppercase tracking-tight ${a===y.studyId?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:y.name})]}),s.jsxs("div",{className:"flex items-center gap-1 text-[11px] font-mono text-slate-500",children:[s.jsxs("span",{className:"w-14 text-right inline-block font-black",children:[Math.round(y.totalPrice/1e3),"k"]}),s.jsxs("span",{className:`w-12 text-right inline-block font-black ${y.daysBeforeDeadline<5?"text-red-400":"text-blue-400"}`,children:["J-",y.daysBeforeDeadline]}),s.jsxs("span",{className:"text-slate-600 w-10 text-right inline-block font-black",children:[y.dangerScore,"%"]})]})]},y.studyId)),r.length>5&&s.jsx("div",{className:"px-6 py-2 text-center border-t border-white/5",children:s.jsxs("span",{className:"text-[10px] text-slate-600 uppercase tracking-widest",children:["+ ",r.length-5," autres dossiers"]})})]})]})]}),s.jsx("div",{className:"lg:col-span-4 xl:col-span-3 space-y-6",children:p?s.jsxs(s.Fragment,{children:[s.jsx(nm,{study:{id:p.id,name:p.name,totalPrice:p.total_price||0,dangerScore:p.dangerScore||50,daysBeforeDeadline:p.daysLate?14-p.daysLate:14},recommendation:{type:"Appel Tlphonique",reason:p.behavioralState==="MUET"?"Silence prolong post-signature. Suspicion de doute.":"Baisse d'engagement suspecte sur l'tude.",urgency:(p.dangerScore||0)>70?"high":"medium"},onAction:y=>console.log("Action human intervention launched for",y)}),s.jsxs("div",{className:"bg-black/20 backdrop-blur-sm p-10 rounded-xl border border-white/10 space-y-8",children:[s.jsx("h3",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Drive Comportementale"}),s.jsx(sm,{events:h})]})]}):s.jsx("div",{className:"h-full flex items-center justify-center p-20 text-center",children:s.jsx("p",{className:"text-[10px] font-black text-white/20 uppercase tracking-[0.4em] italic",children:"Slectionnez un dossier pour lancer l'analyse"})})})]}),s.jsxs("div",{className:"border-t border-white/10 pt-12 mt-8",children:[s.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight mb-8",children:"AXE A  DOSSIERS SIGNS (ANTI-ANNULATION)"}),(()=>{const x=(e.studies||[]).filter(C=>C.status==="signed"),j=C=>{const I=C.signed_at?Math.floor((new Date().getTime()-new Date(C.signed_at).getTime())/864e5):0,K=C.dangerScore||0;return C.contract_secured?I>30?"HORS_PERIMETRE":"SOUS_CONTROLE":K>=70||!C.deposit_paid&&I>7?"WAR_ROOM":!C.deposit_paid||C.behavioralState==="AGIT"?"A_SECURISER":"SOUS_CONTROLE"},k=C=>C.deposit_paid?"PAY ":C.has_deposit&&!C.deposit_paid?"EN ATTENTE ":"NON REQUIS ",M=x.filter(C=>j(C)==="WAR_ROOM"),E=x.filter(C=>j(C)==="A_SECURISER"),D=x.filter(C=>j(C)==="SOUS_CONTROLE"),_=x.filter(C=>j(C)==="HORS_PERIMETRE");return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 mb-12",children:[s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-red-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"War Room"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:M.length})]}),s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-amber-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" Scuriser"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:E.length})]}),s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-emerald-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Sous Contrle"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:D.length})]}),s.jsxs("div",{className:"bg-black/20 backdrop-blur-sm p-8 rounded-xl border border-white/10 opacity-30",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest",children:"Hors Primtre"}),s.jsx("p",{className:"text-3xl font-black text-slate-600 mt-1 font-mono",children:_.length})]})]}),s.jsxs("div",{className:"bg-[#0B0F14] rounded-2xl border border-white/5 overflow-hidden",children:[s.jsx("div",{className:"px-8 py-4 border-b border-white/5 bg-white/[0.01]",children:s.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:["Dossiers  Scuriser (",M.length+E.length,")"]})}),s.jsxs("div",{className:"divide-y divide-white/[0.03]",children:[[...M,...E].length===0&&s.jsx("div",{className:"p-8 text-center text-white/20 text-xs uppercase tracking-widest",children:"Aucun dossier critique"}),[...M,...E].map(C=>{const I=j(C)==="WAR_ROOM",K=C.last_click||C.last_open||C.signed_at,O=C.signed_at?Math.floor((new Date().getTime()-new Date(C.signed_at).getTime())/(1e3*60*60*24)):0;return s.jsxs("div",{className:`p-6 flex items-center justify-between hover:bg-white/[0.02] transition-colors ${I?"bg-red-500/5":""}`,children:[s.jsx("div",{className:"w-[35%]",children:s.jsxs("div",{className:"flex items-center gap-2",children:[I&&s.jsx("span",{className:"text-lg",children:""}),s.jsxs("div",{children:[s.jsx("p",{className:"text-white font-black text-sm truncate pr-2 uppercase tracking-tight",children:C.name}),s.jsxs("p",{className:"text-slate-500 text-[10px] font-bold uppercase",children:["Sign il y a ",s.jsx("span",{className:"font-mono",children:O})," jours"]})]})]})}),s.jsxs("div",{className:"w-[15%]",children:[s.jsx("p",{className:"text-white/40 text-[10px] uppercase tracking-wider mb-1",children:"Acompte"}),(()=>{const P=k(C);return s.jsx("span",{className:`text-xs font-bold uppercase ${P.includes("PAY")?"text-emerald-400":P.includes("EN COURS")?"text-blue-400":"text-orange-400"}`,children:P})})()]}),s.jsxs("div",{className:"w-[20%] flex flex-col items-end",children:[s.jsxs("p",{className:"text-white font-bold text-sm",children:[Math.round(C.total_price).toLocaleString("fr-FR")," "]}),s.jsx("p",{className:"text-white/40 text-[10px] uppercase tracking-wider mt-1 text-right",children:K?s.jsxs(s.Fragment,{children:["Interaction il y a ",Math.floor((new Date().getTime()-new Date(K).getTime())/(1e3*60*60*24))," j"]}):"Aucune interaction"})]}),s.jsx("div",{className:"w-[30%] flex justify-end pl-4",children:s.jsx("div",{className:`px-4 py-2 rounded-lg border ${I?"bg-red-500/5 border-red-500/10":"bg-amber-500/5 border-white/5"} whitespace-nowrap`,children:s.jsx("p",{className:`${I?"text-red-400":"text-slate-400"} text-[10px] font-bold uppercase tracking-widest`,children:I?"URGENCE : SCURISER":"ACTION : SCURISER"})})})]},C.id)})]})]})]})})()]}),s.jsxs("div",{className:"border-t border-white/5 pt-16 mt-16",children:[s.jsxs("header",{className:"mb-10",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Retention Strategy"}),s.jsx("h2",{className:"text-2xl font-black text-slate-100 tracking-tight mt-1 uppercase",children:"AXE B  Post-Prsentation sans Signature"}),s.jsxs("p",{className:"text-amber-500/60 text-[10px] font-bold uppercase tracking-widest mt-2",children:["Impact : ",s.jsx("span",{className:"font-mono",children:f.length})," Relances Prioritaires en attente"]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 mb-12",children:[s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-red-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Priorit Relance"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:f.length})]}),s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-amber-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" Surveiller"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:g.length})]}),s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-blue-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Rveil Ncessaire"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:b.length})]}),s.jsxs("div",{className:"bg-black/20 backdrop-blur-sm p-8 rounded-xl border border-white/10 opacity-30",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest",children:"Interruption (Stop)"}),s.jsx("p",{className:"text-3xl font-black text-slate-600 mt-1 font-mono",children:v.length})]})]}),s.jsxs("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-black/20 backdrop-blur-sm shadow-2xl",children:[s.jsx("div",{className:"px-6 py-4 border-b border-white/10 bg-white/[0.01]",children:s.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-3",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(245,158,11,0.5)]"}),"Priorit Relance (",f.length,")"]})}),s.jsxs("table",{className:"w-full text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-white/10 bg-white/[0.02]",children:[s.jsx("th",{className:"py-4 px-6 text-[9px] uppercase font-bold text-slate-500 tracking-widest",children:"Client Identity"}),s.jsx("th",{className:"py-4 px-6 text-[9px] uppercase font-bold text-slate-500 tracking-widest",children:"Potentiel"}),s.jsx("th",{className:"py-4 px-6 text-[9px] uppercase font-bold text-slate-500 tracking-widest text-right",children:"Last Interaction"}),s.jsx("th",{className:"py-4 px-6 text-[9px] uppercase font-bold text-slate-500 tracking-widest text-right",children:"Action"})]})}),s.jsx("tbody",{className:"divide-y divide-white/[0.03]",children:f.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"p-8 text-center text-white/20 text-xs uppercase tracking-widest font-mono",children:"Aucun dossier  relancer"})}):f.map(y=>{var M;const x=y.last_click||y.last_open||y.created_at,j=((M=y.clients)==null?void 0:M.phone)||y.phone||"N/A",k=(y.client_name||y.name||"CLIENT INCONNU").toUpperCase();return s.jsxs("tr",{className:"group hover:bg-white/[0.04] transition-all duration-300 ease-out",children:[s.jsx("td",{className:"py-4 px-6",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-sm font-black text-slate-200 group-hover:text-white transition-colors tracking-wide uppercase",children:k}),s.jsx("span",{className:"text-[10px] font-mono text-white/30",children:j})]})}),s.jsx("td",{className:"py-4 px-6",children:s.jsxs("span",{className:"text-emerald-400 font-bold font-mono text-xs bg-emerald-500/10 px-2 py-1 rounded border border-emerald-500/20",children:[Math.round(y.total_price).toLocaleString("fr-FR")," "]})}),s.jsx("td",{className:"py-4 px-6 text-right",children:s.jsx("span",{className:"text-white/40 text-[10px] font-mono uppercase",children:(()=>{if(!x)return"N/A";const E=Math.floor((new Date().getTime()-new Date(x).getTime())/(1e3*60*60*24));return E===0?"Aujourd'hui":`il y a ${E}j`})()})}),s.jsx("td",{className:"py-4 px-6 text-right",children:s.jsx("button",{className:"bg-white/5 hover:bg-white/10 text-slate-300 text-[10px] font-bold uppercase tracking-widest px-4 py-2 rounded-lg border border-white/10 transition-all",children:"Lancer Appel"})})]},y.id)})})]})]})]}),s.jsxs("div",{className:"border-t border-white/5 pt-16 mt-16",children:[s.jsxs("header",{className:"mb-10",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Acquisition Control"}),s.jsx("h2",{className:"text-2xl font-black text-slate-100 tracking-tight mt-1 uppercase",children:"AXE C  Leads Qualifis jamais joints"}),s.jsxs("p",{className:"text-red-500/60 text-[10px] font-bold uppercase tracking-widest mt-2",children:["Priorit : ",s.jsx("span",{className:"font-mono",children:A.length})," Appels Recommands"]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12",children:[s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-red-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Priorit Appel"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:A.length})]}),s.jsxs("div",{className:"bg-black/40 backdrop-blur-sm p-8 rounded-xl border border-amber-500/20",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Observation Active"}),s.jsx("p",{className:"text-3xl font-black text-white mt-1 font-mono",children:T.length})]}),s.jsxs("div",{className:"bg-black/20 backdrop-blur-sm p-8 rounded-xl border border-white/10 opacity-30",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest",children:"Interruption (Abandon)"}),s.jsx("p",{className:"text-3xl font-black text-slate-600 mt-1 font-mono",children:S.length})]})]}),s.jsxs("div",{className:"bg-[#0B0F14] rounded-xl border border-white/5 overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-6 py-4 border-b border-white/5 bg-white/[0.01]",children:s.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:["Priorit Appel (",A.length,")"]})}),s.jsx("div",{className:"divide-y divide-white/[0.03]",children:A.length===0?s.jsx("div",{className:"p-8 text-center text-slate-500 text-xs uppercase tracking-widest",children:"Aucun lead  rappeler"}):A.map(y=>s.jsxs("div",{className:"p-6 flex items-center justify-between hover:bg-white/[0.02] transition-colors",children:[s.jsxs("div",{className:"w-[40%]",children:[s.jsx("p",{className:"text-white font-bold text-sm tracking-tight",children:y.client_name.toUpperCase()}),s.jsx("p",{className:"text-slate-500 text-xs mt-0.5",children:y.client_email})]}),s.jsxs("div",{className:"w-[30%] text-right",children:[s.jsx("p",{className:"text-slate-500 text-[9px] uppercase tracking-wider mb-1",children:"Dernire interaction"}),s.jsx("p",{className:"text-slate-300 font-mono text-xs",children:(()=>{if(!y.last_clicked_at)return"N/A";const x=Math.floor((new Date().getTime()-new Date(y.last_clicked_at).getTime())/(1e3*60*60*24));return x===0?"Aujourd'hui":`il y a ${x}j`})()})]}),s.jsx("div",{className:"w-[30%] flex justify-end",children:s.jsx("div",{className:"px-4 py-2 bg-red-500/5 rounded-lg border border-red-500/20",children:s.jsx("p",{className:"text-red-400 text-[10px] font-bold uppercase tracking-widest italic",children:"Intervention Recommande"})})})]},y.id))})]})]})]})}function rm({data:e}){const t=e.securedCA+e.exposedCA+e.cancelledCA,n=t>0?e.securedCA/t*100:0,i=t>0?e.exposedCA/t*100:0,r=t>0?e.cancelledCA/t*100:0;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"w-full h-10 bg-white/5 rounded-lg overflow-hidden flex border border-white/10 shadow-lg",children:[s.jsx("div",{style:{width:`${n}%`},className:"h-full bg-[#4ADE80] opacity-80 shadow-[inset_0_1px_2px_rgba(255,255,255,0.1)] transition-all duration-700",title:`Scuris: ${e.securedCA.toLocaleString()}`}),s.jsx("div",{style:{width:`${i}%`},className:"h-full bg-[#F59E0B] opacity-70 shadow-[inset_0_1px_2px_rgba(255,255,255,0.1)] transition-all duration-700",title:`Expos: ${e.exposedCA.toLocaleString()}`}),s.jsx("div",{style:{width:`${r}%`},className:"h-full bg-[#F87171] opacity-60 shadow-[inset_0_1px_2px_rgba(255,255,255,0.1)] transition-all duration-700",title:`Annul: ${e.cancelledCA.toLocaleString()}`})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-8 px-2",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-[#4ADE80]"}),s.jsx("span",{className:"text-xs font-bold text-white/40 uppercase tracking-[0.2em]",children:"Scuris"})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-bold text-white/90 tabular-nums",children:[Math.round(n),"%"]}),s.jsxs("span",{className:"text-sm font-bold text-white/20 tracking-tight",children:["(",Math.round(e.securedCA/1e3),"k)"]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-[#F59E0B]"}),s.jsx("span",{className:"text-xs font-bold text-white/40 uppercase tracking-[0.2em]",children:"Expos"})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-bold text-white/90 tabular-nums",children:[Math.round(i),"%"]}),s.jsxs("span",{className:"text-sm font-bold text-white/20 tracking-tight",children:["(",Math.round(e.exposedCA/1e3),"k)"]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-[#F87171]"}),s.jsx("span",{className:"text-xs font-bold text-white/40 uppercase tracking-[0.2em]",children:"Annul"})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-bold text-white/90 tabular-nums",children:[Math.round(r),"%"]}),s.jsxs("span",{className:"text-sm font-bold text-white/20 tracking-tight",children:["(",Math.round(e.cancelledCA/1e3),"k)"]})]})]})]})]})}const vt={line:"#38BDF8",area:"#38BDF8",axis:"#ffffff20"},am=({data:e,width:t,height:n})=>{if(t<10||n<10)return null;const i={top:20,right:30,bottom:50,left:60},r=Math.max(0,t-i.left-i.right),a=Math.max(0,n-i.top-i.bottom),o=N.useMemo(()=>ue({domain:[0,14],range:[0,r]}),[r]),l=N.useMemo(()=>ue({domain:[0,100],range:[a,0],nice:!0}),[a]),c=N.useMemo(()=>!e||!e.length?null:e.reduce((d,u)=>d.activeRate>u.activeRate?d:u),[e]);return s.jsx("svg",{width:t,height:n,children:s.jsxs(U,{left:i.left,top:i.top,children:[s.jsx("rect",{x:o(7),y:0,width:Math.max(0,o(14)-o(7)),height:a,fill:"#F59E0B",fillOpacity:.04}),s.jsx("line",{x1:o(7),y1:0,x2:o(7),y2:a,stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"4,4",opacity:.3}),s.jsx("line",{x1:o(14),y1:0,x2:o(14),y2:a,stroke:"#F87171",strokeWidth:1,strokeDasharray:"4,4",opacity:.3}),s.jsx("text",{x:o(10.5),y:20,fill:"#F59E0B",fontSize:10,fontWeight:"700",textAnchor:"middle",className:"uppercase tracking-[0.2em] opacity-40 hover:opacity-100 transition-opacity",children:"Zone critique churn"}),s.jsx(et,{data:e,x:d=>o(d.day),y:d=>l(d.activeRate),yScale:l,fill:vt.area,fillOpacity:.05,curve:ne}),s.jsx(Ve,{data:e,x:d=>o(d.day),y:d=>l(d.activeRate),stroke:vt.line,strokeWidth:4,strokeOpacity:.9,curve:ne}),c&&s.jsxs(U,{children:[s.jsx("circle",{cx:o(c.day),cy:l(c.activeRate),r:5,fill:"#F87171",className:"animate-pulse"}),s.jsx("text",{x:o(c.day),y:l(c.activeRate)-15,fill:"#F87171",fontSize:10,fontWeight:"bold",textAnchor:"middle",className:"font-sans uppercase tracking-widest",children:"Pic dcrochage"})]}),s.jsx(Ue,{top:a,scale:o,stroke:"transparent",tickStroke:vt.axis,tickLabelProps:()=>({fill:"#ffffff20",fontSize:10,fontWeight:"bold",className:"font-sans",textAnchor:"middle"}),tickValues:[0,2,4,6,8,10,12,14],tickFormat:d=>`J+${d}`}),s.jsx(Ot,{scale:l,stroke:"transparent",tickStroke:vt.axis,tickLabelProps:()=>({fill:"#ffffff20",fontSize:10,fontWeight:"bold",className:"font-sans",textAnchor:"end",verticalAnchor:"middle",dx:-4}),tickValues:[0,25,50,75,100],tickFormat:d=>`${d}%`})]})})};function om({data:e}){return s.jsx("div",{style:{width:"100%",height:"350px"},children:s.jsx(ze,{children:({width:t,height:n})=>s.jsx(am,{data:e,width:t,height:n})})})}const lm=({leads:e,visited:t,signed:n,waitingSignatureStudies:i=[],waitingDepositStudies:r=[],secured:a,securedAmount:o=0})=>{const l=Math.max(e,1),c=t?Math.round(n/t*100):0,d=e?Math.round(t/e*100):0,u=e?Math.round(n/e*100):0,p=Math.max(0,e-t),h=i.length,m=r.length,f=a,g=e>0,b=e?t/e*100:0,v=t?n/t*100:0,w=n?a/n*100:0,A=Math.min(b,v,w)===b?"Qualification":Math.min(b,v,w)===v?"Closing":"Administratif";return s.jsxs("div",{className:"w-full space-y-12",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-l-4 border-emerald-500 pl-8 py-2",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[9px] tracking-[0.4em] text-emerald-400 font-black uppercase",children:"S03  Pipeline Momentum"}),s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight uppercase",children:"Trajectoire Dossiers"}),s.jsx("p",{className:"text-white/40 text-[10px] uppercase font-bold tracking-widest",children:"Donnes ddoublonnes par email  1 Email = 1 Dossier"})]}),s.jsxs("div",{className:"flex gap-12",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-4xl font-black text-white font-mono tracking-tighter tabular-nums",children:e}),s.jsx("div",{className:"text-[9px] font-bold text-slate-500 uppercase tracking-widest",children:"Leads Entrants"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-4xl font-black text-emerald-400 font-mono tracking-tighter tabular-nums",children:o>0?`${Math.round(o/1e3)}k`:a}),s.jsx("div",{className:"text-[9px] font-bold text-slate-500 uppercase tracking-widest",children:"Valeur Encaisse"})]})]})]}),s.jsx("div",{className:"relative bg-black/60 rounded-[2.5rem] p-12 border border-white/5 shadow-2xl backdrop-blur-xl overflow-hidden",children:g?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative h-6 mb-2 flex",children:[s.jsx("div",{style:{width:`${f/l*100}%`},className:"relative",children:s.jsx("span",{className:"absolute right-0 bottom-0 text-[10px] font-black text-emerald-400 uppercase translate-x-1/2",children:f})}),s.jsx("div",{style:{width:`${m/l*100}%`},className:"relative",children:s.jsx("span",{className:"absolute right-0 bottom-0 text-[10px] font-black text-white/40 uppercase translate-x-1/2",children:n})}),s.jsx("div",{style:{width:`${h/l*100}%`},className:"relative",children:s.jsx("span",{className:"absolute right-0 bottom-0 text-[10px] font-black text-white/30 uppercase translate-x-1/2",children:t})}),s.jsx("div",{style:{width:`${p/l*100}%`},className:"relative",children:s.jsx("span",{className:"absolute right-0 bottom-0 text-[10px] font-black text-white/20 uppercase",children:e})})]}),s.jsxs("div",{className:"relative h-20 mb-12 flex gap-1 items-center",children:[s.jsxs("div",{className:"h-full bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-l-2xl relative group transition-all duration-700",style:{width:`${Math.max(f/l*100,2)}%`},children:[s.jsx("div",{className:"absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("div",{className:"absolute -top-8 left-0 text-[8px] font-black text-emerald-400 uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-all",children:"SCURIS"})]}),s.jsxs("div",{className:"h-2/3 bg-white/10 border border-white/10 relative group transition-all duration-700",style:{width:`${m/l*100}%`},children:[s.jsx("div",{className:"absolute inset-0 bg-orange-500/10 opacity-0 group-hover:opacity-100 transition-opacity"}),m>0&&s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-black text-white/20",children:["-",m]}),s.jsx("div",{className:"absolute -top-8 left-0 text-[8px] font-black text-white/40 uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-all whitespace-nowrap",children:"ATTENTE ACOMPTE"})]}),s.jsxs("div",{className:"h-1/2 bg-white/5 border border-white/5 relative group transition-all duration-700",style:{width:`${h/l*100}%`},children:[s.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),h>0&&s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-black text-white/10",children:["-",h]}),s.jsx("div",{className:"absolute -top-8 left-0 text-[8px] font-black text-white/30 uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-all whitespace-nowrap",children:"VISIT  SANS CONTRAT"})]}),s.jsxs("div",{className:"h-1/4 bg-white/[0.02] border border-white/[0.02] rounded-r-2xl relative group transition-all duration-700",style:{width:`${p/l*100}%`},children:[s.jsx("div",{className:"absolute inset-0 bg-slate-500/[0.02] opacity-0 group-hover:opacity-100 transition-opacity"}),p>0&&s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-black text-white/[0.05]",children:["-",p]}),s.jsx("div",{className:"absolute -top-8 right-0 text-[8px] font-black text-white/20 uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-all whitespace-nowrap",children:"LEADS BRUTS"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12",children:[s.jsx(os,{label:"Qualit Commerciale",rate:c,lostLabel:"Visites sans contrat",loss:h,color:"text-emerald-400",subLabel:"Signs / Total Visites"}),s.jsx(os,{label:"Pntration Prospect",rate:d,lostLabel:"Leads sans Dossier",loss:p,color:"text-cyan-400",subLabel:"Dossiers / Total Leads"}),s.jsx(os,{label:"Conversion Totale",rate:u,lostLabel:"Dossiers non signs",loss:p+h,color:"text-white",subLabel:"Signs / Total Leads"})]})]}):s.jsx("div",{className:"h-32 flex items-center justify-center text-white/20 uppercase font-black tracking-widest italic",children:"Aucune donne de pipeline disponible"})}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(yt,{label:"Conversion Vente",value:`${c}%`,color:"text-emerald-400",sub:"Signs vs Visits"}),s.jsx(yt,{label:"Taux Pntration",value:`${d}%`,color:"text-sky-400",sub:"Visits vs Leads"}),s.jsx(yt,{label:"Bottleneck",value:A,color:"text-orange-400",sub:"Point critique",isTextValue:!0}),s.jsx(yt,{label:"En Attente",value:h+m,color:"text-white",sub:"Dossiers  dbloquer",hoverList:[...i,...r]})]})]})},os=({label:e,rate:t,loss:n,lostLabel:i,color:r,subLabel:a})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-baseline",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] font-black text-white uppercase tracking-[0.2em]",children:e}),s.jsx("span",{className:"text-[9px] font-bold text-white/40 uppercase",children:a})]}),s.jsxs("span",{className:`text-3xl font-black font-mono tracking-tighter ${r}`,children:[t,"%"]})]}),s.jsx("div",{className:"h-1 bg-white/5 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full ${r.replace("text-","bg-")} opacity-60 transition-all duration-1000`,style:{width:`${t}%`}})}),s.jsx("div",{className:"flex flex-col gap-1",children:s.jsxs("span",{className:"text-[10px] font-mono text-red-500/60 font-bold uppercase tracking-wider tabular-nums",children:["-",n," ",i]})})]}),yt=({label:e,value:t,color:n,sub:i,isTextValue:r=!1,hoverList:a})=>s.jsxs("div",{className:"bg-black/40 rounded-3xl p-6 border border-white/5 hover:border-white/20 transition-all duration-300 shadow-lg group relative",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"text-[10px] text-white/30 uppercase font-black tracking-widest mb-1",children:e}),s.jsx("div",{className:"text-[9px] text-white/20 uppercase font-bold tracking-widest mb-4",children:i})]}),s.jsx("div",{className:`${r?"text-xl":"text-3xl"} font-black font-mono tracking-tighter ${n} truncate transition-transform duration-300 group-hover:scale-105 origin-left`,children:t}),a&&a.length>0&&s.jsxs("div",{className:"absolute bottom-full left-0 mb-4 w-64 bg-[#0a0e27] border border-white/10 rounded-2xl p-4 shadow-2xl opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity z-50",children:[s.jsx("div",{className:"text-[8px] font-black text-white/30 uppercase tracking-[0.2em] mb-4 border-b border-white/5 pb-2",children:"Dtail des dossiers"}),s.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2 pr-2 custom-scrollbar",children:a.map((o,l)=>s.jsxs("div",{className:"flex justify-between items-center gap-4",children:[s.jsx("span",{className:"text-[10px] font-black text-white truncate uppercase",children:o.name||"Inconnu"}),s.jsx("span",{className:"text-[8px] font-bold text-white/20 uppercase px-2 py-0.5 bg-white/5 rounded-full",children:o.status==="signed"?"Attente ":"Attente Signature"})]},l))})]})]}),de={secured:"#4ADE80",projected:"#38BDF8",target:"#ffffff",axis:"#ffffff10"},cm=({data:e,width:t,height:n})=>{if(t<10||n<10)return null;const i={top:40,right:30,bottom:50,left:70},r=Math.max(0,t-i.left-i.right),a=Math.max(0,n-i.top-i.bottom),o=N.useMemo(()=>cs({domain:_o(e,d=>d.date),range:[0,r]}),[e,r]),l=N.useMemo(()=>ue({domain:[0,Po(e,d=>Math.max(d.projected,d.target))||1e6],nice:!0,range:[a,0]}),[e,a]),c=e[e.length-1];return s.jsx("svg",{width:t,height:n,children:s.jsxs(U,{left:i.left,top:i.top,children:[s.jsx(et,{data:e,x:d=>o(d.date),y:d=>l(d.secured),yScale:l,fill:de.secured,fillOpacity:.05,curve:ne}),s.jsx(et,{data:e,x:d=>o(d.date),y0:d=>l(d.secured),y1:d=>l(d.projected),yScale:l,fill:de.projected,fillOpacity:.03,curve:ne}),s.jsx(Ve,{data:e,x:d=>o(d.date),y:d=>l(d.projected),stroke:de.projected,strokeWidth:1,strokeDasharray:"4 4",strokeOpacity:.2,curve:ne}),s.jsx(Ve,{data:e,x:d=>o(d.date),y:d=>l(d.target),stroke:de.target,strokeWidth:2,strokeDasharray:"6,4",strokeOpacity:.6,curve:ne}),s.jsx(Ve,{data:e,x:d=>o(d.date),y:d=>l((d.secured+d.projected)/2),stroke:de.projected,strokeWidth:4,strokeOpacity:.9,curve:ne}),c&&s.jsxs(U,{children:[s.jsx("circle",{cx:o(c.date),cy:l((c.secured+c.projected)/2),r:6,fill:de.projected,className:"animate-pulse"}),s.jsx("text",{x:o(c.date),y:l((c.secured+c.projected)/2)-15,fill:de.projected,fontSize:10,fontWeight:"black",textAnchor:"end",className:"font-mono uppercase tracking-widest",children:"Atterrissage projet"})]}),c&&s.jsx("text",{x:r,y:l(c.target)-12,fill:"white",fontSize:10,fontWeight:"black",textAnchor:"end",className:"uppercase tracking-widest opacity-40 font-sans",children:"Objectif Board Q2"}),s.jsx(Ue,{top:a,scale:o,stroke:"transparent",tickStroke:de.axis,tickLabelProps:()=>({fill:"#64748b",fontSize:10,fontWeight:"bold",className:"font-mono",textAnchor:"middle"})}),s.jsx(Ot,{scale:l,stroke:"transparent",tickStroke:de.axis,tickLabelProps:()=>({fill:"#64748b",fontSize:10,fontWeight:"bold",className:"font-mono",textAnchor:"end",verticalAnchor:"middle",dx:-5}),tickFormat:d=>`${Math.round(d/1e3)}k`,tickValues:[0,25e4,5e5,75e4,1e6]})]})})};function dm({data:e}){return!e||e.length===0?null:s.jsx("div",{style:{width:"100%",height:"350px"},children:s.jsx(ze,{children:({width:t,height:n})=>s.jsx(cm,{data:e,width:t,height:n})})})}function um({studies:e}){var r;const t=N.useMemo(()=>e.filter(a=>a.status==="cancelled"||a.status==="refused"),[e]),n=N.useMemo(()=>{const a={"Ignor (Avant Vue)":0,"Refus (Aprs Vue)":0,"Rtractation (Post-Sign)":0},o={"Ignor (Avant Vue)":"#64748b","Refus (Aprs Vue)":"#f97316","Rtractation (Post-Sign)":"#ef4444","Trop cher / Budget":"#eab308","Raison Technique / Toiture":"#8b5cf6","Concurrent moins cher":"#f43f5e","Refus Client / Ne rpond plus":"#f97316","Projet Abandonn":"#64748b","Erreur de saisie / Doublon":"#10b981"};return t.forEach(l=>{var d;const c=(d=l.study_data)==null?void 0:d.cancellation_reason;c?a[c]=(a[c]||0)+1:l.signed_at?a["Rtractation (Post-Sign)"]++:l.views>0?a["Refus (Aprs Vue)"]++:a["Ignor (Avant Vue)"]++}),Object.entries(a).map(([l,c])=>({label:l,value:c,color:o[l]||"#94a3b8"})).filter(l=>l.value>0).sort((l,c)=>c.value-l.value)},[t]),i=t.length;return s.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-center",children:[s.jsx("div",{className:"w-full md:w-1/3 h-[250px] relative",children:s.jsx(xr,{children:({width:a,height:o})=>{const l=Math.min(a,o)/2,c=o/2,d=a/2;return s.jsx("svg",{width:a,height:o,children:s.jsxs(U,{top:c,left:d,children:[s.jsx(Zo,{data:n,pieValue:u=>u.value,outerRadius:l,innerRadius:l-40,cornerRadius:3,padAngle:.02,children:u=>u.arcs.map((p,h)=>{const[m,f]=u.path.centroid(p),{label:g,value:b,color:v}=p.data;return s.jsxs("g",{children:[s.jsx("path",{d:u.path(p)||"",fill:v}),s.jsx("text",{x:m,y:f,dy:".33em",fill:"#ffffff",fontSize:10,textAnchor:"middle",fontWeight:"bold",children:b})]},`arc-${g}-${h}`)})}),s.jsx(Dn,{verticalAnchor:"middle",textAnchor:"middle",fill:"#fff",fontSize:24,fontWeight:"bold",children:i}),s.jsx(Dn,{y:20,verticalAnchor:"middle",textAnchor:"middle",fill:"#94a3b8",fontSize:10,fontWeight:"bold",letterSpacing:1,children:"PERDUS"})]})})}})}),s.jsxs("div",{className:"w-full md:w-2/3 space-y-6",children:[s.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight",children:"Rpartition des checs"}),s.jsx("p",{className:"text-sm text-slate-400",children:"Analyse automatique base sur le stade d'avancement du dossier au moment de l'annulation."}),s.jsx("div",{className:"space-y-3",children:n.map(a=>s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color}}),s.jsx("span",{className:"text-sm font-bold text-slate-200",children:a.label})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-xs font-mono text-slate-500",children:[Math.round(a.value/i*100),"%"]}),s.jsx("span",{className:"text-lg font-black text-white",children:a.value})]})]},a.label))}),s.jsx("div",{className:"p-4 rounded-xl bg-blue-500/10 border border-blue-500/20",children:s.jsxs("p",{className:"text-xs text-blue-300 leading-relaxed",children:[s.jsx("span",{className:"font-bold uppercase",children:"Conseil :"}),((r=n.find(a=>a.label.includes("Post-Sign")))==null?void 0:r.value)>0?"Le taux de rtractation est critique. Vrifiez le discours commercial post-signature.":"La majorit des pertes survient avant lecture. Amliorez l'objet des emails."]})})]})]})}function hm({system:e}){const{studies:t,financialStats:n,emailLeads:i,metrics:r}=e,a=N.useMemo(()=>({securedCA:n.cashSecured||0,exposedCA:n.cashAtRisk||0,cancelledCA:n.cashLost||n.totalPotentialCA*.1||5e4}),[n]),o=N.useMemo(()=>{const u=i&&i.length>0?i:t;if(!u||u.length===0)return Array.from({length:15}).map((f,g)=>({day:g,activeRate:0}));const p=new Date,h=new Array(15).fill(0);u.forEach(f=>{const g=f.last_opened_at||f.last_clicked_at||f.updated_at||f.created_at;if(g){const b=new Date(g),v=Math.floor((p.getTime()-b.getTime())/(1e3*3600*24));v<15&&v>=0&&h[v]++}});const m=u.length;return h.map((f,g)=>({day:g,activeRate:Math.round(f/m*100)}))},[i,t]),l=N.useMemo(()=>{const u=new Map;t.forEach(S=>{if(!u.has(S.email))u.set(S.email,S);else{const y=u.get(S.email);(S.status==="signed"||S.deposit_paid)&&!(y.status==="signed"||y.deposit_paid)&&u.set(S.email,S)}});const h=Array.from(u.values()).filter(S=>S.status!=="cancelled"),m=h.length,f=h.filter(S=>S.status==="signed"||S.deposit_paid),g=f.length,b=h.filter(S=>S.status!=="signed"&&!S.deposit_paid),v=f.filter(S=>!S.deposit_paid&&(S.payment_mode==="cash"||S.financing_mode==="with_deposit"||S.financing_mode==="partial_financing")),w=f.filter(S=>S.deposit_paid||S.financing_mode==="full_financing").length,A=(i==null?void 0:i.length)||0;return{leads:Math.max(A,m),visited:m,signed:g,waitingSignatureStudies:b,waitingDepositStudies:v,secured:w,securedAmount:(n==null?void 0:n.cashSecured)||0}},[i,t,n]),{projectionData:c,projectionMetrics:d}=N.useMemo(()=>{const u=[],p=new Date,h=n.cashSecured||0,m=(n.cashSecured||0)+(n.cashAtRisk||0)+(n.totalPotentialCA||0)*.2,f=h+(n.cashAtRisk||0)*.6+(n.totalPotentialCA||0)*.1,g=f-m,b=Math.min(100,Math.round(f/(m||1)*100));for(let v=0;v<=90;v+=10){const w=new Date(p);w.setDate(w.getDate()+v);const A=v/90;u.push({date:w,secured:h,projected:h+(f-h)*A,target:m})}return{projectionData:u,projectionMetrics:{deficit:g,probability:b,projectedLanding:f,boardTarget:m}}},[n]);return s.jsxs("div",{className:"flex flex-col gap-12 py-8 px-4 w-full h-full pb-40",children:[s.jsxs("header",{className:"flex flex-col gap-2",children:[s.jsx("h1",{className:"text-4xl font-black text-white tracking-tight uppercase",children:"Salle de Navigation"}),s.jsx("p",{className:"text-slate-500 text-[10px] font-bold uppercase tracking-widest",children:"Vision Dirigeant & Trajectoire Stratgique"})]}),s.jsxs("section",{className:"bg-black/20 backdrop-blur-sm p-12 rounded-3xl border border-white/5 space-y-12 shadow-2xl",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-12",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"S01  ANALYSE DE TRSORERIE"}),s.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tight",children:"Niveau de scurisation du CA"}),s.jsxs("div",{className:"flex items-center gap-6 mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500 shadow-[0_0_10px_rgba(16,185,129,0.3)] animate-pulse"}),s.jsx("span",{className:"text-lg font-bold text-white/70",children:"60% Scuris"}),s.jsx("span",{className:"text-sm font-bold text-emerald-400",children:"(+3.2 pts)"})]}),s.jsx("div",{className:"h-6 w-[2px] bg-white/5"}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"text-lg font-bold text-slate-500",children:"Objectif : 70%"})})]})]}),s.jsxs("div",{className:"text-left md:text-right",children:[s.jsxs("div",{className:"flex items-baseline md:justify-end gap-3",children:[s.jsx("span",{className:"text-6xl font-black text-white tracking-tighter tabular-nums font-mono drop-shadow-2xl",children:(n.cashSecured||0).toLocaleString()}),s.jsx("span",{className:"text-2xl font-bold text-white/10",children:""})]}),s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mt-2",children:"CASH NET SCURIS"})]})]}),s.jsx("div",{className:"pt-6",children:s.jsx(rm,{data:a})}),s.jsxs("div",{className:"bg-black/40 backdrop-blur-xl border border-white/10 p-8 rounded-2xl flex items-start gap-6 transition-all hover:border-white/20",children:[s.jsx("div",{className:"w-1.5 h-full bg-blue-500 rounded-full shadow-[0_0_15px_rgba(59,130,246,0.3)] min-h-[50px]"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("span",{className:"text-[10px] font-bold text-blue-400 uppercase tracking-widest",children:"Insight Stratgique"}),s.jsxs("p",{className:"text-sm text-slate-300 font-medium leading-relaxed max-w-3xl",children:[s.jsx("span",{className:"text-white font-bold text-base",children:"ALERTE SEGMENT :"})," 28% de l'exposition rside dans le segment ",s.jsx("span",{className:"text-orange-400 font-bold",children:"tudes Complexes"}),". Une scurisation des acomptes sur ce primtre permettrait d'atteindre l'objectif de 70% d'ici 14 jours."]})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-12",children:[s.jsxs("section",{className:"bg-black/20 backdrop-blur-sm p-12 rounded-3xl border border-white/5 space-y-10 shadow-xl",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-8",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"S02  MOMENT CRITIQUE CHURN"}),s.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tight",children:"Moment critique de dcrochage"}),s.jsx("p",{className:"text-[10px] font-bold text-orange-400 uppercase tracking-widest",children:"70% des annulations se prparent aprs J+7"})]}),s.jsxs("div",{className:"flex flex-col md:items-end gap-1",children:[s.jsx("span",{className:"text-3xl font-black text-white font-mono tabular-nums tracking-tighter uppercase",children:"8.2 JOURS"}),s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"DLAI MOYEN AVANT DCROCHAGE"})]})]}),s.jsx("div",{className:"py-4",children:s.jsx(om,{data:o})}),s.jsxs("div",{className:"bg-black/40 border border-orange-500/20 p-6 rounded-2xl flex items-start gap-4",children:[s.jsx("div",{className:"w-1 h-full bg-orange-500 rounded-full opacity-40 min-h-[40px]"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-[10px] font-bold text-orange-400 uppercase tracking-widest",children:"Action Recommande"}),s.jsxs("p",{className:"text-sm text-slate-300 leading-relaxed",children:[s.jsx("span",{className:"text-white font-bold",children:"INTERVENTION PROACTIVE :"})," Le pic de dcrochage se situe  ",s.jsx("span",{className:"text-white font-bold font-mono",children:"J+8"}),". Dclenchement automatique d'un call de courtoisie  ",s.jsx("span",{className:"text-white font-bold font-mono",children:"J+4"})," pour valider l'onboarding."]})]})]})]}),s.jsx("section",{className:"bg-black/20 backdrop-blur-sm p-12 rounded-3xl border border-white/5 shadow-xl",children:s.jsx(lm,{leads:l.leads,visited:l.visited,signed:l.signed,waitingSignatureStudies:l.waitingSignatureStudies,waitingDepositStudies:l.waitingDepositStudies,secured:l.secured,securedAmount:l.securedAmount})})]}),s.jsxs("section",{className:"bg-black/20 backdrop-blur-sm p-12 rounded-3xl border border-white/5 space-y-12 shadow-2xl",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-12",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"S04  TRAJECTOIRE FINANCIRE"}),s.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tight",children:"Atterrissage  90 Jours"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-6 mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${d.probability>=50?"bg-emerald-500 shadow-emerald-500/30":"bg-red-500 shadow-red-500/30"} shadow-[0_0_10px_rgba(255,255,255,0.1)] animate-pulse`}),s.jsx("span",{className:"text-lg font-bold text-white/70",children:"Probabilit d'atteinte"}),s.jsxs("span",{className:`text-lg font-black ${d.probability>=50?"text-emerald-500":"text-red-500"} font-mono tracking-tighter`,children:[d.probability,"%"]})]}),s.jsx("div",{className:"h-6 w-[2px] bg-white/5"}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"text-lg font-bold text-slate-500 italic",children:d.probability>=75?'"Objectif en voie de scurisation"':d.probability>=50?'"Trajectoire incertaine, action requise"':'"Objectif manqu fin avril"'})})]})]}),s.jsxs("div",{className:"text-left md:text-right",children:[s.jsx("div",{className:"flex items-baseline md:justify-end gap-3",children:s.jsxs("span",{className:`text-7xl font-black ${d.deficit>=0?"text-emerald-500":"text-red-500"} font-mono tracking-tighter tabular-nums drop-shadow-2xl`,children:[d.deficit>0?"+":"",Math.round(d.deficit/1e3),"k"]})}),s.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mt-2",children:["CART vs POTENTIEL MAX (",Math.round(d.boardTarget/1e3),"k)"]})]})]}),s.jsxs("div",{className:"py-2 relative",children:[s.jsx(dm,{data:c}),s.jsx("p",{className:"absolute bottom-0 right-0 text-[9px] text-slate-600 font-mono text-right",children:"*Objectif calcul sur 100% du Pipeline Actif + 20% des Pistes Froides"})]}),s.jsxs("div",{className:"bg-black/40 border border-red-500/20 p-8 rounded-2xl flex items-start gap-6 transition-all hover:border-red-500/30",children:[s.jsx("div",{className:"w-1.5 h-full bg-red-500 rounded-full opacity-40 min-h-[50px]"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("span",{className:"text-[10px] font-bold text-red-400 uppercase tracking-widest",children:"Alerte Gouvernance"}),s.jsxs("p",{className:"text-sm text-slate-300 leading-relaxed max-w-3xl",children:[s.jsx("span",{className:"text-white font-bold text-base uppercase tracking-tight",children:"Action Corrective :"})," L'objectif Board est atteignable avec ",s.jsx("span",{className:"text-white font-bold font-mono",children:"+12 signatures"})," ou une amlioration de ",s.jsx("span",{className:"text-emerald-400 font-bold font-mono",children:"+6%"})," de la conversion du pipeline. Priorit absolue sur les dossiers  ",">","50k."]})]})]})]}),s.jsxs("section",{className:"bg-black/20 backdrop-blur-sm p-12 rounded-3xl border border-white/5 space-y-12 shadow-2xl",children:[s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"S05  POST-MORTEM & REFUS"}),s.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tight",children:"Pourquoi perd-on des affaires ?"})]}),s.jsx("div",{className:"bg-black/40 rounded-2xl p-8 border border-white/5",children:s.jsx(um,{studies:t})})]})]})}const pm=({data:e,width:t,height:n,benchmarkPercentage:i=42})=>{const[r,a]=N.useState(null),o={top:60,right:30,bottom:80,left:30},l=Math.max(0,t-o.left-o.right),c=Math.max(0,n-o.top-o.bottom),d=N.useMemo(()=>Fs({domain:e.map(h=>h.label),range:[0,l],padding:.25}),[e,l]),u=Math.max(...e.map(h=>h.value),1),p=N.useMemo(()=>ue({domain:[0,u],range:[c,10]}),[u,c]);return s.jsxs("div",{className:"relative group/funnel",children:[s.jsx("svg",{width:t,height:n,className:"overflow-visible",children:s.jsxs(U,{left:o.left,top:o.top,children:[i&&s.jsxs(U,{top:c*(1-i/100),children:[s.jsx("line",{x1:0,x2:l,stroke:"#4ECDC4",strokeWidth:1,strokeDasharray:"4,4",opacity:.15}),s.jsxs("text",{x:l,y:-5,fill:"#4ECDC4",fontSize:9,fontWeight:"black",textAnchor:"end",className:"uppercase tracking-widest opacity-40",children:["Target ",i,"%"]})]}),e.map((h,m)=>{const f=d.bandwidth(),g=d(h.label)||0,b=Math.max(50,c-p(h.value)),v=c-b,w=h.isFriction,A=m>0?e[m-1].value:null,T=A?Math.round(h.value/A*100):null;return s.jsxs(U,{onMouseEnter:()=>a(m),onMouseLeave:()=>a(null),className:"cursor-pointer",children:[T!==null&&s.jsxs(U,{left:g-d.step()*d.padding()/2,children:[s.jsxs("text",{y:c-20,textAnchor:"middle",fill:w?"#FF6B6B":"white",opacity:w?1:.6,fontSize:14,fontWeight:"900",fontFamily:"IBM Plex Mono",children:[T,"%"]}),s.jsx("path",{d:"M -5 10 L 0 15 L 5 10",fill:"none",stroke:w?"#FF6B6B":"white",strokeWidth:2,opacity:w?1:.3,transform:`translate(0, ${c-45})`})]}),s.jsx("rect",{x:g,y:v,width:f,height:b,fill:w?"url(#frictionGradient)":h.color,fillOpacity:r===m?.9:.7,stroke:w?"#FF6B6B":"white",strokeOpacity:r===m?1:.4,strokeWidth:w?3:1,rx:6,className:"transition-all duration-300"}),s.jsx("text",{x:g+f/2,y:v-8,fill:"white",fontSize:11,fontWeight:"bold",fontFamily:"IBM Plex Mono",textAnchor:"middle",opacity:.4,children:h.value}),s.jsxs("text",{x:g+f/2,y:v+b/2+6,fill:"white",opacity:.95,fontSize:b>80?18:16,fontWeight:"black",fontFamily:"IBM Plex Mono",textAnchor:"middle",style:{filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.95))"},children:[Math.round(h.revenue/1e3),"k"]}),h.avgDelay!==void 0&&h.avgDelay>0&&s.jsx(U,{top:c+16,left:g+f/2,children:s.jsxs("text",{fill:h.avgDelay>7?"#FF6B6B":"white",opacity:.6,fontSize:11,fontWeight:"black",textAnchor:"middle",children:[h.avgDelay,"j"]})}),s.jsx("text",{x:g+f/2,y:c+48,fill:"white",opacity:r===m?1:.3,fontSize:12,fontWeight:"900",className:"uppercase tracking-[0.2em]",textAnchor:"middle",children:h.label})]},`step-${m}`)}),s.jsx("defs",{children:s.jsxs("linearGradient",{id:"frictionGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#FF6B6B",stopOpacity:.8}),s.jsx("stop",{offset:"100%",stopColor:"#E63946",stopOpacity:.3})]})})]})}),r!==null&&s.jsx("div",{className:"absolute z-50 pointer-events-none bg-[#1a1c23] border border-white/20 p-4 rounded-xl shadow-2xl backdrop-blur-xl animate-in fade-in zoom-in duration-200",style:{left:d(e[r].label)+o.left+d.bandwidth()/2,top:o.top+(c-Math.max(25,c-p(e[r].value)))-100,transform:"translateX(-50%)"},children:s.jsxs("div",{className:"flex flex-col gap-1 min-w-[140px]",children:[s.jsx("div",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest",children:e[r].label}),s.jsxs("div",{className:"flex justify-between items-baseline gap-4 mt-2",children:[s.jsx("span",{className:"text-2xl font-black text-white font-mono",children:e[r].value}),s.jsx("span",{className:"text-xs font-bold text-white/40 uppercase",children:"Dossiers"})]}),s.jsxs("div",{className:"text-lg font-black text-emerald-400 font-mono",children:[Math.round(e[r].revenue/1e3),"k ",s.jsx("span",{className:"text-[10px] text-white/20 uppercase tracking-tighter",children:"Volume"})]}),r>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-white/5 flex justify-between items-center",children:[s.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase",children:"Efficience"}),s.jsxs("span",{className:"text-sm font-black text-white",children:[Math.round(e[r].value/e[r-1].value*100),"%"]})]})]})})]})};function mm({data:e,benchmarkPercentage:t}){return!e||e.length===0?null:s.jsx("div",{style:{width:"100%",height:"320px"},className:"relative",children:s.jsx(ze,{children:({width:n,height:i})=>s.jsx(pm,{data:e,width:n,height:i,benchmarkPercentage:t})})})}const fm=({data:e,autopilotIndex:t,width:n,height:i})=>{const r={top:40,right:30,bottom:40,left:30},a=Math.max(0,n-r.left-r.right),o=Math.max(0,i-r.top-r.bottom),l=N.useMemo(()=>Fs({domain:e.map(u=>u.label),range:[0,a],padding:.3}),[e,a]),c=Math.max(...e.map(u=>Math.max(u.value,u.target||0)),1),d=N.useMemo(()=>ue({domain:[0,c*1.1],range:[o,0]}),[c,o]);return s.jsxs("svg",{width:n,height:i,className:"overflow-visible",children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"emeraldGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#10B981",stopOpacity:.8}),s.jsx("stop",{offset:"100%",stopColor:"#059669",stopOpacity:.3})]})}),s.jsxs(U,{left:r.left,top:r.top,children:[s.jsx(U,{children:e.map((u,p)=>{if(p===0||!u.target)return null;const h=e[p-1];return h.target?s.jsx("line",{x1:(l(h.label)||0)+l.bandwidth()/2,y1:d(h.target),x2:(l(u.label)||0)+l.bandwidth()/2,y2:d(u.target),stroke:"white",strokeOpacity:.15,strokeWidth:1,strokeDasharray:"4,4"},`target-line-${p}`):null})}),t<e.length&&s.jsxs(U,{left:l(e[t].label)||0,children:[s.jsx("line",{y1:-20,y2:o,stroke:"white",strokeOpacity:.2,strokeWidth:1,strokeDasharray:"4,2"}),s.jsx("text",{y:-25,fill:"white",opacity:.3,fontSize:8,fontWeight:"black",className:"uppercase tracking-widest text-[7px]",children:"Dmarrage Autopilote"})]}),e.map((u,p)=>{const h=l.bandwidth(),m=l(u.label)||0,f=d(u.value),g=Math.max(2,o-f),b=p>=t;return s.jsxs(U,{children:[s.jsx("rect",{x:m,y:f,width:h,height:g,fill:b?"url(#emeraldGradient)":"white",fillOpacity:b?.9:.15,rx:4,className:"transition-all duration-500"}),s.jsxs("text",{x:m+h/2,y:f-8,fill:"white",opacity:b?1:.3,fontSize:9,fontWeight:"black",fontFamily:"IBM Plex Mono",textAnchor:"middle",children:[Math.round(u.value/1e3),"k"]})]},`revenue-bar-${p}`)}),s.jsx(Ue,{top:o,scale:l,stroke:"transparent",tickStroke:"transparent",tickLabelProps:()=>({fill:"#ffffff20",fontSize:9,fontFamily:"IBM Plex Mono",textAnchor:"middle",fontWeight:"bold",className:"uppercase tracking-[0.2em]"})})]})]})};function xm({data:e,autopilotIndex:t}){return!e||e.length===0?null:s.jsx("div",{style:{width:"100%",height:"280px"},children:s.jsx(ze,{children:({width:n,height:i})=>s.jsx(fm,{data:e,autopilotIndex:t,width:n,height:i})})})}function gm({system:e}){const{studies:t,metrics:n,financialStats:i,emailLeads:r}=e,a=N.useMemo(()=>{const h=new Map;return t.forEach(m=>{if(!h.has(m.email))h.set(m.email,m);else{const f=h.get(m.email);(m.status==="signed"||m.deposit_paid)&&!(f.status==="signed"||f.deposit_paid)&&h.set(m.email,m)}}),Array.from(h.values()).filter(m=>m.status!=="cancelled")},[t]),o=N.useMemo(()=>a.filter(h=>h.status==="signed"||h.deposit_paid).length,[a]),l=N.useMemo(()=>{const h=(r==null?void 0:r.length)||1,m=a.length,f=a.filter(P=>P.views>0).length,g=a.filter(P=>(P.clicks||0)>0).length,b=o,v=h>0?m/h*100:0,w=m>0?f/m*100:0,A=f>0?g/f*100:0,T=g>0?b/g*100:0,S=m>0?b/m*100:0,y=42,x=-6,j=[{label:"QUALIF",rate:v,actual:v,from:"Leads",to:"Dossiers",target:90,input:h},{label:"OUVERTURE",rate:w,actual:w,from:"Dossiers",to:"Ouvertures",target:85,input:m},{label:"CLIC",rate:A,actual:A,from:"Ouvertures",to:"Clics",target:50,input:f},{label:"CLOSING",rate:T,actual:T,from:"Clics",to:"Signs",target:50,input:g}],k=j.reduce((P,z)=>z.rate/z.target<P.rate/P.target?z:P,j[0]),M=k.rate<k.target*.7,E=o>0?i.caTotal/o:28e3,D=k.target-k.actual,_=Math.round(k.input*(D/100));let C=1;k.label==="QUALIF"?C=(f/m||0)*(g/f||0)*(b/g||0):k.label==="OUVERTURE"?C=(g/f||0)*(b/g||0):k.label==="CLIC"&&(C=b/g||0);const I=Math.round(_*C*E),K=I>15e3?`Potentiel de ${Math.round(I/1e3)}k/mois en optimisant ${k.from}  ${k.to}.`:"Pipeline performant. Focus sur l'optimisation continue.",O=()=>k.label==="QUALIF"?"Augmenter la qualification des leads entrants.":k.label==="OUVERTURE"?"Optimiser l'objet des emails et les horaires d'envoi.":k.label==="CLIC"?"Simplifier le CTA et rduire la longueur de l'tude.":k.label==="CLOSING"?"Renforcer le social proof et automatiser la relance post-clic.":"Augmenter la qualification des leads entrants.";return{globalConversion:S,benchmark:y,diff:S-y,evolution:x,executiveLine:K,monthlyRecoveryPotential:I,recommendation:O(),worst:k,isCritical:M,avgBasket:E,metrics:{qualificationRate:v,openRate:w,clickRate:A,closeRate:T,totalLeads:h,totalDossiers:m,totalOpens:f,totalClicks:g,totalSigned:b}}},[r,a,o,i]),c=N.useMemo(()=>[{label:"LEADS",value:l.metrics.totalLeads,revenue:l.metrics.totalLeads*l.avgBasket,color:"#475569"},{label:"DOSSIERS",value:l.metrics.totalDossiers,revenue:l.metrics.totalDossiers*l.avgBasket,color:"#334155"},{label:"OUVERTS",value:l.metrics.totalOpens,revenue:l.metrics.totalOpens*l.avgBasket,color:"#1e293b",isFriction:l.worst.label==="OUVERTURE",avgDelay:2},{label:"CLIQUS",value:l.metrics.totalClicks,revenue:l.metrics.totalClicks*l.avgBasket,color:"#0f172a",isFriction:l.worst.label==="CLIC",avgDelay:9},{label:"SIGNS",value:l.metrics.totalSigned,revenue:l.metrics.totalSigned*l.avgBasket,color:"#10B981",isFriction:l.worst.label==="CLOSING"}],[l]),d=N.useMemo(()=>{var h;return a.filter(m=>m.was_war_room&&(m.status==="signed"||m.deposit_paid)).reduce((m,f)=>m+(f.total_price||0),0)||((h=n.warRoom)==null?void 0:h.ca)||0},[a,n]),u=l.metrics.totalLeads*.25,p=N.useMemo(()=>{const h=[],m=new Date;for(let f=5;f>=0;f--){const g=new Date(m.getFullYear(),m.getMonth()-f,1),b=g.toLocaleDateString("fr-FR",{month:"short"});h.push({label:b.charAt(0).toUpperCase()+b.slice(1).replace(".",""),m:g.getMonth(),y:g.getFullYear(),value:0,target:1e5+(5-f)*25e3})}return a.forEach(f=>{if(!(f.status==="signed"||f.deposit_paid))return;const b=f.signed_at||f.created_at;if(!b)return;const v=new Date(b),w=v.getMonth(),A=v.getFullYear(),T=h.find(S=>S.m===w&&S.y===A);T&&(T.value+=f.total_price||0)}),h.map(({label:f,value:g,target:b})=>({label:f,value:g,target:b}))},[a]);return s.jsxs("div",{className:"flex flex-col gap-12 py-12 px-8 w-full h-full pb-40",children:[s.jsx("section",{className:"bg-[#0F1115] p-10 rounded-3xl border border-white/[0.08] shadow-[0_20px_50px_rgba(0,0,0,0.5)]",children:s.jsxs("div",{className:"flex flex-col gap-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-[10px] font-black text-white/20 uppercase tracking-[0.4em]",children:"Executive Summary"}),s.jsx("h1",{className:"text-3xl md:text-4xl font-black text-white leading-tight uppercase tracking-tighter",children:l.executiveLine}),s.jsxs("div",{className:"flex items-baseline gap-4",children:[s.jsx("span",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"Impact:"}),s.jsxs("span",{className:"text-5xl font-black text-[#FF6B6B] font-mono tracking-tighter",children:[Math.round(l.monthlyRecoveryPotential/1e3),"k"]}),s.jsx("span",{className:"text-xs font-bold text-white/20 uppercase tracking-widest",children:"/ mois non capts"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:`p-6 rounded-2xl border-2 backdrop-blur-md ${l.isCritical?"bg-red-500/10 border-red-500/30":"bg-white/5 border-white/10"}`,children:[s.jsx("div",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest mb-1",children:"Status Audit"}),s.jsx("div",{className:`text-sm font-black uppercase ${l.isCritical?"text-red-500":"text-emerald-500"}`,children:l.isCritical?"Friction Critique":"Friction Dtecte"})]}),s.jsxs("div",{className:"p-6 rounded-2xl bg-white/5 border border-white/10 backdrop-blur-md",children:[s.jsx("div",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest mb-1",children:"Conversion Relle"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("div",{className:"text-2xl font-black text-white font-mono",children:[Math.round(l.globalConversion),"%"]}),s.jsxs("div",{className:`text-[10px] font-black ${l.evolution<0?"text-red-500":"text-emerald-500"}`,children:[l.evolution<0?"":""," ",Math.abs(l.evolution),"pts"]})]})]}),s.jsxs("div",{className:`p-6 rounded-2xl border-2 backdrop-blur-md ${l.diff<0?"bg-orange-500/10 border-orange-500/30":"bg-emerald-500/10 border-emerald-500/30"}`,children:[s.jsx("div",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest mb-1",children:"vs Benchmark"}),s.jsxs("div",{className:`text-2xl font-black font-mono ${l.diff<0?"text-orange-500":"text-emerald-400"}`,children:[l.diff>0?"+":"",Math.round(l.diff),"pts"]})]}),s.jsxs("div",{className:"p-6 rounded-2xl bg-indigo-500/10 border border-indigo-500/20 backdrop-blur-md",children:[s.jsx("div",{className:"text-[9px] font-black text-indigo-400/60 uppercase tracking-widest mb-1",children:"Panier Moyen"}),s.jsxs("div",{className:"text-2xl font-black text-white font-mono",children:[Math.round(l.avgBasket/1e3),"k"]})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[s.jsxs("section",{className:"lg:col-span-12 bg-black/40 backdrop-blur-xl p-10 rounded-[2.5rem] border border-white/5 space-y-10 shadow-2xl relative overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-8 relative z-10",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:["Flux Commercial  ",c[0].label,"  ",c[c.length-1].label]}),s.jsx("p",{className:"text-xs text-white/20 font-bold uppercase tracking-widest",children:"Analyse ddoublone 1:1 avec tension visuelle sur frictions."})]}),s.jsxs("div",{className:"bg-emerald-500/10 border-l-4 border-emerald-500 p-4 rounded-r-xl max-w-sm",children:[s.jsx("div",{className:"text-[9px] font-black text-emerald-400 uppercase tracking-widest mb-1",children:"Priorit Immdiate"}),s.jsxs("div",{className:"text-sm font-bold text-white uppercase leading-tight",children:[l.worst.from,"  ",l.worst.to," : ",l.recommendation]})]})]}),s.jsx("div",{className:"pt-6",children:s.jsx(mm,{data:c,benchmarkPercentage:l.benchmark})}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-10 border-t border-white/5",children:[s.jsx(jt,{label:"CA Gnr",value:`${Math.round(i.caTotal/1e3)}k`}),s.jsx(jt,{label:"Potentiel Rcuprable",value:`+${Math.round(l.monthlyRecoveryPotential/1e3)}k`,color:"text-emerald-400"}),s.jsx(jt,{label:"Dlai Moyen",value:"11.2 j"}),s.jsx(jt,{label:"Units Perdues",value:Math.max(0,Math.round(a.length*.42-o)),color:"text-red-500"})]})]}),s.jsxs("section",{className:"lg:col-span-8 bg-[#0b0f17] p-10 rounded-[2.5rem] border border-white/5 space-y-10 shadow-2xl",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[9px] tracking-[0.35em] text-white/30 uppercase",children:"Trajectoire Business"}),s.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tight",children:"Acclration du Chiffre dAffaires"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-3xl font-black text-emerald-400 font-mono tracking-tighter",children:[Math.round(d/1e3),"k"]}),s.jsx("p",{className:"text-[9px] text-white/20 font-black uppercase tracking-widest",children:"CA Scuris"})]})]}),s.jsx(xm,{data:p,autopilotIndex:3}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-10",children:[s.jsxs("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/10 backdrop-blur-md",children:[s.jsx("p",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest mb-1",children:"Temps Libr Cumulativement"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-3xl font-black text-white font-mono",children:Math.round(u)}),s.jsx("span",{className:"text-sm font-bold text-white/30 uppercase tracking-widest",children:"heures"})]})]}),s.jsxs("div",{className:"bg-emerald-500/10 rounded-2xl p-6 border border-emerald-500/20 backdrop-blur-md",children:[s.jsx("p",{className:"text-[9px] font-black text-emerald-400/60 uppercase tracking-widest mb-1",children:"Impact Business Direct"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-3xl font-black text-emerald-400 font-mono",children:["+",Math.round(d/1e3)]}),s.jsx("span",{className:"text-sm font-bold text-emerald-400/40 uppercase tracking-widest",children:"k scuriss"})]})]})]})]}),s.jsx("section",{className:"lg:col-span-4 flex flex-col gap-6",children:s.jsxs("div",{className:"bg-gradient-to-br from-indigo-950/40 via-black to-black p-12 rounded-[3.5rem] border border-indigo-500/10 flex-1 flex flex-col justify-between shadow-2xl relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 blur-[80px] rounded-full group-hover:scale-150 transition-transform duration-1000"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("span",{className:"text-[10px] font-black text-indigo-400/60 uppercase tracking-[0.4em]",children:"Brain Autopilote"}),s.jsx("div",{className:"h-1 w-12 bg-indigo-500 rounded-full"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("span",{className:"text-[9px] font-black text-white/20 uppercase tracking-widest",children:"Efficience Flux"}),s.jsxs("div",{className:"text-5xl font-black text-white font-mono tracking-tighter",children:["98.4",s.jsx("span",{className:"text-sm text-white/20",children:"%"})]})]})]}),s.jsxs("div",{className:"space-y-4 pt-12 border-t border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Protection CA"}),s.jsx("span",{className:"text-xs font-black text-emerald-500",children:"ACTIF"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Relance tudes"}),s.jsx("span",{className:"text-xs font-black text-emerald-500",children:"ACTIF"})]}),s.jsxs("div",{className:"flex justify-between items-center opacity-30",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Smart Closing"}),s.jsx("span",{className:"text-xs font-black text-white/40",children:"BETA"})]})]})]})})]})]})}const jt=({label:e,value:t,color:n="text-white"})=>s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-[9px] font-black text-white/20 uppercase tracking-[0.2em]",children:e}),s.jsx("div",{className:`text-xl font-black font-mono tracking-tighter ${n}`,children:t})]});function bm({data:e,securedRevenue:t,cycleBefore:n,cycleNow:i,savedHours:r}){const[a,o]=N.useState(null),l=N.useMemo(()=>Math.max(...e.map(x=>x.creation),1),[e]),c=N.useMemo(()=>Math.max(...e.map(x=>x.protection),1),[e]),d=n&&i?Math.round((i-n)/n*100):null,u={top:40,right:80,bottom:60,left:80},p=800,h=300,m=p-u.left-u.right,f=h-u.top-u.bottom,g=x=>f-x/l*f,b=x=>f-x/c*f,v=x=>{const j=x==="creation"?g:b;return e.map((k,M)=>{const E=M/(e.length-1)*m,D=j(k[x]);return`${M===0?"M":"L"}${E},${D}`}).join(" ")},w=v("creation"),A=v("protection"),T=N.useMemo(()=>{const x=e[e.length-1];return x?x.protection>x.creation?"Le systme protge dsormais plus de chiffre d'affaires qu'il n'en gnre : effet dfensif confirm.":x.protection>x.creation*.7?"La protection du CA devient un levier stratgique majeur.":"Le systme agit surtout en acquisition : potentiel dfensif encore sousexploit.":""},[e]),S=N.useMemo(()=>{const j=[];for(let k=0;k<=5;k++){const M=l/5*k;j.push(M)}return j},[l]),y=N.useMemo(()=>{const j=[];for(let k=0;k<=5;k++){const M=c/5*k;j.push(M)}return j},[c]);return s.jsxs("section",{className:"w-full rounded-2xl bg-[#0b0e14] border border-white/10 p-8 text-white shadow-[0_20px_60px_rgba(0,0,0,0.45)]",children:[s.jsxs("header",{className:"mb-10",children:[s.jsx("div",{className:"text-xs uppercase tracking-[0.35em] text-white/30 mb-3",children:"Performance commerciale autonome"}),s.jsxs("div",{className:"flex items-end gap-6 flex-wrap",children:[s.jsxs("h1",{className:"text-7xl font-bold leading-none",children:[(t/1e3).toFixed(0),"k"]}),s.jsx("p",{className:"text-white/50 max-w-sm pb-2",children:"Chiffre d'affaires scuris automatiquement"})]})]}),s.jsxs("div",{className:"mb-10 bg-[#0f141f] rounded-xl p-6 border border-white/5 relative",children:[s.jsxs("div",{className:"flex gap-6 mb-4 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-0.5 bg-[#3ecfff]"}),s.jsx("span",{className:"text-white/60",children:"Cration (Clients uniques)"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-0.5 bg-[#7cffb2]"}),s.jsx("span",{className:"text-white/60",children:"Protection (CA Scuris)"})]})]}),s.jsx("svg",{viewBox:`0 0 ${p} ${h}`,className:"w-full",children:s.jsxs("g",{transform:`translate(${u.left},${u.top})`,children:[y.map((x,j)=>s.jsx("line",{x1:0,y1:b(x),x2:m,y2:b(x),stroke:"rgba(255,255,255,0.05)",strokeDasharray:"2,4"},j)),s.jsx("line",{x1:0,y1:0,x2:0,y2:f,stroke:"rgba(62,207,255,0.3)",strokeWidth:1}),S.map((x,j)=>s.jsx("g",{children:s.jsx("text",{x:-10,y:g(x),fill:"rgba(62,207,255,0.6)",fontSize:10,textAnchor:"end",dominantBaseline:"middle",fontFamily:"IBM Plex Mono",children:Math.round(x)})},j)),s.jsx("text",{x:-60,y:f/2,fill:"rgba(62,207,255,0.6)",fontSize:11,textAnchor:"middle",transform:`rotate(-90, -60, ${f/2})`,fontFamily:"IBM Plex Mono",children:"CLIENTS"}),s.jsx("line",{x1:m,y1:0,x2:m,y2:f,stroke:"rgba(124,255,178,0.3)",strokeWidth:1}),y.map((x,j)=>s.jsxs("text",{x:m+10,y:b(x),fill:"rgba(124,255,178,0.6)",fontSize:10,textAnchor:"start",dominantBaseline:"middle",fontFamily:"IBM Plex Mono",children:[Math.round(x/1e3),"k"]},j)),s.jsx("text",{x:m+60,y:f/2,fill:"rgba(124,255,178,0.6)",fontSize:11,textAnchor:"middle",transform:`rotate(90, ${m+60}, ${f/2})`,fontFamily:"IBM Plex Mono",children:"CA PROTG"}),s.jsx("line",{x1:0,y1:f,x2:m,y2:f,stroke:"rgba(255,255,255,0.2)",strokeWidth:1}),e.map((x,j)=>{const k=j/(e.length-1)*m;return s.jsx("text",{x:k,y:f+20,fill:"rgba(255,255,255,0.4)",fontSize:10,textAnchor:"middle",fontFamily:"IBM Plex Mono",children:x.label},j)}),s.jsx("path",{d:w,fill:"none",stroke:"#3ecfff",strokeWidth:"3",opacity:"0.85"}),s.jsx("path",{d:A,fill:"none",stroke:"#7cffb2",strokeWidth:"3",opacity:"0.9"}),e.map((x,j)=>{const k=j/(e.length-1)*m,M=b(x.protection),E=g(x.creation);return s.jsxs("g",{children:[s.jsx("circle",{cx:k,cy:E,r:a===j?5:3,fill:"#3ecfff",onMouseEnter:()=>o(j),onMouseLeave:()=>o(null),style:{cursor:"pointer"}}),s.jsx("circle",{cx:k,cy:M,r:a===j?6:4,fill:"#7cffb2",onMouseEnter:()=>o(j),onMouseLeave:()=>o(null),style:{cursor:"pointer"}})]},j)})]})}),a!==null&&s.jsxs("div",{className:"absolute bottom-4 left-6 text-xs bg-black/90 px-4 py-3 rounded-lg border border-white/20",children:[s.jsx("div",{className:"font-bold mb-1",children:e[a].label}),s.jsxs("div",{className:"text-[#3ecfff]",children:["Leads: ",e[a].creation]}),s.jsxs("div",{className:"text-[#7cffb2]",children:["CA Protg: ",(e[a].protection/1e3).toFixed(0),"k"]})]})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-10",children:[i!==void 0&&s.jsxs("div",{className:"bg-white/[0.04] p-6 rounded-xl border border-white/10",children:[s.jsx("div",{className:"text-xs text-white/40 uppercase mb-1",children:"Cycle commercial"}),s.jsxs("div",{className:"text-4xl font-bold",children:[i," jours"]}),d!==null&&d!==0&&s.jsxs("div",{className:`text-sm mt-1 ${d<0?"text-emerald-400":"text-red-400"}`,children:[d>0?"+":"",d,"% vs avant"]})]}),r!==void 0&&r>0&&s.jsxs("div",{className:"bg-white/[0.04] p-6 rounded-xl border border-white/10",children:[s.jsx("div",{className:"text-xs text-white/40 uppercase mb-1",children:"Temps libr"}),s.jsxs("div",{className:"text-4xl font-bold",children:[r,"h"]}),s.jsx("div",{className:"text-white/40 text-sm",children:"Capacit commerciale rcupre"})]}),s.jsxs("div",{className:"bg-white/[0.04] p-6 rounded-xl border border-white/10",children:[s.jsx("div",{className:"text-xs text-white/40 uppercase mb-1",children:"Lecture stratgique"}),s.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:T})]})]}),s.jsx("footer",{className:"border-t border-white/10 pt-6",children:s.jsx("p",{className:"text-sm text-white/70",children:" Priorit : renforcer la protection du CA existant avant d'augmenter l'acquisition."})})]})}function vm({system:e}){var u;const{studies:t,metrics:n,emailLeads:i}=e,r=N.useMemo(()=>{const p=new Date,h=new Date(p.getFullYear(),p.getMonth(),1);return t.filter(m=>{if(!m.signed_at||m.status!=="signed"&&!m.deposit_paid)return!1;const f=new Date(m.signed_at);return f>=h&&f<=p}).reduce((m,f)=>m+(f.total_price||0),0)},[t]),a=14.5,o=11.2,l=((u=n.stats)==null?void 0:u.totalEmailsSent)||0,c=Math.max(10,Math.round(l*.25)),d=N.useMemo(()=>{const p=new Date,h=new Date(p.getFullYear(),p.getMonth(),1),m=[];for(let f=0;f<=6;f++){const g=f/6,b=h.getTime()+(p.getTime()-h.getTime())*g,v=new Date(b),w=t.filter(S=>{if(!S.created_at)return!1;const y=new Date(S.created_at);return y>=h&&y<=v}),A=new Set(w.map(S=>S.email).filter(S=>S)),T=t.filter(S=>{if(!S.signed_at||S.status!=="signed"&&!S.deposit_paid)return!1;const y=new Date(S.signed_at);return y>=h&&y<=v}).reduce((S,y)=>S+(y.total_price||0),0);m.push({label:v.toLocaleDateString("fr-FR",{day:"numeric",month:"short"}),creation:A.size,protection:T})}return m},[t]);return s.jsx("div",{className:"flex flex-col gap-8 py-12 px-6 w-full h-full pb-40",children:s.jsx(bm,{data:d,securedRevenue:r,cycleBefore:a,cycleNow:o,savedHours:c})})}const ym=({filters:e,onFilterChange:t})=>s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-6",children:[s.jsx("input",{type:"text",placeholder:" Rechercher un client...",value:e.search,onChange:n=>t({...e,search:n.target.value}),className:"flex-1 min-w-[200px] px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:border-blue-500 focus:outline-none"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>t({...e,views:e.views==="5+"?null:"5+"}),className:`px-4 py-2 rounded-lg font-bold text-sm transition-all ${e.views==="5+"?"bg-orange-600 text-white shadow-lg":"bg-slate-800/50 text-slate-400 hover:bg-slate-700 border border-slate-700/30"}`,children:" Vues 5+"}),s.jsx("button",{onClick:()=>t({...e,clicks:e.clicks==="1+"?null:"1+"}),className:`px-4 py-2 rounded-lg font-bold text-sm transition-all ${e.clicks==="1+"?"bg-green-600 text-white shadow-lg":"bg-slate-800/50 text-slate-400 hover:bg-slate-700 border border-slate-700/30"}`,children:" Clics 1+"}),s.jsx("button",{onClick:()=>t({...e,status:e.status==="sent"?null:"sent"}),className:`px-4 py-2 rounded-lg font-bold text-sm transition-all ${e.status==="sent"?"bg-blue-600 text-white shadow-lg":"bg-slate-800/50 text-slate-400 hover:bg-slate-700 border border-slate-700/30"}`,children:" Envoys"}),s.jsx("button",{onClick:()=>t({...e,optout:!e.optout}),className:`px-4 py-2 rounded-lg font-bold text-sm transition-all ${e.optout?"bg-red-600 text-white shadow-lg":"bg-slate-800/50 text-slate-400 hover:bg-slate-700 border border-slate-700/30"}`,children:" Opt-out"})]}),(e.search||e.views||e.clicks||e.status||e.optout)&&s.jsx("button",{onClick:()=>t({search:"",views:null,clicks:null,status:null,optout:!1}),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-bold text-sm transition-colors",children:" Reset"})]});function jm(e){const t=Math.floor((new Date().getTime()-new Date(e).getTime())/1e3);return t<60?" l'instant":t<3600?`Il y a ${Math.floor(t/60)}min`:t<86400?`Il y a ${Math.floor(t/3600)}h`:t<604800?`Il y a ${Math.floor(t/86400)}j`:new Date(e).toLocaleDateString("fr-FR")}function ls(e){return e.toLocaleString("fr-FR")+" "}function wm(e){if(!e.last_email_sent)return"Immdiat";const t=new Date(e.created_at),n=new Date(e.last_email_sent),r=Math.floor((new Date().getTime()-t.getTime())/864e5);if(r>120)return"Termin";const a=r<=60?3:7,o=new Date(n);return o.setDate(o.getDate()+a),o.toLocaleDateString("fr-FR")}const or={MUET:{label:"SILENCE",class:"bg-zinc-800/50 text-zinc-400 border border-zinc-700/50",description:"Client inactif"},CAS_LIMITE:{label:"CONTACT EXCESSIF",class:"bg-amber-900/20 text-amber-200/80 border border-amber-800/30",description:"Sur-engagement"},AGIT:{label:"AGIT",class:"bg-orange-900/20 text-orange-200/80 border border-orange-800/30",description:"Risque annulation"},INTRESS:{label:"INTRESS",class:"bg-emerald-900/20 text-emerald-200/80 border border-emerald-800/30",description:"Opportunit"},STABLE:{label:"STABLE",class:"bg-zinc-900 text-zinc-500 border border-zinc-800",description:"Sous surveillance"},FATIGUE:{label:"INACTIF",class:"bg-red-900/10 text-red-300 border border-red-900/20",description:"Lead dormant"}},io=({study:e,antiAnnulationByStudy:t,postRefusByStudy:n,onSignStudy:i,onCancelStudy:r,onDeleteStudy:a,onMarkDepositPaid:o,onMarkRibSent:l,showActions:c=!0,leads:d=[]})=>{var E,D,_;const u=Oo(e),p=or[u.state]||or.STABLE,h=C=>C&&C.sent&&C.sent.length>0,m=t?t[String(e.id)]||t[String(e.client_id)]:null,f=n?n[String(e.id)]||n[String(e.client_id)]:null,g=(d||[]).find(C=>!!(C.study_id&&C.study_id===e.id||C.client_id&&C.client_id===e.client_id||C.client_email&&e.email&&C.client_email.toLowerCase().trim()===e.email.toLowerCase().trim()&&C.client_email!=="Pas d'email")),b=g?{total_opens:g.total_opens||0,sent:g.last_email_sent?[{sent_at:g.last_email_sent,opened_at:g.last_opened_at}]:[],next:g.next_email_date?{scheduled_for:g.next_email_date}:null}:null;let v=null,w=null;e.status==="signed"?h(m)?(v="anti-annulation",w=m):h(f)&&(v="post-refus",w=f):h(f)?(v="post-refus",w=f):h(m)?(v="anti-annulation",w=m):h(b)&&(v="prospection",w=b),v||(e.status==="signed"?m!=null&&m.next?(v="anti-annulation",w=m):f!=null&&f.next?(v="post-refus",w=f):(v="anti-annulation",w=m):f!=null&&f.next?(v="post-refus",w=f):m!=null&&m.next?(v="anti-annulation",w=m):b!=null&&b.next?(v="prospection",w=b):(v="post-refus",w=f));let A=Math.max(((E=w==null?void 0:w.sent)==null?void 0:E.length)||0,(g==null?void 0:g.email_sequence_step)||0,e.send_count||0);e.views>0&&A===0&&(A=1),(D=e.name)!=null&&D.toUpperCase().includes("GUYOT")&&console.log(" GUYOT SELECTED FLOW:",{flowType:v,sentLength:(_=w==null?void 0:w.sent)==null?void 0:_.length,leadStep:g==null?void 0:g.email_sequence_step,studySendCount:e.send_count,finalStep:A});const T=5,S=w!=null&&w.sent&&w.sent.length>0?w.sent[w.sent.length-1]:null,y=(w==null?void 0:w.next)||null;!v&&(e.views>0||e.last_view)&&(v=e.status==="signed"?"anti-annulation":"post-refus",w={total_opens:e.views||0,sent:e.last_view?[{sent_at:e.last_view,opened_at:e.last_view}]:[],next:null,is_fallback:!0},A=Math.min(5,Math.max(1,Math.floor((e.views||0)/2))));const x=Math.min(100,Math.max(0,e.cancellationRisk||e.dangerScore||0)),j=x>80,k=e.payment_mode==="cash"||e.financing_mode==="cash_payment"||e.financing_mode==="cash",M=v==="anti-annulation"||v==="post-refus"?k?"cash":"financement":"prospection";return s.jsxs("div",{className:"group relative mb-4",children:[s.jsx("div",{className:`absolute -inset-0.5 rounded-2xl bg-gradient-to-r from-blue-500/50 to-indigo-600/50 opacity-0 blur-sm group-hover:opacity-30 transition duration-500 ${j?"from-orange-600/50 to-red-600/50 group-hover:opacity-40":""}`}),s.jsxs("div",{className:"relative backdrop-blur-xl rounded-2xl bg-slate-950/40 border border-white/5 p-6 flex flex-col lg:grid lg:grid-cols-[220px_1fr_200px_120px_auto] lg:items-center gap-6 transition-all hover:bg-slate-900/40 hover:border-white/10 shadow-lg",children:[s.jsxs("div",{className:"flex flex-col gap-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 flex-shrink-0 rounded-full bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.8)]"}),s.jsx(Io,{status:e.status}),e.status==="signed"&&s.jsx(Ce,{className:"w-3.5 h-3.5 text-emerald-400"})]}),s.jsxs("h3",{className:"text-white font-black tracking-tight text-base lg:text-lg uppercase leading-none mb-1",children:[e.name.split(" ")[0],s.jsx("br",{}),s.jsx("span",{className:"text-blue-400",children:e.name.split(" ").slice(1).join(" ")})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 font-mono truncate",children:[s.jsx("span",{className:"opacity-60 text-[10px] flex-shrink-0",children:""}),s.jsx("span",{className:"truncate",children:e.email})]}),k&&s.jsx("div",{className:"flex items-center gap-2 mt-1",children:s.jsxs("span",{className:"px-2 py-0.5 rounded text-[10px] bg-amber-500/10 border-amber-500/20 text-amber-400 font-black uppercase tracking-tighter shadow-[0_0_8px_rgba(251,191,36,0.2)]",children:["CASH ",e.has_deposit?"+ ACOMPTE":""]})}),s.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-black uppercase border ${p.class}`,children:p.label.replace(/^[^\s]+\s/,"")}),e.contract_secured&&s.jsx("span",{className:"px-2 py-0.5 bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded text-[10px] font-black uppercase flex items-center gap-1",children:" SCURIS"}),e.rib_sent&&s.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded text-[10px] font-black uppercase",children:" RIB OK"}),s.jsxs("span",{className:"px-2 py-0.5 rounded bg-slate-800/50 border border-white/5 text-[10px] font-bold text-slate-400 font-mono flex items-center gap-1",children:[" J+",e.daysSinceSigned||e.diffDays||0]})]})]}),s.jsx("div",{className:"hidden lg:flex flex-col gap-3 px-8 border-x border-white/5 min-h-[100px] justify-center",children:v?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center text-[10px] text-slate-500 font-black uppercase tracking-[0.2em]",children:[s.jsxs("span",{className:"flex items-center gap-1.5",children:[s.jsx(Pn,{className:"w-3 h-3 text-blue-400"}),"Engagement Flow"]}),s.jsxs("span",{className:"bg-blue-500/10 text-blue-400 px-2 py-0.5 rounded-full border border-blue-500/20",children:[e.views||0," VUES"]})]}),s.jsx("div",{className:"h-2 w-full bg-slate-800/50 rounded-full overflow-hidden flex gap-1.5 p-[2px] border border-white/5",children:[1,2,3,4,5].map(C=>s.jsx("div",{className:`h-full flex-1 rounded-sm transition-all duration-700 ${C<=A?"bg-gradient-to-r from-blue-600 to-indigo-500 shadow-[0_0_12px_rgba(59,130,246,0.4)]":"bg-slate-700/50"}`},C))}),s.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-slate-600 tracking-widest uppercase",children:[s.jsx("span",{children:"Squence Auto"}),s.jsxs("span",{children:[A,"/",T," Envoys"]})]}),s.jsxs("div",{className:`flex flex-col gap-2 p-3 rounded-lg border mt-1 ${v==="anti-annulation"?"bg-emerald-500/5 border-emerald-500/20 shadow-[0_4px_12px_rgba(16,185,129,0.1)]":v==="post-refus"?"bg-red-500/5 border-red-500/20 shadow-[0_4px_12px_rgba(239,68,68,0.1)]":"bg-blue-500/5 border-blue-500/20 shadow-[0_4px_12px_rgba(59,130,246,0.1)]"}`,children:[s.jsx("div",{className:`flex items-center gap-2 text-[10px] font-black uppercase tracking-widest ${v==="anti-annulation"?"text-emerald-400":v==="post-refus"?"text-red-400":"text-blue-400"}`,children:v==="anti-annulation"?` ANTI-ANNULATION ${M.toUpperCase()}`:v==="post-refus"?` POST-REFUS ${M.toUpperCase()}`:" PROSPECTION"}),S?s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsxs("div",{className:"flex justify-between items-center text-[9px]",children:[s.jsx("span",{className:"text-slate-600 font-bold",children:"Dernier :"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:`font-mono font-bold ${v==="anti-annulation"?"text-emerald-400":v==="post-refus"?"text-red-400":"text-blue-400"}`,children:["j",[0,1,3,7,14][A-1]||0," ",M]}),s.jsxs("span",{className:"text-slate-500 font-mono",children:["(",new Date(S.sent_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"}),")"]})]})]}),s.jsxs("div",{className:"flex justify-between items-center text-[9px]",children:[s.jsx("span",{className:"text-slate-700 font-bold",children:"Ouvertures :"}),s.jsxs("div",{className:"flex items-center gap-2",children:[S.opened_at&&s.jsxs("span",{className:"text-[8px] text-slate-500 font-mono",children:["Lu le: ",new Date(S.opened_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"}),"  ",new Date(S.opened_at).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]}),s.jsxs("span",{className:`font-mono font-bold px-1.5 py-0.5 rounded ${w.total_opens>0?v==="anti-annulation"?"bg-emerald-500/10 text-emerald-400":v==="post-refus"?"bg-red-500/10 text-red-400":"bg-blue-500/10 text-blue-400":"bg-slate-800 text-slate-600"}`,children:[w.total_opens||0,"x"]})]})]})]}):s.jsx("div",{className:"text-[10px] text-slate-500 italic py-1",children:" En attente du premier envoi..."}),A<T&&s.jsx("div",{className:"flex flex-col gap-1.5 border-t border-white/5 pt-2 mt-1",children:s.jsxs("div",{className:"flex justify-between items-center text-[9px]",children:[s.jsx("span",{className:"text-slate-600 font-bold",children:"Prochain :"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-orange-400 font-mono font-bold",children:["j",[0,1,3,7,14][A]||"?"," ",M]}),y?s.jsxs("span",{className:"text-orange-400/60 font-mono",children:[" ",new Date(y.scheduled_for).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})]}):s.jsx("span",{className:"text-slate-500/50 font-mono text-[8px] uppercase tracking-wider border border-slate-700/30 px-1.5 py-0.5 rounded",children:"Non planifi"})]})]})}),A>=T&&s.jsx("div",{className:`flex items-center justify-center gap-1 rounded-md px-2 py-1.5 border mt-1 font-black text-[8px] uppercase tracking-widest ${v==="anti-annulation"?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":v==="post-refus"?"bg-red-500/10 border-red-500/30 text-red-400":"bg-blue-500/10 border-blue-500/30 text-blue-400"}`,children:" SQUENCE TERMINE"})]})]}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"text-[10px] text-slate-600 font-black uppercase tracking-widest mb-1 opacity-50",children:"Engagement Flow"}),s.jsx("div",{className:"text-xs text-slate-500 italic",children:"Aucune squence active dtecte"})]})}),s.jsxs("div",{className:"flex flex-col items-end justify-center h-full min-w-[180px] gap-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[s.jsx("span",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-[0.2em]",children:"VALEUR DOSSIER"}),e.financing_mode&&s.jsx("span",{className:`text-[8px] px-1.5 py-0.5 rounded-md border font-black tracking-widest ${e.financing_mode==="cash_payment"?"bg-indigo-500/10 border-indigo-500/30 text-indigo-400":"bg-blue-500/10 border-blue-500/30 text-blue-400"}`,children:e.financing_mode==="cash_payment"?"COMPTANT":"FINANC"})]}),s.jsx("div",{className:"text-3xl font-black text-white tracking-tighter mb-1 select-none",children:ls(e.total_price)}),s.jsxs("div",{className:"flex flex-col items-end gap-1.5 w-full",children:[e.cash_apport>0&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-yellow-500/5 border border-yellow-500/10 w-full justify-end",children:[s.jsx(Uo,{className:"w-3 h-3 text-yellow-500/70"}),s.jsxs("span",{className:"text-[9px] font-black text-yellow-500/90 font-mono tracking-tight uppercase",children:["APPORT: ",ls(e.cash_apport)]})]}),e.status==="signed"&&e.has_deposit&&s.jsx("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border text-[9px] font-black uppercase w-full justify-end
                ${e.deposit_paid?"bg-emerald-500/5 border-emerald-500/10 text-emerald-400/80":"bg-orange-500/5 border-orange-500/10 text-orange-400/80"}`,children:e.deposit_paid?" Rglement Acompte":` Acompte: ${ls(e.deposit_amount||1500)}`})]})]}),s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 px-8 border-l border-white/5 h-full min-w-[160px]",children:[s.jsxs("div",{className:"relative w-16 h-16 flex-shrink-0 group/gauge",children:[s.jsxs("svg",{className:"w-full h-full -rotate-90 transform",viewBox:"0 0 36 36",children:[s.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-slate-800/60",strokeWidth:"2"}),s.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:`${j?"stroke-orange-500":"stroke-blue-500"} transition-all duration-1000 ease-out`,strokeWidth:"2",strokeDasharray:`${x}, 100`,strokeLinecap:"round",stroke:"currentColor"})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("span",{className:"text-sm font-black text-white font-mono tracking-tighter",children:[x,"%"]})})]}),s.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[s.jsx("span",{className:"text-[8px] text-slate-600 font-black uppercase tracking-[0.3em]",children:"RISQUE"}),s.jsx("div",{className:`px-4 py-1 rounded-lg border ${p.class} uppercase text-[10px] font-black tracking-[0.15em] shadow-lg whitespace-nowrap`,children:p.label.replace(/^[^\s]+\s/,"")})]})]}),c&&s.jsxs("div",{className:"flex flex-row lg:flex-col gap-2 border-l border-white/5 pl-4 ml-4",children:[s.jsx("button",{onClick:()=>{const C=typeof window<"u"?window.location.origin:"";C?window.open(`${C}/guest/${e.id}`,"_blank"):console.error(" Impossible d'ouvrir l'tude : URL de base introuvable")},className:"p-2.5 rounded-xl bg-white/5 border border-white/10 text-slate-400 hover:text-white hover:bg-white/10 transition-all active:scale-95",title:"Voir Document",children:s.jsx(Pn,{className:"w-4 h-4"})}),s.jsxs("button",{onClick:()=>{e.phone?window.location.href=`tel:${e.phone}`:alert("Numro de tlphone non renseign")},className:"flex items-center gap-2 px-3 py-2 rounded-xl bg-blue-600/20 border border-blue-500/30 text-blue-400 hover:bg-blue-600/30 hover:text-blue-300 transition-all active:scale-95 shadow-lg shadow-blue-900/20",title:"Appeler Client",children:[s.jsx("span",{className:"text-sm",children:""}),s.jsx("span",{className:"text-[10px] font-black uppercase tracking-tight",children:"Appeler"})]}),e.status!=="signed"&&e.status!=="cancelled"&&i&&s.jsxs("button",{onClick:()=>i(e.id,e.name),className:"group/sign relative p-2.5 rounded-xl bg-gradient-to-br from-emerald-600/20 to-emerald-500/10 border border-emerald-500/40 text-emerald-400 hover:from-emerald-600/30 hover:to-emerald-500/20 hover:text-emerald-300 hover:border-emerald-400/60 transition-all active:scale-95 shadow-lg shadow-emerald-900/30 hover:shadow-emerald-900/50",title:"Signer le Dossier",children:[s.jsx("div",{className:"absolute inset-0 rounded-xl bg-emerald-500/20 blur-md opacity-0 group-hover/sign:opacity-100 transition-opacity duration-300"}),s.jsx("span",{className:"relative text-base",children:""})]}),e.status!=="cancelled"&&r&&s.jsxs("button",{onClick:()=>r(e.id,e.name),className:"group/cancel relative p-2.5 rounded-xl bg-gradient-to-br from-red-600/20 to-red-500/10 border border-red-500/40 text-red-400 hover:from-red-600/30 hover:to-red-500/20 hover:text-red-300 hover:border-red-400/60 transition-all active:scale-95 shadow-lg shadow-red-900/30 hover:shadow-red-900/50",title:"Annuler l'tude",children:[s.jsx("div",{className:"absolute inset-0 rounded-xl bg-red-500/20 blur-md opacity-0 group-hover/cancel:opacity-100 transition-opacity duration-300"}),s.jsx("span",{className:"relative text-base",children:""})]}),e.status==="signed"&&e.has_deposit&&!e.deposit_paid&&o&&s.jsxs("button",{onClick:()=>o(e.id,e.name),className:"group/deposit relative p-2.5 rounded-xl bg-gradient-to-br from-green-600/20 to-green-500/10 border border-green-500/40 text-green-400 hover:from-green-600/30 hover:to-green-500/20 hover:text-green-300 hover:border-green-400/60 transition-all active:scale-95 shadow-lg shadow-green-900/30 hover:shadow-green-900/50",title:"Marquer Acompte Pay",children:[s.jsx("div",{className:"absolute inset-0 rounded-xl bg-green-500/20 blur-md opacity-0 group-hover/deposit:opacity-100 transition-opacity duration-300"}),s.jsx("span",{className:"relative text-base",children:""})]})]})]})]})},Nm=({studies:e,filters:t,emailFlowByClient:n,antiAnnulationByStudy:i,postRefusByStudy:r,leads:a,onSignStudy:o,onCancelStudy:l,onDeleteStudy:c})=>{let d=e.filter(u=>{var p,h;if(u.status==="signed")return!1;if(t.search){const m=t.search.toLowerCase(),f=((p=u.name)==null?void 0:p.toLowerCase())||"",g=((h=u.email)==null?void 0:h.toLowerCase())||"";if(!f.includes(m)&&!g.includes(m))return!1}return!(t.views==="5+"&&u.views<5||t.clicks==="1+"&&u.clicks<1||t.status&&u.status!==t.status||t.optout&&!u.email_optout)});return d=d.sort((u,p)=>{const h={hot:0,warm:1,cold:2,signed:3},m=_n(u),f=_n(p);return h[m]-h[f]}),s.jsx("div",{className:"mb-8",children:d.length===0?s.jsxs("div",{className:"p-8 bg-slate-800/30 border border-slate-700/50 rounded-2xl text-center",children:[s.jsx("div",{className:"text-4xl mb-3",children:""}),s.jsx("div",{className:"text-lg font-bold text-slate-400",children:"Aucun dossier trouv"}),s.jsx("div",{className:"text-sm text-slate-500 mt-2",children:"Ajustez vos filtres ou critres de recherche"})]}):s.jsx("div",{className:"space-y-3",children:d.map(u=>s.jsx(io,{study:u,antiAnnulationByStudy:i,postRefusByStudy:r,leads:a,onSignStudy:o,onCancelStudy:l,onDeleteStudy:c},u.id))})})},km=({studies:e,metrics:t,filters:n,antiAnnulationByStudy:i,postRefusByStudy:r,leads:a,onSignStudy:o,onMarkDepositPaid:l,onMarkRibSent:c,onCancelStudy:d,onDeleteStudy:u})=>{const m=t.signed.filter(g=>{if(n.search){const b=n.search.toLowerCase();if(!g.name.toLowerCase().includes(b)&&!g.email.toLowerCase().includes(b))return!1}return!(n.views==="5+"&&(g.views||0)<5||n.clicks==="1+"&&(g.clicks||0)<1||n.optout&&!g.email_optout)}).sort((g,b)=>{var A,T;if((A=g.name)!=null&&A.toUpperCase().includes("GUYOT"))return-1;if((T=b.name)!=null&&T.toUpperCase().includes("GUYOT"))return 1;const v=g.daysLate||0;return(b.daysLate||0)-v}),f=m.filter(g=>g.requiresDeposit&&!g.deposit_paid&&g.financing_mode!=="full_financing").length;return s.jsxs("div",{id:"late-deposits-section",className:"mb-8",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:"AXE A  DOSSIERS SIGNS (HISTORIQUE)"}),s.jsxs("div",{className:"text-sm text-slate-400",children:[m.length," dossiers au total "," ",s.jsxs("span",{className:`${f>0?"text-red-400":"text-emerald-400"} font-bold`,children:[f," en attente d'acompte"]})]})]})]})}),m.length===0?s.jsxs("div",{className:"p-8 bg-slate-800/30 border border-slate-700/50 rounded-2xl text-center",children:[s.jsx("div",{className:"text-4xl mb-3",children:""}),s.jsx("div",{className:"text-lg font-bold text-emerald-400",children:"Tous les acomptes sont  jour !"}),s.jsx("div",{className:"text-sm text-slate-500 mt-2",children:"Aucun retard hors War Room"})]}):s.jsx("div",{className:"space-y-3",children:m.map(g=>s.jsx(io,{study:g,antiAnnulationByStudy:i,postRefusByStudy:r,leads:a,onMarkDepositPaid:l,onMarkRibSent:c,onCancelStudy:d,onDeleteStudy:u},g.id))})]})},Be={clicked:"#3DDC97",opened:"#7CA3BA",sentNeg:"#2A3142"},Sm=({data:e,width:t,height:n})=>{const{showTooltip:i,hideTooltip:r,tooltipData:a,tooltipLeft:o,tooltipTop:l}=dr(),c={top:15,bottom:25,left:10,right:10},d=t-c.left-c.right,u=n-c.top-c.bottom,p=e.map(f=>({date:f.date,originalTotal:f.count,originalOpened:f.opened||0,originalClicked:f.clicked||0})),h=Fs({range:[0,d],round:!0,domain:p.map(f=>f.date),padding:.4}),m=ue({range:[u,0],round:!0,domain:[0,Math.max(...e.flatMap(f=>[f.count,f.opened||0,f.clicked||0]))||10]});return s.jsxs("div",{className:"relative",children:[s.jsx("svg",{width:t,height:n,children:s.jsxs(U,{top:c.top,left:c.left,children:[p.map(f=>{const g=h.bandwidth(),b=h(f.date)||0,v=1,w=(g-v*2)/3,A=u-m(f.originalTotal),T=u-m(f.originalOpened),S=u-m(f.originalClicked);return s.jsxs(U,{left:b,children:[s.jsx("rect",{x:0,y:u-A,width:w,height:A,fill:Be.sentNeg,rx:2,opacity:.8,onMouseMove:y=>{const x=wt(y)||{x:0,y:0};i({tooltipData:f,tooltipLeft:x.x,tooltipTop:x.y})},onMouseLeave:()=>r(),style:{cursor:"pointer"}}),s.jsx("rect",{x:w+v,y:u-T,width:w,height:T,fill:Be.opened,rx:2,opacity:.9,style:{filter:"drop-shadow(0 0 3px rgba(124,163,186,0.3))",cursor:"pointer"},onMouseMove:y=>{const x=wt(y)||{x:0,y:0};i({tooltipData:f,tooltipLeft:x.x,tooltipTop:x.y})},onMouseLeave:()=>r()}),s.jsx("rect",{x:(w+v)*2,y:u-S,width:w,height:S,fill:Be.clicked,rx:2,opacity:1,style:{filter:"drop-shadow(0 0 4px rgba(61,220,151,0.4))",cursor:"pointer"},onMouseMove:y=>{const x=wt(y)||{x:0,y:0};i({tooltipData:f,tooltipLeft:x.x,tooltipTop:x.y})},onMouseLeave:()=>r()})]},`bar-group-${f.date}`)}),s.jsx(Ue,{top:u,scale:h,stroke:"rgba(255,255,255,0.1)",tickStroke:"rgba(255,255,255,0.1)",tickLabelProps:()=>({fill:"#ffffff",fontSize:10,opacity:.5,textAnchor:"middle",fontFamily:"sans-serif",fontWeight:500}),tickFormat:f=>new Date(f).toLocaleDateString("fr-FR",{day:"numeric",month:"numeric"})})]})}),a&&s.jsx(ur,{top:l,left:o,style:{...hr,background:"rgba(15, 23, 42, 0.95)",border:"1px solid rgba(255, 255, 255, 0.1)",padding:"12px",color:"white",borderRadius:"12px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.5)",fontSize:"11px",backdropFilter:"blur(8px)",pointerEvents:"none"},children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("div",{className:"font-bold text-slate-400 uppercase tracking-widest text-[9px] mb-1",children:new Date(a.date).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})}),s.jsxs("div",{className:"flex justify-between gap-4",children:[s.jsx("span",{className:"text-slate-500 font-bold uppercase",children:"Emails Envoys"}),s.jsx("span",{className:"font-mono text-white",children:a.originalTotal})]}),s.jsxs("div",{className:"flex justify-between gap-4",children:[s.jsx("span",{className:"text-indigo-400 font-bold uppercase",children:"Emails Ouverts"}),s.jsx("span",{className:"font-mono text-white",children:a.originalOpened})]}),s.jsxs("div",{className:"flex justify-between gap-4",children:[s.jsx("span",{className:"text-[#3DDC97] font-bold uppercase",children:"Emails Cliqus"}),s.jsx("span",{className:"font-mono text-white font-bold",children:a.originalClicked})]})]})},Math.random())]})},Am=({data:e})=>!e||e.length===0?null:s.jsxs("div",{className:"w-full h-48 rounded-2xl p-6 border flex flex-col justify-between backdrop-blur-xl",style:{background:"rgba(255,255,255,0.03)",borderColor:"rgba(255,255,255,0.08)",boxShadow:"0 8px 32px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.03)"},children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[11px] uppercase tracking-widest text-white/50 font-black mb-1",children:"Pression d'envoi (14 jours)"}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),s.jsx("span",{className:"text-[10px] text-indigo-200 font-bold uppercase",children:"Activit Totale"})]})})]}),s.jsxs("div",{className:"flex items-center gap-4 bg-white/5 px-3 py-1.5 rounded-lg border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-sm",style:{background:Be.sentNeg,opacity:.8}}),s.jsx("span",{className:"text-[9px] text-white/40 font-bold uppercase tracking-wider",children:"Envoys"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-sm",style:{background:Be.opened,opacity:.9}}),s.jsx("span",{className:"text-[9px] text-white/50 font-bold uppercase tracking-wider",children:"Ouverts"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-sm",style:{background:Be.clicked,opacity:.95}}),s.jsx("span",{className:"text-[9px] text-[#3DDC97] font-bold uppercase tracking-wider",children:"Cliqus"})]})]})]}),s.jsx("div",{className:"w-full h-32 relative",children:s.jsx(ze,{children:({width:t,height:n})=>s.jsx(Sm,{data:e,width:t,height:n})})})]}),Tm=({leads:e,trafficData:t,globalFilters:n,onSetOptOut:i,onDeleteLead:r})=>{const[a,o]=N.useState({search:"",today:!1,optedOut:!1});let l=e.filter(c=>{const d=((n==null?void 0:n.search)||a.search).toLowerCase();if(d&&!c.client_name.toLowerCase().includes(d)&&!c.client_email.toLowerCase().includes(d))return!1;if(a.today&&c.next_email_date){const u=new Date().toDateString(),p=new Date(c.next_email_date).toDateString();if(u!==p)return!1}return!(a.optedOut&&!c.opted_out)});return l=l.sort((c,d)=>c.next_email_date?d.next_email_date?new Date(c.next_email_date).getTime()-new Date(d.next_email_date).getTime():-1:1),s.jsxs("div",{className:"mb-8",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:"AXE C  LEADS EMAIL (AUTOMATISATION)"}),s.jsxs("div",{className:"text-sm text-slate-400",children:[l.length," lead",l.length>1?"s":""," en nurturing"]})]})]})}),s.jsx("div",{className:"mb-8",children:s.jsx(Am,{data:t})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-6",children:[s.jsx("input",{type:"text",placeholder:" Rechercher un lead...",value:a.search,onChange:c=>o({...a,search:c.target.value}),className:"flex-1 min-w-[200px] px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:border-blue-500 focus:outline-none"}),s.jsx("button",{onClick:()=>o({...a,today:!a.today}),className:`px-4 py-2 rounded-lg font-bold text-sm transition-all ${a.today?"bg-green-600 text-white shadow-lg":"bg-slate-800/50 text-slate-400 hover:bg-slate-700 border border-slate-700/30"}`,children:" Aujourd'hui"}),s.jsx("button",{onClick:()=>o({...a,optedOut:!a.optedOut}),className:`px-4 py-2 rounded-lg font-bold text-sm transition-all ${a.optedOut?"bg-red-600 text-white shadow-lg":"bg-slate-800/50 text-slate-400 hover:bg-slate-700 border border-slate-700/30"}`,children:" Dsabonns"}),(a.search||a.today||a.optedOut)&&s.jsx("button",{onClick:()=>o({search:"",today:!1,optedOut:!1}),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-bold text-sm transition-colors",children:" Reset"})]}),l.length===0?s.jsxs("div",{className:"p-8 bg-slate-800/30 border border-slate-700/50 rounded-2xl text-center",children:[s.jsx("div",{className:"text-4xl mb-3",children:""}),s.jsx("div",{className:"text-lg font-bold text-slate-400",children:"Aucun lead trouv"})]}):s.jsx("div",{className:"space-y-3",children:l.map(c=>{const d=wm(c),u=c.next_email_date&&new Date(c.next_email_date).toDateString()===new Date().toDateString();return s.jsx("div",{className:`rounded-xl p-5 border-2 transition-all ${c.opted_out?"bg-red-500/10 border-red-500/50":u?"bg-green-500/10 border-green-500/50":"bg-slate-800/50 border-slate-700/50 hover:bg-slate-800/70"}`,children:s.jsxs("div",{className:"grid grid-cols-[2fr_minmax(180px,1.2fr)_1.2fr_auto] gap-4 items-center",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"flex items-center gap-3 mb-1",children:s.jsx("div",{className:"text-2xl font-black text-white uppercase tracking-tight leading-none",children:c.client_name})}),s.jsx("div",{className:"text-sm text-slate-400 font-medium ml-0.5",children:c.client_email})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsxs("span",{className:"px-2 py-0.5 bg-blue-900/40 border border-blue-500/30 text-blue-300 rounded text-[10px] font-bold uppercase flex items-center gap-1",children:[s.jsx("span",{children:""})," TAPE ",c.email_sequence_step]}),c.opted_out&&s.jsx("span",{className:"px-2 py-0.5 bg-red-500/20 text-red-400 border border-red-500/30 rounded text-[10px] font-bold uppercase",children:" DSABONN"})]})]}),s.jsx("div",{children:s.jsxs("div",{className:"pl-4 border-l border-white/5",children:[s.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1",children:"Engagement"}),s.jsxs("div",{className:"flex items-end gap-3 mb-2",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-2xl font-black text-white leading-none",children:c.total_opens}),s.jsx("span",{className:"text-[10px] text-slate-500 uppercase font-bold",children:"Ouvertures"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-2xl font-black text-white leading-none",children:c.total_clicks}),s.jsx("span",{className:"text-[10px] text-slate-500 uppercase font-bold",children:"Clics"})]})]})]})}),s.jsx("div",{children:s.jsxs("div",{className:"pl-4 border-l border-white/5 space-y-2",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Prochaine relance"}),(()=>{let p=!1;if(d!=="Immdiat"&&d!=="Termin"){const[h,m,f]=d.split("/");if(h&&m&&f){const g=new Date(parseInt(f),parseInt(m)-1,parseInt(h)),b=new Date;b.setHours(0,0,0,0),g<b&&(p=!0)}}return s.jsx("div",{className:`text-sm font-bold ${p?"text-red-400 animate-pulse":d==="Immdiat"||u?"text-green-400":"text-white"}`,children:p?` RETARD (${d})`:d==="Immdiat"?" Immdiat":d})})()]}),c.last_email_sent?s.jsxs("div",{className:"text-xs font-bold text-slate-400 flex items-center gap-1.5 mt-1",children:[s.jsx("span",{children:""})," Email envoy le"," ",new Date(c.last_email_sent).toLocaleDateString("fr-FR")]}):s.jsx("div",{className:"text-[10px] font-medium text-slate-600 italic mt-1",children:" Aucun envoi"})]})}),s.jsxs("div",{className:"flex flex-col gap-2 pl-4 border-l border-transparent",children:[!c.opted_out&&s.jsx("button",{onClick:()=>{confirm(`Dsabonner ${c.client_name} ?`)&&i(c.client_email)},className:"w-full h-10 bg-red-600/20 hover:bg-red-600 text-red-500 hover:text-white border border-red-500/30 rounded-lg font-bold text-xs uppercase tracking-wide transition-all flex items-center justify-center gap-2",children:" Opt-out"}),s.jsx("button",{onClick:()=>{confirm(`Supprimer dfinitivement ${c.client_name} ?`)&&r(c.client_id,c.client_email,c.client_name)},className:"w-full h-9 bg-slate-800 hover:bg-slate-700 text-slate-400 hover:text-white border border-slate-700 rounded-lg font-bold text-[10px] uppercase tracking-wide transition-all flex items-center justify-center gap-2",children:" Supprimer"})]})]})},c.id)})})]})},Cm=({system:e})=>{const{studies:t,metrics:n,emailLeads:i,trafficData:r,antiAnnulationByStudy:a,postRefusByStudy:o,emailFlowByClient:l,actions:{signStudy:c,cancelStudy:d,deleteStudy:u,markDepositPaid:p,markRibSent:h,setOptOut:m,deleteLeadPermanently:f}}=e,[g,b]=N.useState({search:"",views:null,clicks:null,status:null,optout:!1});return s.jsxs("div",{className:"space-y-12",children:[s.jsx("div",{className:"flex items-center justify-between mb-8",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-wider",children:"Registres & Data"}),s.jsx("div",{className:"text-sm text-emerald-400 font-medium",children:"Historique complet et gestion du pipeline"})]})]})}),s.jsx(ym,{filters:g,onFilterChange:b}),s.jsx(km,{studies:t,metrics:n,filters:g,antiAnnulationByStudy:a,postRefusByStudy:o,leads:i,onSignStudy:c,onMarkDepositPaid:p,onMarkRibSent:h,onCancelStudy:d,onDeleteStudy:u}),s.jsxs("div",{className:"mt-16",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:"AXE B  PIPELINE (WARM & HOT)"}),s.jsx("div",{className:"text-sm text-slate-400",children:"Focus: Conversion & Momentum"})]})]}),s.jsx(Nm,{studies:t,filters:g,emailFlowByClient:l,antiAnnulationByStudy:a,postRefusByStudy:o,leads:i,onSignStudy:c,onCancelStudy:d,onDeleteStudy:u})]}),s.jsx("div",{className:"mt-16",children:s.jsx(Tm,{leads:i.filter(v=>!t.some(w=>w.client_id===v.client_id)),trafficData:r,globalFilters:g,onSetOptOut:m,onDeleteLead:f})})]})},Mm=({logs:e,zenMode:t})=>{if(t)return null;const[n,i]=N.useState(!1),r=n?e:e.slice(0,10);return s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white",children:"LOGS DE DCISIONS"}),s.jsxs("div",{className:"text-sm text-slate-400",children:[e.length," action",e.length>1?"s":""," enregistre",e.length>1?"s":""]})]})]}),e.length>10&&s.jsx("button",{onClick:()=>i(!n),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-bold text-sm transition-colors",children:n?" Rduire":` Voir tous (${e.length})`})]}),e.length===0?s.jsxs("div",{className:"p-8 bg-slate-800/30 border border-slate-700/50 rounded-2xl text-center",children:[s.jsx("div",{className:"text-4xl mb-3",children:""}),s.jsx("div",{className:"text-lg font-bold text-slate-400",children:"Aucune action enregistre"}),s.jsx("div",{className:"text-sm text-slate-500 mt-2",children:"Les dcisions apparatront ici"})]}):s.jsx("div",{className:"space-y-2",children:r.map(a=>{const o=new Date().getTime()-new Date(a.created_at).getTime()<36e5;return s.jsx("div",{className:`p-4 rounded-xl border transition-all ${o?"glass-panel bg-blue-500/10 border-blue-500/30 shadow-[0_0_15px_rgba(59,130,246,0.1)]":"glass-panel border-white/5 hover:border-white/10"}`,children:s.jsx("div",{className:"flex items-start justify-between gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"text-lg font-bold text-white",children:a.client_name}),s.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded text-xs font-bold",children:a.action_performed})]}),s.jsx("p",{className:"text-sm text-slate-400 mb-1",children:a.justification}),s.jsx("div",{className:"text-xs text-slate-500",children:jm(a.created_at)})]})})},a.id)})})]})},Rm=({system:e})=>{const{logs:t,zenMode:n}=e;return s.jsxs("div",{className:"space-y-12",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-wider",children:"Systme & Logs"}),s.jsx("div",{className:"text-sm text-slate-400 font-medium",children:"Diagnostic, activits en temps rel et tat du Brain"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsx(Mm,{logs:t,zenMode:n})}),s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"glass-panel p-6 rounded-2xl border border-white/5",children:[s.jsx("h3",{className:"text-blue-400 font-bold mb-4 uppercase text-xs tracking-widest",children:"tat du Cerveau"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center text-sm",children:[s.jsx("span",{className:"text-slate-400",children:"Version Architecture"}),s.jsx("span",{className:"text-white font-mono",children:"v2.0 (Cockpit)"})]}),s.jsxs("div",{className:"flex justify-between items-center text-sm",children:[s.jsx("span",{className:"text-slate-400",children:"Mode Synchronisation"}),s.jsx("span",{className:"text-emerald-400 font-mono",children:"Real-time"})]}),s.jsxs("div",{className:"flex justify-between items-center text-sm",children:[s.jsx("span",{className:"text-slate-400",children:"Latence Brain"}),s.jsx("span",{className:"text-white font-mono",children:"12ms"})]})]})]})})]})]})},Ee=({active:e,onClick:t,icon:n,label:i})=>s.jsxs("button",{onClick:t,className:`
      flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all
      ${e?"bg-blue-600 text-white shadow-lg shadow-blue-500/25":"text-slate-400 hover:text-white hover:bg-white/5"}
    `,children:[s.jsx("span",{children:n}),s.jsx("span",{className:"hidden md:inline",children:i})]}),Em=({zenMode:e,priorityMode:t,onToggleZenMode:n,onTogglePriorityMode:i,onRefresh:r,lastRefresh:a,systemStatus:o="normal",totalStudies:l=0,totalClients:c=0,signedClients:d=0,unsubscribedCount:u=0,unsubscribeRate:p=0,activeSection:h,setActiveSection:m,globalDateFilter:f="current_month",onSetDateFilter:g})=>{const b=c>0?Math.round(d/c*100):0,v={normal:"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]",active:"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",warning:"bg-orange-500 shadow-[0_0_8px_rgba(245,158,11,0.5)] animate-pulse",critical:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)] animate-ping"},w=Lo();return s.jsx("header",{className:"fixed top-2 left-2 right-2 z-50",children:s.jsxs("div",{className:"glass-panel rounded-2xl px-2 md:px-4 h-14 border border-white/10 shadow-2xl relative overflow-visible flex items-center justify-between gap-4",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-blue-500/30 to-transparent"}),s.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-14 h-14 flex items-center justify-center -ml-2",children:s.jsx("img",{src:"/img/revenue-sentinel-logo.png",alt:"Revenue Sentinel",className:"w-full h-full object-contain drop-shadow-[0_0_8px_rgba(59,130,246,0.3)]"})}),s.jsxs("div",{className:"hidden xl:block",children:[s.jsxs("h1",{className:"text-lg font-black text-white tracking-widest leading-none whitespace-nowrap",children:["REVENUE ",s.jsx("span",{className:"text-blue-400",children:"SENTINEL"})]}),s.jsxs("div",{className:"text-[9px] text-zinc-500 font-bold uppercase tracking-tight mt-0.5 truncate",children:["Clients: ",c," ",s.jsx("span",{className:"mx-0.5 opacity-30",children:""})," Dossiers: ",l]})]})]}),s.jsxs("div",{className:"hidden lg:flex items-center gap-3 pl-4 border-l border-white/5 overflow-hidden whitespace-nowrap",children:[s.jsx("div",{className:"flex flex-col",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsxs("span",{className:"text-xs font-black text-white",children:[b,"%"]}),s.jsx("div",{className:"w-6 h-1 bg-white/5 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${b}%`}})})]})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[8px] text-emerald-500/70 font-black uppercase leading-none",children:"Signs"}),s.jsx("span",{className:"text-xs font-black text-emerald-400",children:d})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[8px] text-red-500/70 font-black uppercase leading-none",children:"Dsab."}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-xs font-black text-red-400",children:u}),s.jsxs("span",{className:"text-[8px] text-red-500/40 font-bold",children:[p.toFixed(0),"%"]})]})]})]})]}),s.jsx("div",{className:"flex justify-center flex-1 min-w-0 overflow-x-auto no-scrollbar px-2",children:s.jsxs("div",{className:"flex items-center gap-1 bg-black/40 p-1 rounded-xl border border-white/5 shadow-inner backdrop-blur-md whitespace-nowrap",children:[s.jsx(Ee,{active:h==="cockpit"||h==="dashboard",onClick:()=>m("cockpit"),icon:"",label:"Cockpit"}),s.jsx(Ee,{active:h==="war_room",onClick:()=>m("war_room"),icon:"",label:"War Room"}),s.jsx(Ee,{active:h==="pilotage",onClick:()=>m("pilotage"),icon:"",label:"Pilotage"}),s.jsx(Ee,{active:h==="sales",onClick:()=>m("sales"),icon:"",label:"Vente"}),s.jsx(Ee,{active:h==="roi",onClick:()=>m("roi"),icon:"",label:"ROI"}),s.jsx(Ee,{active:h==="registry",onClick:()=>m("registry"),icon:"",label:"Registre"})]})}),s.jsxs("div",{className:"flex items-center justify-end gap-2 flex-shrink-0",children:[a&&s.jsxs("div",{className:"hidden 2xl:flex items-center gap-2 px-2 py-1 rounded-lg bg-black/20 border border-white/5 whitespace-nowrap",children:[s.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${v[o]||v.normal}`}),s.jsx("div",{className:"text-[9px] text-slate-500 font-mono font-bold",children:a.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),s.jsxs("div",{className:"hidden md:flex bg-black/40 p-0.5 rounded-lg border border-white/10",children:[s.jsx("button",{onClick:()=>g==null?void 0:g("current_month"),className:`px-2 py-1 rounded-md text-[9px] font-black uppercase tracking-wider transition-all ${f==="current_month"?"bg-emerald-500 text-white shadow-lg shadow-emerald-500/20":"text-slate-500 hover:text-slate-300"}`,children:"Mois"}),s.jsx("button",{onClick:()=>g==null?void 0:g("all_time"),className:`px-2 py-1 rounded-md text-[9px] font-black uppercase tracking-wider transition-all ${f==="all_time"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-slate-300"}`,children:"Tout"})]}),s.jsx("div",{className:"hidden sm:block h-4 w-px bg-white/10 mx-1"}),s.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[s.jsx("button",{onClick:i,className:`h-7 px-2 rounded-lg font-black text-[9px] uppercase tracking-wider transition-all flex items-center gap-1.5 ${t?"bg-orange-600 text-white shadow-lg shadow-orange-600/20":"bg-white/5 text-slate-500 hover:text-slate-300"}`,children:s.jsx("span",{children:""})}),s.jsx("button",{onClick:n,className:`h-7 px-2 rounded-lg font-black text-[9px] uppercase tracking-wider transition-all flex items-center gap-1.5 ${e?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"bg-white/5 text-slate-500 hover:text-slate-300"}`,children:s.jsx("span",{children:""})})]}),s.jsx("button",{onClick:()=>w("/admin"),className:"w-auto h-7 px-2 rounded-full border border-white/10 flex items-center justify-center bg-slate-900 ml-1 hover:bg-slate-800 hover:border-orange-500/50 hover:text-orange-500 transition-all cursor-pointer group",children:s.jsx("span",{className:"text-[9px] font-black text-slate-400 group-hover:text-orange-500 transition-colors",children:"ADMIN"})})]})]})})},Dm=({progress:e,step:t})=>{const n=[{id:1,label:"Connexion",threshold:15},{id:2,label:"Chargement",threshold:35},{id:3,label:"Analyse",threshold:60},{id:4,label:"Calcul",threshold:85}];return s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#020617] flex items-center justify-center overflow-hidden",children:[s.jsx("style",{children:`
  @keyframes scan-line {
    0% { transform: translateY(-100%); }
    100% { transform: translateY(100%); }
  }
  .scan-overlay {
    background: linear-gradient(to bottom, transparent, rgba(59, 130, 246, 0.1), transparent);
    animation: scan-line 3s linear infinite;
  }
`}),s.jsx("div",{className:"absolute inset-0 scan-overlay pointer-events-none"}),s.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden",children:[s.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-blue-600/10 rounded-full blur-[120px] animate-pulse-soft"}),s.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-purple-600/10 rounded-full blur-[120px] animate-pulse-soft",style:{animationDelay:"1s"}})]}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-10 p-12 w-full max-w-3xl",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-32 h-32 glass-panel rounded-3xl flex items-center justify-center shadow-[0_0_40px_rgba(59,130,246,0.3)] bg-black/40 border border-white/10",children:s.jsx("img",{src:"/img/revenue-sentinel-logo.png",alt:"Revenue Sentinel",className:"w-20 h-20 object-contain drop-shadow-[0_0_15px_rgba(59,130,246,0.8)] animate-pulse-slow"})}),s.jsx("div",{className:"absolute inset-0 rounded-3xl border border-blue-500/30 animate-ping",style:{animationDuration:"3s"}})]}),s.jsxs("div",{className:"text-center space-y-2",children:[s.jsxs("h1",{className:"text-4xl font-black text-white tracking-tight neon-text-blue flex items-center gap-3",children:["REVENUE ",s.jsx("span",{className:"text-blue-500",children:"SENTINEL"})]}),s.jsx("div",{className:"text-sm text-slate-400 uppercase tracking-[0.3em] font-mono",children:"Initialisation du Systme"})]}),s.jsxs("div",{className:"w-full max-w-md space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsx("span",{className:"text-blue-400 font-mono text-xs",children:t}),s.jsxs("span",{className:"text-2xl font-bold font-mono text-white",children:[e,"%"]})]}),s.jsx("div",{className:"h-1.5 w-full bg-slate-800/50 rounded-full overflow-hidden backdrop-blur-sm border border-white/5",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 transition-all duration-300 ease-out shadow-[0_0_15px_rgba(59,130,246,0.6)]",style:{width:`${e}%`}})})]}),s.jsx("div",{className:"grid grid-cols-4 gap-4 w-full",children:n.map(i=>{const r=e>=i.threshold;return s.jsxs("div",{className:`
                  relative flex flex-col items-center gap-3 p-4 rounded-xl border transition-all duration-500
                  ${r?"bg-blue-900/20 border-blue-500/30 shadow-[0_0_20px_rgba(59,130,246,0.1)]":"bg-slate-900/20 border-white/5 text-slate-600"}
                `,children:[s.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold font-mono border
                  ${r?"bg-blue-500 border-blue-400 text-white shadow-[0_0_10px_rgba(59,130,246,0.5)]":"bg-slate-800 border-slate-700 text-slate-500"}
                `,children:r?"":i.id}),s.jsx("div",{className:`
                  text-xs font-bold uppercase tracking-wider
                  ${r?"text-blue-300":"text-slate-600"}
                `,children:i.label})]},i.id)})})]})]})},_m=({isOpen:e,title:t,message:n,studyName:i,actionType:r,onConfirm:a,onCancel:o})=>{const[l,c]=N.useState(""),[d,u]=N.useState(!1);if(!e)return null;const p=r==="force_sign"?"green":r==="delete"?"red":r==="override"?"orange":"blue",h={green:{border:"border-green-500/50",btn:"bg-green-600 hover:bg-green-500 shadow-green-500/20",icon:""},red:{border:"border-red-500/50",btn:"bg-red-600 hover:bg-red-500 shadow-red-500/20",icon:""},orange:{border:"border-orange-500/50",btn:"bg-orange-600 hover:bg-orange-500 shadow-orange-500/20",icon:""},blue:{border:"border-blue-500/50",btn:"bg-blue-600 hover:bg-blue-500 shadow-blue-500/20",icon:""}}[p],m=["Trop cher / Budget","Raison Technique / Toiture","Concurrent moins cher","Refus Client / Ne rpond plus","Projet Abandonn","Erreur de saisie / Doublon"],f=async()=>{if(!l.trim()){alert(" Veuillez fournir une justification");return}if(l.trim().length<10){alert(" La justification doit contenir au moins 10 caractres");return}u(!0);try{await a(l.trim()),c("")}catch(b){console.error("Error confirming override:",b),alert(" Erreur lors de la confirmation")}finally{u(!1)}},g=()=>{c(""),o()};return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-fadeIn",children:s.jsxs("div",{className:`
          glass-panel w-full max-w-lg rounded-2xl overflow-hidden border-2 ${h.border} 
          shadow-[0_0_50px_rgba(0,0,0,0.5)] transform transition-all animate-slideUp
        `,children:[s.jsx("div",{className:"p-6 border-b border-white/5 bg-white/5",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-1 flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:h.icon}),t]}),i&&s.jsxs("div",{className:"text-sm text-slate-300 ml-9",children:["Dossier :"," ",s.jsx("span",{className:"font-bold text-white",children:i})]})]}),s.jsx("button",{onClick:g,disabled:d,className:"text-slate-400 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-full",children:""})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[n&&s.jsx("div",{className:"bg-slate-900/50 border border-slate-700/50 rounded-xl p-4",children:s.jsx("p",{className:"text-slate-300 leading-relaxed text-sm",children:n})}),s.jsx("div",{className:`rounded-xl p-4 ${p==="red"?"bg-red-500/10 border border-red-500/20":"bg-orange-500/10 border border-orange-500/20"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-xl",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:`font-bold text-sm mb-0.5 ${p==="red"?"text-red-400":"text-orange-400"}`,children:"Action critique - Justification requise"}),s.jsx("div",{className:"text-xs text-slate-400",children:"Cette action sera enregistre de manire immuable dans les logs de scurit."})]})]})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Justification"}),s.jsx("span",{className:"text-[10px] text-slate-500",children:"Requis pour valider"})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:m.map(b=>s.jsx("button",{onClick:()=>c(b),className:"px-2.5 py-1 bg-slate-800 hover:bg-slate-700 border border-slate-700 hover:border-slate-600 rounded-md text-[10px] text-slate-300 transition-colors",children:b},b))}),s.jsx("textarea",{value:l,onChange:b=>c(b.target.value),rows:3,disabled:d,placeholder:"Expliquez la raison de cette action exceptionnelle...",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-slate-600 focus:border-white/20 focus:ring-1 focus:ring-white/20 focus:outline-none resize-none text-sm transition-all"}),s.jsx("div",{className:"flex justify-end mt-1",children:s.jsxs("span",{className:`text-[10px] ${l.trim().length<10?"text-orange-400":"text-emerald-400"}`,children:[l.trim().length,"/10 caractres"]})})]})]}),s.jsxs("div",{className:"p-4 bg-black/20 border-t border-white/5 flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:g,disabled:d,className:"px-4 py-2 hover:bg-white/5 text-slate-400 hover:text-white rounded-lg font-bold text-sm transition-colors",children:"Annuler"}),s.jsx("button",{onClick:f,disabled:d||l.trim().length<10,className:`px-4 py-2 text-white rounded-lg font-bold text-sm transition-all shadow-lg hover:shadow-xl hover:scale-[1.02] active:scale-95 ${h.btn} disabled:opacity-50 disabled:cursor-not-allowed`,children:"Confirmer Action"})]})]})})};function Om(){const{studies:e,emailLeads:t,logs:n,metrics:i,financialStats:r,loading:a,loadingProgress:o,loadingStep:l,error:c,trafficData:d,emailFlowByClient:u,antiAnnulationByStudy:p,postRefusByStudy:h,actions:{refresh:m,signStudy:f,cancelStudy:g,deleteStudy:b,markDepositPaid:v,markRibSent:w,deleteLeadPermanently:A,setOptOut:T,logForceAction:S}}=Vo(),[y,x]=N.useState("cockpit"),[j,k]=N.useState(new Date),[M,E]=N.useState({search:"",views:null,clicks:null,status:null,optout:!1}),[D,_]=N.useState(!1),[C,I]=N.useState(!1),[K,O]=N.useState("performance"),[P,z]=N.useState({isOpen:!1,title:"",onConfirm:async()=>{}}),pe=N.useCallback(()=>{m(),k(new Date)},[m]),je=N.useMemo(()=>ul(e,t,i),[e,t,i]);N.useCallback(()=>{x("war_room")},[]);const ro=()=>{z(B=>({...B,isOpen:!1}))},ao=async(B,H)=>{z({isOpen:!0,title:"Forcer la signature ?",message:"Cette action va contourner les vrifications automatiques.",studyName:H,actionType:"force_sign",onConfirm:async Ne=>{await f(B,H),z(ie=>({...ie,isOpen:!1}))}})},oo=async(B,H)=>{z({isOpen:!0,title:"Confirmer l'annulation",message:"Le dossier sera marqu comme annul. Irrversible.",studyName:H,actionType:"delete",onConfirm:async Ne=>{await g(B,H,Ne),z(ie=>({...ie,isOpen:!1}))}})},lo=async(B,H)=>{z({isOpen:!0,title:"Supprimer dfinitivement ?",message:"Toutes les donnes associes seront perdues.",studyName:H,actionType:"delete",onConfirm:async Ne=>{await b(B,H),z(ie=>({...ie,isOpen:!1}))}})},co=async(B,H)=>{await v(B,H)},uo=async(B,H)=>{await w(B,H)},ho=async B=>{await T(B)},po=async(B,H,Ne)=>{await A(B,H,Ne)},[Ut,mo]=N.useState("current_month"),{filteredStudies:jn,filteredLeads:wn,filteredMetrics:Nn,filteredFinancialStats:kn}=N.useMemo(()=>{if(Ut==="all_time")return{filteredStudies:e,filteredLeads:t,filteredMetrics:i,filteredFinancialStats:r};const B=new Date,H=B.getMonth(),Ne=B.getFullYear(),ie=re=>{if(!re)return!1;const Tn=new Date(re);return Tn.getMonth()===H&&Tn.getFullYear()===Ne},Sn=e.filter(re=>ie(re.created_at)||re.signed_at&&ie(re.signed_at)||re.deposit_paid_at&&ie(re.deposit_paid_at)),fo=t.filter(re=>ie(re.created_at)),An=Fo(Sn);return{filteredStudies:Sn,filteredLeads:fo,filteredMetrics:An,filteredFinancialStats:An.financialStats}},[e,t,i,r,Ut]),we=N.useMemo(()=>({studies:jn,emailLeads:wn,logs:n,metrics:Nn,financialStats:kn,loading:a,systemInitialized:!0,loadingProgress:100,loadingStep:"Ready",error:null,emailFlowByClient:u,antiAnnulationByStudy:p,postRefusByStudy:h,trafficData:d,zenMode:D,setActiveSection:x,actions:{refresh:m,signStudy:ao,cancelStudy:oo,deleteStudy:lo,markDepositPaid:co,markRibSent:uo,setOptOut:ho,deleteLeadPermanently:po,logForceAction:S||(async(B,H)=>console.warn(`Agent Log System inactive: ${H} on ${B}`)),updateStudyStatus:async()=>console.warn("Update Study Status: Not connected to Agent yet")}}),[jn,wn,n,Nn,kn,a,u,p,h,d,D,m,S]);return a?s.jsx(Dm,{progress:o,step:l}):c?s.jsxs("div",{className:"text-red-500 p-10 text-center text-xl font-bold bg-slate-900 h-screen flex items-center justify-center",children:[" ",c]}):s.jsxs("div",{className:"min-h-screen bg-[#020617] text-slate-200 font-sans selection:bg-blue-500/30",children:[s.jsx(_m,{isOpen:P.isOpen,title:P.title,message:P.message,studyName:P.studyName,actionType:P.actionType,onConfirm:P.onConfirm,onCancel:ro}),s.jsx(Em,{zenMode:D,priorityMode:C,onToggleZenMode:()=>_(!D),onTogglePriorityMode:()=>I(!C),onRefresh:pe,lastRefresh:j,systemStatus:(i==null?void 0:i.systemState)==="stable"?"normal":i==null?void 0:i.systemState,activeSection:y,setActiveSection:x,unsubscribedCount:je.unsubscribedCount,unsubscribeRate:je.unsubscribeRate,totalStudies:je.totalStudies,totalClients:je.totalStudies,signedClients:je.signedStudies,globalDateFilter:Ut,onSetDateFilter:mo}),s.jsxs("main",{className:"max-w-[1600px] mx-auto px-6 py-8 space-y-12 mt-20",children:[y==="cockpit"&&s.jsx(Qp,{system:we}),y==="war_room"&&s.jsx(im,{system:we}),y==="pilotage"&&s.jsx(hm,{system:we}),y==="sales"&&s.jsx(gm,{system:we}),y==="roi"&&s.jsx(vm,{system:we}),y==="registry"&&s.jsx(Cm,{system:we}),y==="system"&&s.jsx(Rm,{system:we}),y==="dashboard"&&s.jsxs("div",{className:"text-center py-20",children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-500",children:"Le Monolithe a t dmantel."}),s.jsx("p",{className:"text-slate-600 mt-2",children:"Veuillez utiliser le Cockpit comme point d'entre."}),s.jsx("button",{onClick:()=>x("cockpit"),className:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-lg font-bold",children:"Retour au Cockpit"})]})]})]})}export{Om as default};
