# âš¡ Automatisation Solaire â€” Nicolas Di Stefano  
**EDF Solutions Solaires**

ğŸ“… DerniÃ¨re mise Ã  jour : **3 janvier 2026**  
ğŸ—‚ï¸ Projet Supabase : `ugwqfvwclwctzgtxcakp`  
ğŸš€ Statut : **100 % OPÃ‰RATIONNEL â€” AUTOPILOTE STABLE**

---

## ğŸ§  Philosophie du systÃ¨me

Ce projet **nâ€™est pas un outil marketing**.  
Câ€™est un **systÃ¨me de sÃ©curisation dÃ©cisionnelle** conÃ§u pour :

- le **POST-REFUS** (client non signÃ©)
- lâ€™**ANTI-ANNULATION** (client signÃ©)

ğŸ¯ Objectif unique : **CLOSING NET**  
> Signer **ET** Ã©viter lâ€™annulation J+7.

Aucune pression, aucune manipulation, aucune relance agressive.  
Approche institutionnelle EDF, adaptÃ©e CSP+.

---

## ğŸ—ï¸ Architecture gÃ©nÃ©rale

### ğŸ” SchÃ©mas Supabase actifs
- `public`
- `cron`
- `net`
- `auth`
- `extensions`

---

### ğŸ—„ï¸ Tables critiques

#### `public.clients`
- Base prospects
- DÃ©doublonnage par email
- Source de vÃ©ritÃ© client

#### `public.studies`
- Ã‰tudes techniques & financiÃ¨res
- Statuts :
  - `draft`
  - `sent` (non signÃ©)
  - `signed` (signÃ©)
- Relation client via `client_id (UUID)`

#### `public.email_queue`
- File dâ€™attente emails automatiques
- Champs clÃ©s :
  - `email_type`
  - `scheduled_for`
  - `status`
  - `payload` (**non-null, contrainte volontaire**)

#### `public.tracking_events`
- Logs comportementaux :
  - `email_open`
  - `email_click`
  - `view_study`
- UtilisÃ©s uniquement via vues de synthÃ¨se

---

### ğŸ” Vues de pilotage (lecture seule)

#### `studies_activity_summary`
- SynthÃ¨se comportementale par Ã©tude
- Ouvertures, interactions, derniÃ¨re activitÃ©

#### `studies_to_watch`
- Vue de **surveillance intelligente**
- Peut Ãªtre vide (Ã©tat normal)
- Ne dÃ©clenche aucune action automatique

---

## ğŸŒ Services tiers

- **Supabase**
  - Base de donnÃ©es
  - Triggers
  - Cron jobs

- **Resend**
  - Envoi des emails
  - Domaine : `nicolas-distefano-edf.fr`

- **Vercel**
  - Dashboard
  - API emails
  - API tracking
  - Endpoint cron sÃ©curisÃ©

---

## ğŸ› ï¸ Historique technique â€” 3 janvier 2026

### A. Client de test (UPSERT)
```sql
INSERT INTO clients (...)
ON CONFLICT (email) DO UPDATE;
